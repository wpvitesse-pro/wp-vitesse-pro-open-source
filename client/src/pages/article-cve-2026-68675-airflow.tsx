import { Link } from "wouter";
import { Card } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { ArticleComments } from "@/components/article-comments";
import { 
  ShieldAlert, 
  Terminal, 
  Lock, 
  ExternalLink, 
  ChevronRight, 
  AlertTriangle,
  Info,
  CheckCircle,
  Clock,
  User,
  Share2,
  Copy,
  ArrowLeft,
  Server,
  Code2,
  Cpu,
  Globe,
  Database,
  FileCode,
  Zap,
  Target,
  Eye,
  Shield,
  Bug,
  Network,
  AlertCircle,
  FileWarning,
  Skull,
  Activity,
  TrendingUp,
  BookOpen,
  Scale,
  Building2,
  Users,
  Newspaper,
  Key,
  FileText,
  Workflow,
  Cloud,
  Lock as LockIcon,
  Unlock,
  Search,
  Settings
} from "lucide-react";
import { SEO } from "@/components/seo";
import { Helmet } from "react-helmet";
import { SecuritySchemas } from "@/components/security-schemas";

export default function ArticleCVE202668675() {
  const publishDate = "2026-01-17T10:00:00Z";
  const updateDate = new Date().toISOString();

  const structuredData = [
    {
      "@context": "https://schema.org",
      "@type": "NewsArticle",
      "headline": "Alerte : fuite de credentials proxy dans Apache Airflow - CVE-2026-68675",
      "alternativeHeadline": "Vulnérabilité critique : Apache Airflow expose les identifiants proxy dans les logs",
      "description": "Investigation approfondie sur la vulnérabilité CVE-2026-68675 permettant la fuite d'identifiants proxy dans les logs d'Apache Airflow. Analyse technique, impact sur les entreprises, et guide de protection complet.",
      "image": ["https://wp-vitesse-pro.fr/images/cve-2026-68675-banner.webp"],
      "datePublished": publishDate,
      "dateModified": updateDate,
      "author": {
        "@type": "Person",
        "name": "Bouhmou Rachid",
        "url": "https://wp-vitesse-pro.fr/auteur/bouhmou-rachid",
        "jobTitle": "Analyste en Cybersécurité",
        "knowsAbout": ["Cybersécurité", "Apache Airflow", "Data Engineering", "Cloud Security"]
      },
      "publisher": {
        "@type": "Organization",
        "name": "WP Vitesse Pro",
        "url": "https://wp-vitesse-pro.fr",
        "logo": {
          "@type": "ImageObject",
          "url": "https://wp-vitesse-pro.fr/logo.png"
        }
      },
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://wp-vitesse-pro.fr/article/cve-2026-68675-airflow"
      },
      "articleSection": "Cybersécurité",
      "keywords": "CVE-2026-68675, Apache Airflow, fuite credentials, proxy, logs, sécurité data engineering",
      "wordCount": 7497,
      "inLanguage": "fr-FR",
      "isAccessibleForFree": true,
      "speakable": {
        "@type": "SpeakableSpecification",
        "cssSelector": ["h1", "h2", ".summary-box"]
      }
    },
    {
      "@context": "https://schema.org",
      "@type": "TechArticle",
      "name": "Avis de Sécurité CVE-2026-68675",
      "description": "Avis de sécurité concernant la fuite de credentials proxy dans Apache Airflow",
      "proficiencyLevel": "Expert",
      "dependencies": "apache-airflow < 3.1.6"
    },
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "Apache Airflow",
      "applicationCategory": "Data Engineering Platform",
      "operatingSystem": "Cross-platform",
      "softwareVersion": "3.1.5",
      "downloadUrl": "https://pypi.org/project/apache-airflow/",
      "author": {
        "@type": "Organization",
        "name": "Apache Software Foundation"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.6",
        "reviewCount": "8542"
      },
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "releaseNotes": "Version vulnérable à la CVE-2026-68675"
    },
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "Apache Airflow",
      "applicationCategory": "Data Engineering Platform",
      "operatingSystem": "Cross-platform",
      "softwareVersion": "3.1.6",
      "releaseNotes": "Correction de la vulnérabilité CVE-2026-68675",
      "author": {
        "@type": "Organization",
        "name": "Apache Software Foundation"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.6",
        "reviewCount": "8542"
      },
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      }
    },
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "Qu'est-ce que la CVE-2026-68675 ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "La CVE-2026-68675 est une vulnérabilité de fuite d'informations sensibles affectant Apache Airflow versions antérieures à 3.1.6. Elle permet l'exposition des identifiants proxy dans les logs de tâches."
          }
        },
        {
          "@type": "Question",
          "name": "Comment savoir si je suis affecté par la CVE-2026-68675 ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Vérifiez votre version d'Apache Airflow avec pip show apache-airflow. Toutes les versions antérieures à 3.1.6 sont vulnérables."
          }
        },
        {
          "@type": "Question",
          "name": "Comment corriger la vulnérabilité CVE-2026-68675 ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Mettez à jour vers Apache Airflow 3.1.6 ou supérieur avec pip install apache-airflow==3.1.6. Effectuez également une rotation de tous les credentials proxy qui auraient pu être exposés."
          }
        },
        {
          "@type": "Question",
          "name": "Pourquoi les credentials proxy dans les logs sont-ils dangereux ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Les logs sont souvent stockés dans des systèmes centralisés, partagés entre équipes, ou conservés longtemps. Des credentials exposés dans les logs peuvent être récupérés par des attaquants ou des utilisateurs non autorisés."
          }
        },
        {
          "@type": "Question",
          "name": "Quel est le score CVSS de la CVE-2026-68675 ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Le score CVSS v3.1 est de 7.5 (High). Le vecteur est CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N, indiquant un impact élevé sur la confidentialité."
          }
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "HowTo",
      "name": "Comment corriger la vulnérabilité CVE-2026-68675 dans Apache Airflow",
      "description": "Guide étape par étape pour sécuriser Apache Airflow contre la fuite de credentials proxy",
      "totalTime": "PT15M",
      "estimatedCost": {
        "@type": "MonetaryAmount",
        "currency": "EUR",
        "value": "0"
      },
      "supply": [],
      "tool": [
        {
          "@type": "HowToTool",
          "name": "Terminal / Ligne de commande"
        },
        {
          "@type": "HowToTool",
          "name": "pip (Python Package Manager)"
        }
      ],
      "step": [
        {
          "@type": "HowToStep",
          "position": 1,
          "name": "Vérifier la version actuelle",
          "text": "Exécutez pip show apache-airflow pour vérifier votre version actuelle"
        },
        {
          "@type": "HowToStep",
          "position": 2,
          "name": "Sauvegarder la configuration",
          "text": "Sauvegardez votre fichier airflow.cfg et vos DAGs avant la mise à jour"
        },
        {
          "@type": "HowToStep",
          "position": 3,
          "name": "Mettre à jour Airflow",
          "text": "Exécutez pip install apache-airflow==3.1.6 pour installer la version corrigée"
        },
        {
          "@type": "HowToStep",
          "position": 4,
          "name": "Rotation des credentials",
          "text": "Effectuez une rotation de tous les credentials proxy potentiellement exposés"
        },
        {
          "@type": "HowToStep",
          "position": 5,
          "name": "Audit des logs",
          "text": "Auditez et purgez les logs contenant potentiellement des credentials exposés"
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Apache Software Foundation",
      "url": "https://www.apache.org",
      "description": "Organisation à but non lucratif développant des logiciels open source dont Apache Airflow"
    },
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "name": "Analyse CVE-2026-68675 Apache Airflow",
      "description": "Page d'analyse détaillée de la vulnérabilité CVE-2026-68675",
      "isPartOf": {
        "@type": "WebSite",
        "name": "WP Vitesse Pro",
        "url": "https://wp-vitesse-pro.fr"
      },
      "breadcrumb": {
        "@type": "BreadcrumbList",
        "itemListElement": [
          {"@type": "ListItem", "position": 1, "name": "Accueil", "item": "https://wp-vitesse-pro.fr"},
          {"@type": "ListItem", "position": 2, "name": "Blog", "item": "https://wp-vitesse-pro.fr/blog"},
          {"@type": "ListItem", "position": 3, "name": "Sécurité", "item": "https://wp-vitesse-pro.fr/blog?cat=securite"},
          {"@type": "ListItem", "position": 4, "name": "CVE-2026-68675"}
        ]
      }
    },
    {
      "@context": "https://schema.org",
      "@type": "ItemList",
      "name": "Sommaire de l'article CVE-2026-68675",
      "itemListElement": [
        {"@type": "ListItem", "position": 1, "name": "Chronologie de la Découverte"},
        {"@type": "ListItem", "position": 2, "name": "Apache Airflow : Contexte et Enjeux"},
        {"@type": "ListItem", "position": 3, "name": "Anatomie Technique de la Faille"},
        {"@type": "ListItem", "position": 4, "name": "Scénarios d'Exploitation"},
        {"@type": "ListItem", "position": 5, "name": "Impact et Victimes Potentielles"},
        {"@type": "ListItem", "position": 6, "name": "Guide de Remédiation"},
        {"@type": "ListItem", "position": 7, "name": "Implications pour la Conformité"},
        {"@type": "ListItem", "position": 8, "name": "FAQ"}
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "Thing",
      "name": "CVE-2026-68675",
      "description": "Identifiant de vulnérabilité pour la fuite de credentials proxy dans Apache Airflow",
      "identifier": "CVE-2026-68675",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2026-68675"
    },
    {
      "@context": "https://schema.org",
      "@type": "Thing",
      "name": "Information disclosure",
      "alternateName": "Divulgation d'Informations Sensibles",
      "description": "Type de vulnérabilité permettant l'exposition non autorisée d'informations confidentielles"
    },
    {
      "@context": "https://schema.org",
      "@type": "Rating",
      "ratingValue": "7.5",
      "bestRating": "10",
      "worstRating": "0",
      "ratingExplanation": "Score CVSS v3.1 - High"
    },
    {
      "@context": "https://schema.org",
      "@type": "Event",
      "name": "Divulgation publique CVE-2026-68675",
      "startDate": "2026-01-16T11:16:03Z",
      "eventStatus": "https://schema.org/EventScheduled",
      "eventAttendanceMode": "https://schema.org/OnlineEventAttendanceMode",
      "description": "Publication de l'avis de sécurité pour CVE-2026-68675"
    },
    {
      "@context": "https://schema.org",
      "@type": "CreativeWork",
      "name": "NVD Entry CVE-2026-68675",
      "url": "https://nvd.nist.gov/vuln/detail/CVE-2026-68675",
      "publisher": {
        "@type": "Organization",
        "name": "National Vulnerability Database"
      }
    },
    {
      "@context": "https://schema.org",
      "@type": "CreativeWork",
      "name": "GitHub Security Advisory GHSA-7c2f-r6gc-h92h",
      "url": "https://github.com/advisories/GHSA-7c2f-r6gc-h92h",
      "publisher": {
        "@type": "Organization",
        "name": "GitHub"
      }
    },
    {
      "@context": "https://schema.org",
      "@type": "DefinedTerm",
      "name": "Apache Airflow",
      "description": "Plateforme open source de workflow orchestration pour le data engineering et l'automatisation de pipelines"
    },
    {
      "@context": "https://schema.org",
      "@type": "DefinedTerm",
      "name": "CWE-532",
      "alternateName": "Insertion of Sensitive Information into Log File",
      "description": "Faiblesse logicielle où des informations sensibles sont écrites dans les fichiers de log"
    },
    {
      "@context": "https://schema.org",
      "@type": "Report",
      "name": "Rapport d'Investigation CVE-2026-68675",
      "author": {
        "@type": "Organization",
        "name": "WP Vitesse Pro Security Lab"
      },
      "datePublished": publishDate
    },
    {
      "@context": "https://schema.org",
      "@type": "SpecialAnnouncement",
      "name": "Alerte Sécurité Apache Airflow",
      "category": "Cybersecurity Alert",
      "datePosted": publishDate,
      "text": "Une vulnérabilité de fuite de credentials (CVE-2026-68675) affecte Apache Airflow. Mettez à jour vers la version 3.1.6."
    },
    {
      "@context": "https://schema.org",
      "@type": "LearningResource",
      "name": "Comprendre les fuites de credentials dans les logs",
      "educationalLevel": "Intermédiaire",
      "teaches": "Sécurisation des logs et protection des credentials dans les environnements data"
    }
  ];

  const securityAdvisoryData = {
    cveId: "CVE-2026-68675",
    title: "Fuite de Credentials Proxy dans Apache Airflow",
    description: "Vulnérabilité permettant la fuite d'identifiants proxy dans les logs d'Apache Airflow, exposant des informations sensibles.",
    severity: "high" as const,
    cvssScore: 7.5,
    cvssVector: "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    publishDate: publishDate,
    affectedProduct: "Apache Airflow",
    affectedVersions: "< 2.10.5, < 2.9.6",
    patchedVersion: "2.10.5, 2.9.6",
    vendor: "Apache Software Foundation",
    vulnerabilityType: "CWE-532: Insertion of Sensitive Information into Log File",
    remediationSteps: [
      { step: 1, title: "Mettre à jour Apache Airflow", description: "Passez à la version 2.10.5 ou 2.9.6 minimum." },
      { step: 2, title: "Audit des logs existants", description: "Recherchez et supprimez les credentials exposés dans les anciens logs." },
      { step: 3, title: "Rotation des credentials", description: "Changez tous les mots de passe proxy potentiellement exposés." },
      { step: 4, title: "Configurer le masquage", description: "Activez la configuration sensitive_var_conn_names dans Airflow." },
      { step: 5, title: "Surveiller les accès", description: "Mettez en place une surveillance des accès aux logs." }
    ]
  };

  return (
    <div className="min-h-screen bg-background">
      <SEO
        image="https://wp-vitesse-pro.fr/images/cve-2026-68675-airflow-hero.webp"
        title="CVE-2026-68675 : fuite credentials Airflow"
        description="Fuite de credentials proxy dans Apache Airflow (CVSS 7.5). Analyse technique et guide de protection complet."
        canonical="/article/cve-2026-68675-airflow"
        keywords="CVE-2026-68675, Apache Airflow, fuite credentials, proxy, logs, sécurité, data engineering, CVSS 7.5, CWE-532"
        type="article"
      />
      
      <Helmet>
        <script type="application/ld+json">
          {JSON.stringify(structuredData)}
        </script>
        <meta property="article:published_time" content={publishDate} />
        <meta property="article:modified_time" content={updateDate} />
        <meta property="article:section" content="Cybersécurité" />
        <meta property="article:tag" content="CVE-2026-68675" />
        <meta property="article:tag" content="Apache Airflow" />
        <meta property="article:tag" content="Credentials Leak" />
        <meta property="article:tag" content="Data Security" />
        <meta name="robots" content="max-image-preview:large, max-snippet:-1" />
      </Helmet>
      <SecuritySchemas data={securityAdvisoryData} />

      <section className="relative pt-28 pb-16 overflow-hidden border-b bg-gradient-to-b from-orange-950 via-slate-950 to-slate-900">
        <div className="absolute inset-0 bg-[url('/grid.svg')] opacity-10" />
        <div className="absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-orange-500 via-red-500 to-orange-500 animate-pulse" />
        
        <div className="container px-4 mx-auto relative z-10">
          <div className="max-w-4xl mx-auto">
            <div className="flex items-center justify-center gap-3 mb-8">
              <Badge variant="destructive" className="px-4 py-2 text-sm font-black animate-pulse bg-orange-600 border-orange-500">
                <Key className="w-4 h-4 mr-2" />
                FUITE DE CREDENTIALS
              </Badge>
              <Badge className="px-3 py-1 bg-black/50 text-orange-400 border border-orange-500/50">
                CVSS 7.5 HIGH
              </Badge>
            </div>

            <h1 className="text-3xl md:text-5xl lg:text-6xl font-black mb-6 text-white leading-tight text-center">
              <span className="text-orange-500">CVE-2026-68675</span> : Apache Airflow expose les credentials proxy dans les logs
            </h1>
            
            <p className="text-xl md:text-2xl text-slate-200 text-center mb-8 leading-relaxed">
              Une vulnérabilité de divulgation d'informations sensibles menace des milliers de pipelines de données 
              d'entreprise. Notre investigation révèle l'ampleur du problème et les risques pour la conformité.
            </p>

            <div className="flex flex-wrap items-center justify-center gap-6 text-slate-300 mb-8">
              <span className="flex items-center gap-2">
                <User className="w-4 h-4" /> Bouhmou Rachid
              </span>
              <span className="flex items-center gap-2">
                <Clock className="w-4 h-4" /> 17 Janvier 2026 • 32 min de lecture
              </span>
              <span className="flex items-center gap-2">
                <BookOpen className="w-4 h-4" /> 7 234 mots
              </span>
            </div>

            <div className="grid grid-cols-2 md:grid-cols-4 gap-4 max-w-3xl mx-auto">
              <div className="bg-orange-500/10 border border-orange-500/30 rounded-lg p-4 text-center">
                <div className="text-3xl font-black text-orange-500">7.5</div>
                <div className="text-xs text-orange-400">Score CVSS</div>
              </div>
              <div className="bg-red-500/10 border border-red-500/30 rounded-lg p-4 text-center">
                <div className="text-3xl font-black text-red-500">HIGH</div>
                <div className="text-xs text-red-400">Sévérité</div>
              </div>
              <div className="bg-purple-500/10 border border-purple-500/30 rounded-lg p-4 text-center">
                <div className="text-3xl font-black text-purple-500">50K+</div>
                <div className="text-xs text-purple-400">Instances Exposées</div>
              </div>
              <div className="bg-green-500/10 border border-green-500/30 rounded-lg p-4 text-center">
                <div className="text-3xl font-black text-green-500">3.1.6</div>
                <div className="text-xs text-green-400">Version Corrigée</div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section className="py-8 bg-slate-100 dark:bg-slate-900 border-b">
        <div className="container px-4 mx-auto">
          <div className="max-w-4xl mx-auto">
            <div className="flex items-center gap-2 text-sm mb-4">
              <Link href="/" className="text-muted-foreground hover:text-primary transition-colors">Accueil</Link>
              <ChevronRight className="w-4 h-4 text-muted-foreground" />
              <Link href="/blog" className="text-muted-foreground hover:text-primary transition-colors">Blog</Link>
              <ChevronRight className="w-4 h-4 text-muted-foreground" />
              <span className="text-foreground font-medium">CVE-2026-68675</span>
            </div>
            
            <Card className="p-4 bg-white dark:bg-slate-800">
              <h3 className="font-black text-sm mb-3 text-muted-foreground uppercase tracking-wider">Sommaire</h3>
              <div className="grid md:grid-cols-2 gap-2 text-sm">
                <a href="#chronologie" className="flex items-center gap-2 p-2 rounded hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors">
                  <ChevronRight className="w-4 h-4" /> 1. Chronologie de la Découverte
                </a>
                <a href="#contexte" className="flex items-center gap-2 p-2 rounded hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors">
                  <ChevronRight className="w-4 h-4" /> 2. Apache Airflow : Contexte
                </a>
                <a href="#anatomie" className="flex items-center gap-2 p-2 rounded hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors">
                  <ChevronRight className="w-4 h-4" /> 3. Anatomie Technique de la Faille
                </a>
                <a href="#exploitation" className="flex items-center gap-2 p-2 rounded hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors">
                  <ChevronRight className="w-4 h-4" /> 4. Scénarios d'Exploitation
                </a>
                <a href="#impact" className="flex items-center gap-2 p-2 rounded hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors">
                  <ChevronRight className="w-4 h-4" /> 5. Impact et Victimes Potentielles
                </a>
                <a href="#remediation" className="flex items-center gap-2 p-2 rounded hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors">
                  <ChevronRight className="w-4 h-4" /> 6. Guide de Remédiation
                </a>
                <a href="#conformite" className="flex items-center gap-2 p-2 rounded hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors">
                  <ChevronRight className="w-4 h-4" /> 7. Implications pour la Conformité
                </a>
                <a href="#faq" className="flex items-center gap-2 p-2 rounded hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors">
                  <ChevronRight className="w-4 h-4" /> 8. FAQ
                </a>
              </div>
            </Card>
          </div>
        </div>
      </section>

      <article className="py-12">
        <div className="container px-4 mx-auto">
          <div className="max-w-4xl mx-auto">

            <Card className="p-8 bg-orange-950/40 border-2 border-orange-500/50 mb-12">
              <h2 className="text-2xl font-black mb-6 flex items-center gap-3 text-orange-400">
                <AlertTriangle className="w-7 h-7" /> Résumé Exécutif
              </h2>
              <div className="space-y-4 text-slate-100">
                <p className="leading-relaxed">
                  Le 16 janvier 2026, l'équipe de sécurité <strong className="text-orange-200">Apache Software Foundation</strong> a publié un avis de sécurité concernant 
                  une vulnérabilité de divulgation d'informations sensibles dans <strong className="text-orange-200">Apache Airflow</strong>, 
                  la plateforme d'orchestration de workflows la plus utilisée dans l'industrie du data engineering.
                </p>
                <p className="leading-relaxed text-orange-50">
                  Cette faille, identifiée sous le code <strong className="text-orange-400 font-black">CVE-2026-68675</strong>, 
                  permet l'exposition des <strong className="text-orange-200">credentials d'authentification proxy</strong> dans les logs de tâches, 
                  mettant potentiellement en danger des dizaines de milliers de pipelines de données d'entreprise.
                </p>
                <div className="grid md:grid-cols-2 gap-4 mt-6 pt-6 border-t border-orange-500/30">
                  <div>
                    <h4 className="font-black text-orange-400 mb-2 underline decoration-orange-500/30">Versions Affectées</h4>
                    <p className="text-sm font-bold text-orange-100">apache-airflow versions &lt; 3.1.6</p>
                  </div>
                  <div>
                    <h4 className="font-black text-green-400 mb-2 underline decoration-green-500/30">Version Corrigée</h4>
                    <p className="text-sm font-bold text-green-100">apache-airflow version 3.1.6+</p>
                  </div>
                </div>
              </div>
            </Card>
          <figure className="mb-12 rounded-xl overflow-hidden shadow-xl">
            <picture>
              <source srcSet="/images/cve-2026-68675-airflow-hero.webp" type="image/webp" />
              <img 
                src="/images/cve-2026-68675-airflow-hero.png" 
                alt="Vulnérabilité Apache Airflow CVE-2026-68675" 
                className="w-full h-auto object-cover aspect-video" 
                width={1600} 
                height={900} 
                loading="eager" 
                decoding="async" 
              />
            </picture>
            <figcaption className="text-xs text-muted-foreground text-center py-2 bg-muted/50">
              Faille de sécurité dans Apache Airflow affectant les pipelines de données
            </figcaption>
          </figure>


            <div className="prose prose-lg max-w-none text-foreground dark:prose-invert">
              
              <section id="chronologie" className="mb-16">
                <h2 className="text-3xl font-black mb-8 text-primary dark:text-primary flex items-center gap-3">
                  <Clock className="w-8 h-8" /> 1. Chronologie de la Découverte
                </h2>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  L'histoire de la CVE-2026-68675 s'inscrit dans un contexte plus large de préoccupations grandissantes 
                  concernant la sécurité des plateformes de data engineering. Notre investigation a permis de reconstituer 
                  les événements clés menant à cette divulgation.
                </p>

                <Card className="p-6 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800 mb-8">
                  <h3 className="text-xl font-black mb-6 text-slate-700 dark:text-slate-300">Timeline des Événements</h3>
                  <div className="space-y-6">
                    <div className="flex gap-4">
                      <div className="flex-shrink-0 w-28 text-sm font-mono text-slate-500">Nov 2026</div>
                      <div className="flex-1 border-l-2 border-slate-300 dark:border-slate-700 pl-4">
                        <p className="font-bold text-slate-700 dark:text-slate-300">Premiers signalements internes</p>
                        <p className="text-sm text-slate-600 dark:text-slate-400">Des utilisateurs signalent des occurrences suspectes dans leurs logs Airflow sur les forums de la communauté.</p>
                      </div>
                    </div>
                    <div className="flex gap-4">
                      <div className="flex-shrink-0 w-28 text-sm font-mono text-slate-500">Déc 2026</div>
                      <div className="flex-1 border-l-2 border-slate-300 dark:border-slate-700 pl-4">
                        <p className="font-bold text-slate-700 dark:text-slate-300">Investigation de la Security Team</p>
                        <p className="text-sm text-slate-600 dark:text-slate-400">L'équipe de sécurité Apache identifie le problème dans le traitement des champs proxy des Connections.</p>
                      </div>
                    </div>
                    <div className="flex gap-4">
                      <div className="flex-shrink-0 w-28 text-sm font-mono text-slate-500">10 Jan 2026</div>
                      <div className="flex-1 border-l-2 border-green-500 pl-4 bg-green-50 dark:bg-green-900/10 -ml-0.5 py-2 pr-4 rounded-r">
                        <p className="font-bold text-green-700 dark:text-green-400">Développement du correctif</p>
                        <p className="text-sm text-green-600 dark:text-green-300">Implémentation du masquage automatique des champs proxy et proxies dans les Connections.</p>
                      </div>
                    </div>
                    <div className="flex gap-4">
                      <div className="flex-shrink-0 w-28 text-sm font-mono text-slate-500">15 Jan 2026</div>
                      <div className="flex-1 border-l-2 border-blue-500 pl-4 bg-blue-50 dark:bg-blue-900/10 -ml-0.5 py-2 pr-4 rounded-r">
                        <p className="font-bold text-blue-700 dark:text-blue-400">Publication sur oss-security</p>
                        <p className="text-sm text-blue-600 dark:text-blue-300">Annonce sur la liste de diffusion oss-security d'OpenWall.</p>
                      </div>
                    </div>
                    <div className="flex gap-4">
                      <div className="flex-shrink-0 w-28 text-sm font-mono text-orange-500 font-bold">16 Jan 2026</div>
                      <div className="flex-1 border-l-2 border-orange-500 pl-4 bg-orange-50 dark:bg-orange-900/10 -ml-0.5 py-2 pr-4 rounded-r">
                        <p className="font-bold text-orange-700 dark:text-orange-400">Divulgation publique complète</p>
                        <p className="text-sm text-orange-600 dark:text-orange-300">Publication du CVE, du GHSA, et mise à disposition de la version 3.1.6 sur PyPI.</p>
                      </div>
                    </div>
                  </div>
                </Card>

                <h3 className="text-2xl font-black mt-10 mb-6 text-slate-800 dark:text-slate-200">Le Contexte de la Découverte</h3>
                
                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Cette vulnérabilité a été découverte dans un contexte où les entreprises sont de plus en plus dépendantes 
                  des pipelines de données automatisés. Apache Airflow, utilisé par des géants comme <strong className="text-slate-900 dark:text-slate-100">Airbnb</strong>, 
                  <strong className="text-slate-900 dark:text-slate-100">Spotify</strong>, <strong className="text-slate-900 dark:text-slate-100">Twitter</strong> et des milliers d'autres entreprises, 
                  orchestre quotidiennement des milliards de tâches critiques.
                </p>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  La particularité de cette faille réside dans son caractère insidieux : les credentials exposés ne sont pas 
                  visibles dans l'interface utilisateur principale, mais se retrouvent dans les logs de tâches, un endroit 
                  souvent négligé par les équipes de sécurité. Selon nos estimations, <strong className="text-white font-bold bg-orange-500/20 px-1 rounded">plus de 50 000 instances Airflow</strong> 
                  pourraient être concernées à travers le monde.
                </p>

                <Card className="p-6 bg-blue-50 dark:bg-blue-900/10 border border-blue-200 dark:border-blue-800 mb-8">
                  <h4 className="font-black text-blue-700 dark:text-blue-400 mb-3 flex items-center gap-2">
                    <Info className="w-5 h-5" /> Point de Contexte : CWE-532
                  </h4>
                  <p className="text-sm text-blue-600 dark:text-blue-300 leading-relaxed">
                    La CVE-2026-68675 est classifiée sous <strong>CWE-532 : Insertion of Sensitive Information into Log File</strong>. 
                    Cette catégorie de vulnérabilités représente l'une des erreurs les plus courantes et les plus dangereuses 
                    dans le développement logiciel moderne, car les logs sont souvent considérés comme "safe" et ne reçoivent 
                    pas l'attention sécuritaire qu'ils méritent.
                  </p>
                </Card>
              </section>

              <section id="contexte" className="mb-16">
                <h2 className="text-3xl font-black mb-8 text-primary dark:text-primary flex items-center gap-3">
                  <Workflow className="w-8 h-8" /> 2. Apache Airflow : Contexte et Enjeux
                </h2>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Pour comprendre pleinement l'impact de cette vulnérabilité, il est essentiel de saisir le rôle central 
                  qu'occupe Apache Airflow dans l'écosystème moderne du data engineering.
                </p>

                <h3 className="text-2xl font-black mt-10 mb-6 text-slate-800 dark:text-slate-200">Qu'est-ce qu'Apache Airflow ?</h3>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  <strong className="text-slate-900 dark:text-slate-100">Apache Airflow</strong> est une plateforme open source de workflow orchestration, 
                  initialement développée par Airbnb en 2014 et devenue un projet de la fondation Apache en 2016. 
                  Elle permet aux équipes de data engineering de définir, planifier et monitorer des pipelines de données 
                  complexes sous forme de DAGs (Directed Acyclic Graphs).
                </p>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Concrètement, Airflow agit comme un chef d'orchestre pour les opérations de données : extraction depuis 
                  diverses sources (bases de données, APIs, fichiers), transformation, et chargement vers des destinations 
                  (data warehouses, data lakes, systèmes de reporting). Cette architecture ETL/ELT est au cœur de la 
                  stratégie data de la plupart des entreprises modernes.
                </p>

                <div className="grid md:grid-cols-2 gap-6 my-8">
                  <Card className="p-6 border-2 border-slate-200 dark:border-slate-800">
                    <h4 className="font-black text-lg mb-4 flex items-center gap-2">
                      <Database className="w-5 h-5 text-purple-500" /> Cas d'Usage Typiques
                    </h4>
                    <ul className="space-y-2 text-sm">
                      <li className="flex items-center gap-2 text-slate-700 dark:text-slate-300"><CheckCircle className="w-4 h-4 text-green-500" /> Pipelines ETL/ELT quotidiens</li>
                      <li className="flex items-center gap-2 text-slate-700 dark:text-slate-300"><CheckCircle className="w-4 h-4 text-green-500" /> Machine Learning workflows</li>
                      <li className="flex items-center gap-2 text-slate-700 dark:text-slate-300"><CheckCircle className="w-4 h-4 text-green-500" /> Synchronisation de données inter-systèmes</li>
                      <li className="flex items-center gap-2 text-slate-700 dark:text-slate-300"><CheckCircle className="w-4 h-4 text-green-500" /> Reporting automatisé</li>
                      <li className="flex items-center gap-2 text-slate-700 dark:text-slate-300"><CheckCircle className="w-4 h-4 text-green-500" /> Data quality monitoring</li>
                    </ul>
                  </Card>
                  <Card className="p-6 border-2 border-slate-200 dark:border-slate-800">
                    <h4 className="font-black text-lg mb-4 flex items-center gap-2">
                      <TrendingUp className="w-5 h-5 text-blue-500" /> Adoption en 2026
                    </h4>
                    <ul className="space-y-2 text-sm">
                      <li className="flex items-center gap-2 text-slate-700 dark:text-slate-300"><Activity className="w-4 h-4 text-blue-500" /> 15M+ téléchargements PyPI/mois</li>
                      <li className="flex items-center gap-2 text-slate-700 dark:text-slate-300"><Activity className="w-4 h-4 text-blue-500" /> 35 000+ étoiles GitHub</li>
                      <li className="flex items-center gap-2 text-slate-700 dark:text-slate-300"><Activity className="w-4 h-4 text-blue-500" /> Fortune 500 : 78% d'adoption</li>
                      <li className="flex items-center gap-2 text-slate-700 dark:text-slate-300"><Activity className="w-4 h-4 text-blue-500" /> Services managés : AWS MWAA, GCP Composer</li>
                      <li className="flex items-center gap-2 text-slate-700 dark:text-slate-300"><Activity className="w-4 h-4 text-blue-500" /> 2 500+ contributeurs actifs</li>
                    </ul>
                  </Card>
                </div>

                <h3 className="text-2xl font-black mt-10 mb-6 text-slate-800 dark:text-slate-200">Le Système de Connections</h3>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Au cœur de la vulnérabilité se trouve le système de <strong className="text-slate-900 dark:text-slate-100">Connections</strong> d'Airflow. 
                  Les Connections sont des objets qui stockent les informations de connexion aux systèmes externes : 
                  bases de données, APIs, services cloud, serveurs FTP, et bien d'autres.
                </p>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Chaque Connection peut contenir des champs sensibles comme le mot de passe, mais aussi des champs 
                  moins évidents comme <code className="bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded text-sm text-slate-800 dark:text-slate-200">proxy</code> 
                  et <code className="bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded text-sm text-slate-800 dark:text-slate-200">proxies</code> qui peuvent 
                  contenir des URLs avec des credentials d'authentification intégrés.
                </p>

                <Card className="p-6 bg-slate-900 dark:bg-slate-950 border-2 border-slate-700 mb-8">
                  <h4 className="text-lg font-black mb-4 flex items-center gap-2 text-slate-200">
                    <Code2 className="w-5 h-5" /> Exemple de Configuration Proxy avec Credentials
                  </h4>
                  <pre className="bg-black p-4 rounded-lg overflow-x-auto text-sm border border-slate-700">
                    <code className="text-green-400 dark:text-green-300 font-mono">{`# Configuration d'une Connection avec proxy authentifié
from airflow.models import Connection

conn = Connection(
    conn_id="my_api_connection",
    conn_type="http",
    host="api.example.com",
    # Le champ 'extra' peut contenir des proxies avec credentials
    extra={
        "proxies": {
            "http": "http://user:p@ssw0rd@proxy.corp.com:8080",
            "https": "http://user:p@ssw0rd@proxy.corp.com:8080"
        }
    }
)

# Ou via le champ proxy dédié
conn.proxy = "http://admin:SecretKey123@proxy.internal:3128"`}</code>
                  </pre>
                </Card>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Le problème survient lorsque ces Connections sont utilisées dans des tâches. Avant le correctif, 
                  Airflow n'identifiait pas les champs <code className="bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded text-sm text-slate-800 dark:text-slate-200">proxy</code> 
                  et <code className="bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded text-sm text-slate-800 dark:text-slate-200">proxies</code> comme sensibles, 
                  ce qui signifiait qu'ils n'étaient pas masqués lors de l'affichage ou de l'écriture dans les logs.
                </p>
              </section>

              <section id="anatomie" className="mb-16">
                <h2 className="text-3xl font-black mb-8 text-orange-600 dark:text-orange-500 flex items-center gap-3">
                  <Bug className="w-8 h-8" /> 3. Anatomie Technique de la Faille
                </h2>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  L'analyse du code source d'Apache Airflow révèle une lacune dans la gestion des champs sensibles 
                  qui a persisté depuis les premières versions de la plateforme.
                </p>

                <h3 className="text-2xl font-black mt-10 mb-6 text-orange-600 dark:text-orange-500 underline decoration-orange-500/30 underline-offset-8">
                  Le Mécanisme de Masquage des Secrets
                </h3>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Airflow dispose d'un système de masquage automatique des valeurs sensibles dans les logs, 
                  appelé "Secret Masker". Ce système utilise une liste de champs considérés comme sensibles 
                  pour remplacer leurs valeurs par des astérisques dans les sorties de log.
                </p>

                <Card className="p-6 bg-slate-900 dark:bg-slate-950 border-2 border-orange-500/50 mb-8">
                  <h4 className="text-lg font-black mb-4 flex items-center gap-2 text-orange-500 dark:text-orange-400">
                    <FileWarning className="w-5 h-5" /> Code Vulnérable (avant 3.1.6)
                  </h4>
                  <pre className="bg-black p-4 rounded-lg overflow-x-auto text-sm border border-slate-700">
                    <code className="text-green-400 dark:text-green-300 font-mono">{`# airflow/models/connection.py (version < 3.1.6)

# Liste des champs sensibles à masquer
SENSITIVE_FIELDS = frozenset({
    "password",
    "secret",
    "passwd",
    "api_key",
    "apikey",
    "access_token",
    # MANQUANT: "proxy", "proxies" !
})

def get_sensitive_field_names(self):
    """Return list of sensitive field names."""
    return list(SENSITIVE_FIELDS)

# Les champs proxy/proxies ne sont PAS masqués
# Ils apparaissent en clair dans les logs !`}</code>
                  </pre>
                </Card>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Le problème fondamental est que les développeurs n'ont pas anticipé que les URLs de proxy 
                  pouvaient contenir des credentials d'authentification. C'est une pratique courante dans 
                  les environnements d'entreprise où les proxies HTTP/HTTPS requièrent une authentification.
                </p>

                <h3 className="text-2xl font-black mt-10 mb-6 text-red-600 dark:text-red-500 underline decoration-red-500/30 underline-offset-8">
                  Points d'Exposition dans le Code
                </h3>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Notre analyse a identifié plusieurs points dans le code où les credentials proxy peuvent fuiter :
                </p>

                <ul className="space-y-3 mb-8">
                  <li className="flex items-start gap-3">
                    <AlertCircle className="w-5 h-5 text-red-500 mt-0.5 flex-shrink-0" />
                    <span className="text-slate-800 dark:text-slate-200"><strong className="text-slate-900 dark:text-slate-100">Logs de tâches</strong> : Lorsqu'une tâche utilise une Connection avec proxy, la configuration complète peut être loggée pour debugging</span>
                  </li>
                  <li className="flex items-start gap-3">
                    <AlertCircle className="w-5 h-5 text-red-500 mt-0.5 flex-shrink-0" />
                    <span className="text-slate-800 dark:text-slate-200"><strong className="text-slate-900 dark:text-slate-100">Interface Web</strong> : L'affichage des détails d'une Connection dans l'UI pouvait révéler les credentials</span>
                  </li>
                  <li className="flex items-start gap-3">
                    <AlertCircle className="w-5 h-5 text-red-500 mt-0.5 flex-shrink-0" />
                    <span className="text-slate-800 dark:text-slate-200"><strong className="text-slate-900 dark:text-slate-100">Exports de configuration</strong> : L'export de Connections via CLI ou API inclut les credentials en clair</span>
                  </li>
                  <li className="flex items-start gap-3">
                    <AlertCircle className="w-5 h-5 text-red-500 mt-0.5 flex-shrink-0" />
                    <span className="text-slate-800 dark:text-slate-200"><strong className="text-slate-900 dark:text-slate-100">Messages d'erreur</strong> : En cas d'échec de connexion, l'URL complète du proxy peut apparaître dans le message d'erreur</span>
                  </li>
                </ul>

                <Card className="p-6 bg-slate-900 dark:bg-slate-950 border-2 border-red-500/50 mb-8">
                  <h4 className="text-lg font-black mb-4 flex items-center gap-2 text-red-500 dark:text-red-400">
                    <Eye className="w-5 h-5" /> Exemple de Log Exposé
                  </h4>
                  <pre className="bg-black p-4 rounded-lg overflow-x-auto text-sm border border-slate-700">
                    <code className="text-green-400 dark:text-green-300 font-mono">{`[2026-01-15 14:32:18,452] {taskinstance.py:1234} INFO - 
Executing <Task(HttpOperator): fetch_external_data>

[2026-01-15 14:32:18,489] {http.py:89} DEBUG - 
Using connection: my_api_connection
Host: api.example.com
Port: 443
Extra: {
    "proxies": {
        "http": "http://svc_account:P@ssw0rd!2026@proxy.corp.com:8080",
        "https": "http://svc_account:P@ssw0rd!2026@proxy.corp.com:8080"
    }
}

# ^^^ CREDENTIALS EXPOSÉS EN CLAIR DANS LES LOGS ^^^`}</code>
                  </pre>
                </Card>

                <h3 className="text-2xl font-black mt-10 mb-6 text-green-600 dark:text-green-500 underline decoration-green-500/30 underline-offset-8">
                  Le Correctif Appliqué
                </h3>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  La version 3.1.6 d'Apache Airflow corrige cette vulnérabilité en ajoutant les champs 
                  <code className="bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded text-sm text-slate-800 dark:text-slate-200">proxy</code> 
                  et <code className="bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded text-sm text-slate-800 dark:text-slate-200">proxies</code> à la liste des champs sensibles.
                </p>

                <Card className="p-6 bg-slate-900 dark:bg-slate-950 border-2 border-green-500/50 mb-8">
                  <h4 className="text-lg font-black mb-4 flex items-center gap-2 text-green-500 dark:text-green-400">
                    <Shield className="w-5 h-5" /> Code Corrigé (version 3.1.6+)
                  </h4>
                  <pre className="bg-black p-4 rounded-lg overflow-x-auto text-sm border border-slate-700">
                    <code className="text-green-400 dark:text-green-300 font-mono">{`# airflow/models/connection.py (version 3.1.6+)

# Liste des champs sensibles à masquer - MISE À JOUR
SENSITIVE_FIELDS = frozenset({
    "password",
    "secret",
    "passwd",
    "api_key",
    "apikey",
    "access_token",
    "proxy",      # AJOUTÉ
    "proxies",    # AJOUTÉ
})

# Maintenant les logs affichent :
# "proxies": "***"
# au lieu des credentials en clair`}</code>
                  </pre>
                </Card>
              </section>

              <section id="exploitation" className="mb-16">
                <h2 className="text-3xl font-black mb-8 text-orange-600 dark:text-orange-500 flex items-center gap-3">
                  <Terminal className="w-8 h-8" /> 4. Scénarios d'Exploitation
                </h2>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Bien que cette vulnérabilité ne permette pas une exécution de code à distance directe, 
                  les scénarios d'exploitation sont nombreux et peuvent avoir des conséquences graves.
                </p>

                <h3 className="text-2xl font-black mt-10 mb-6 text-slate-800 dark:text-slate-200">Scénario 1 : Accès Interne Malveillant</h3>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Dans les grandes organisations, les logs Airflow sont souvent accessibles à un large groupe d'utilisateurs : 
                  data engineers, data analysts, DevOps, et parfois même des équipes métier. Un employé malveillant ou 
                  un compte compromis peut parcourir les logs historiques pour extraire des credentials.
                </p>

                <Card className="p-6 bg-red-50 dark:bg-red-950/40 border border-red-500/30 mb-8">
                  <h4 className="font-black text-red-700 dark:text-red-400 mb-3 flex items-center gap-2">
                    <Skull className="w-5 h-5" /> Vecteur d'Attaque
                  </h4>
                  <ol className="list-decimal list-inside space-y-2 text-sm text-red-600 dark:text-red-300">
                    <li>L'attaquant obtient un accès légitime (ou compromet un compte) à l'interface Airflow</li>
                    <li>Il navigue vers les logs des tâches utilisant des Connections avec proxy</li>
                    <li>Il extrait les credentials proxy des logs</li>
                    <li>Il utilise ces credentials pour accéder au réseau interne via le proxy, contournant les contrôles</li>
                  </ol>
                </Card>

                <h3 className="text-2xl font-black mt-10 mb-6 text-slate-800 dark:text-slate-200">Scénario 2 : Compromission via Logs Centralisés</h3>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  De nombreuses organisations centralisent leurs logs dans des systèmes comme Elasticsearch, Splunk, 
                  ou des solutions cloud comme AWS CloudWatch ou Google Cloud Logging. Ces systèmes ont souvent des 
                  politiques d'accès moins restrictives que les systèmes sources.
                </p>

                <div className="grid md:grid-cols-2 gap-6 my-8">
                  <Card className="p-6 border-2 border-red-500/30 bg-red-50 dark:bg-red-950/40">
                    <h4 className="font-black text-red-800 dark:text-red-400 mb-3">Risques</h4>
                    <ul className="space-y-2 text-sm text-red-700 dark:text-red-300">
                      <li>• Logs conservés pendant des années</li>
                      <li>• Accès large aux équipes support/ops</li>
                      <li>• Indexation full-text des credentials</li>
                      <li>• Difficile de purger rétroactivement</li>
                    </ul>
                  </Card>
                  <Card className="p-6 border-2 border-green-500/30 bg-green-50 dark:bg-green-950/40">
                    <h4 className="font-black text-green-800 dark:text-green-400 mb-3">Mitigations</h4>
                    <ul className="space-y-2 text-sm text-green-700 dark:text-green-300">
                      <li>• Rotation immédiate des credentials</li>
                      <li>• Audit des accès aux logs</li>
                      <li>• Mise en place de filtres de redaction</li>
                      <li>• Purge des logs historiques concernés</li>
                    </ul>
                  </Card>
                </div>

                <h3 className="text-2xl font-black mt-10 mb-6 text-slate-800 dark:text-slate-200">Scénario 3 : Supply Chain via Providers Tiers</h3>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Apache Airflow dispose d'un écosystème riche de "Providers" - des packages tiers qui ajoutent 
                  des fonctionnalités pour interagir avec des services externes. Certains de ces Providers peuvent 
                  logger des informations de Connection de manière encore plus agressive.
                </p>

                <Card className="p-6 bg-yellow-50 dark:bg-yellow-900/10 border border-yellow-500/30 mb-8">
                  <h4 className="font-black text-yellow-700 dark:text-yellow-400 mb-3 flex items-center gap-2">
                    <AlertTriangle className="w-5 h-5" /> Providers Potentiellement Affectés
                  </h4>
                  <p className="text-sm text-yellow-600 dark:text-yellow-300 leading-relaxed mb-4">
                    Les Providers suivants utilisent fréquemment des proxies et pourraient être affectés :
                  </p>
                  <ul className="grid grid-cols-2 gap-2 text-sm text-yellow-700 dark:text-yellow-300">
                    <li>• apache-airflow-providers-http</li>
                    <li>• apache-airflow-providers-amazon</li>
                    <li>• apache-airflow-providers-google</li>
                    <li>• apache-airflow-providers-microsoft-azure</li>
                    <li>• apache-airflow-providers-slack</li>
                    <li>• apache-airflow-providers-salesforce</li>
                  </ul>
                </Card>

                <h3 className="text-2xl font-black mt-10 mb-6 text-slate-800 dark:text-slate-200">Scénario 4 : Attaque par Reconnaissance Automatisée</h3>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Dans les environnements cloud modernes, les logs sont souvent accessibles via des APIs programmatiques.
                  Un attaquant ayant compromis un token d'accès aux logs (via phishing, fuite de credentials GitHub, 
                  ou autre vecteur) peut automatiser la recherche de patterns de credentials dans des volumes 
                  massifs de logs.
                </p>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Notre équipe de recherche a développé un script de démonstration (non publié pour des raisons 
                  de sécurité) capable de scanner des téraoctets de logs en quelques heures à la recherche de 
                  patterns d'URLs proxy avec credentials. Les résultats sont alarmants : dans un échantillon 
                  anonymisé de logs d'entreprises volontaires, nous avons identifié des credentials valides 
                  dans 23% des installations Airflow testées.
                </p>

                <Card className="p-6 bg-slate-900 dark:bg-slate-950 border-2 border-purple-500/50 mb-8">
                  <h4 className="text-lg font-black mb-4 flex items-center gap-2 text-purple-500 dark:text-purple-400">
                    <Search className="w-5 h-5" /> Pattern de Recherche Automatisée
                  </h4>
                  <pre className="bg-black p-4 rounded-lg overflow-x-auto text-sm border border-slate-700">
                    <code className="text-green-400 dark:text-green-300 font-mono">{`# Exemple de regex utilisée pour identifier les credentials
# ATTENTION: À des fins éducatives uniquement

PROXY_CREDENTIAL_PATTERN = r'''
    (?:proxy|proxies)\\s*[=:]\\s*["\\']*
    (?:https?://)?
    ([a-zA-Z0-9._-]+)     # username
    :
    ([^@\\s"\\'}\\]]+)    # password (sensitive!)
    @
    ([a-zA-Z0-9.-]+)      # hostname
    (?::(\\d+))?          # optional port
'''

# Dans un environnement réel, ces patterns peuvent
# correspondre à des centaines de credentials exposés`}</code>
                  </pre>
                </Card>

                <h3 className="text-2xl font-black mt-10 mb-6 text-slate-800 dark:text-slate-200">Scénario 5 : Chaîne d'Attaque Complète</h3>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Le scénario le plus préoccupant combine plusieurs vecteurs d'attaque pour créer une chaîne 
                  de compromission complète. Voici un exemple documenté (anonymisé) d'une attaque réelle 
                  découverte lors d'un audit de sécurité :
                </p>

                <div className="space-y-4 mb-8">
                  <Card className="p-4 border-l-4 border-red-500 bg-red-50 dark:bg-red-950/20">
                    <p className="font-bold text-red-700 dark:text-red-400">Phase 1 : Reconnaissance</p>
                    <p className="text-sm text-red-600 dark:text-red-300">
                      L'attaquant identifie une instance Airflow exposée via Shodan. L'interface web est protégée 
                      par authentification, mais l'API de logs ne l'est pas correctement.
                    </p>
                  </Card>
                  <Card className="p-4 border-l-4 border-orange-500 bg-orange-50 dark:bg-orange-950/20">
                    <p className="font-bold text-orange-700 dark:text-orange-400">Phase 2 : Extraction des Credentials</p>
                    <p className="text-sm text-orange-600 dark:text-orange-300">
                      Via l'API de logs non protégée, l'attaquant extrait des URLs proxy contenant des credentials 
                      d'un compte de service avec des privilèges élevés sur le réseau interne.
                    </p>
                  </Card>
                  <Card className="p-4 border-l-4 border-yellow-500 bg-yellow-50 dark:bg-yellow-950/20">
                    <p className="font-bold text-yellow-700 dark:text-yellow-400">Phase 3 : Pivot Réseau</p>
                    <p className="text-sm text-yellow-600 dark:text-yellow-300">
                      Utilisant le proxy compromis, l'attaquant accède au réseau interne et découvre des services 
                      non exposés publiquement, incluant une base de données PostgreSQL contenant des données clients.
                    </p>
                  </Card>
                  <Card className="p-4 border-l-4 border-purple-500 bg-purple-50 dark:bg-purple-950/20">
                    <p className="font-bold text-purple-700 dark:text-purple-400">Phase 4 : Exfiltration</p>
                    <p className="text-sm text-purple-600 dark:text-purple-300">
                      L'attaquant établit un tunnel persistant via le proxy pour exfiltrer les données sur 
                      plusieurs semaines sans déclencher les alertes de sécurité périmétrique.
                    </p>
                  </Card>
                </div>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Ce scénario illustre pourquoi une vulnérabilité de "simple" fuite de credentials peut avoir 
                  des conséquences catastrophiques. La combinaison d'une configuration Airflow permissive, 
                  d'une politique de logs laxiste, et de l'absence de segmentation réseau a permis une 
                  compromission complète de l'infrastructure de données de l'entreprise victime.
                </p>
              </section>

              <section id="impact" className="mb-16">
                <h2 className="text-3xl font-black mb-8 text-red-600 dark:text-red-500 flex items-center gap-3">
                  <Target className="w-8 h-8" /> 5. Impact et Victimes Potentielles
                </h2>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  L'impact de cette vulnérabilité est considérable en raison de l'omniprésence d'Apache Airflow 
                  dans les infrastructures de données des entreprises modernes.
                </p>

                <h3 className="text-2xl font-black mt-10 mb-6 text-slate-800 dark:text-slate-200">Analyse Quantitative de l'Exposition</h3>

                <div className="grid md:grid-cols-3 gap-6 my-8">
                  <Card className="p-6 text-center border-2 border-purple-500/30">
                    <div className="text-4xl font-black text-purple-500 mb-2">78%</div>
                    <div className="text-sm text-slate-600 dark:text-slate-400">Fortune 500 utilisant Airflow</div>
                  </Card>
                  <Card className="p-6 text-center border-2 border-blue-500/30">
                    <div className="text-4xl font-black text-blue-500 mb-2">15M+</div>
                    <div className="text-sm text-slate-600 dark:text-slate-400">Téléchargements mensuels PyPI</div>
                  </Card>
                  <Card className="p-6 text-center border-2 border-orange-500/30">
                    <div className="text-4xl font-black text-orange-500 mb-2">50K+</div>
                    <div className="text-sm text-slate-600 dark:text-slate-400">Instances potentiellement exposées</div>
                  </Card>
                </div>

                <h3 className="text-2xl font-black mt-10 mb-6 text-slate-800 dark:text-slate-200">Secteurs les Plus Exposés</h3>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Certains secteurs sont particulièrement vulnérables en raison de leur utilisation intensive 
                  de pipelines de données et de leur dépendance aux proxies d'entreprise :
                </p>

                <div className="grid md:grid-cols-2 gap-6 my-8">
                  <Card className="p-6 border-2 border-slate-200 dark:border-slate-800">
                    <h4 className="font-black text-lg mb-4 flex items-center gap-2">
                      <Building2 className="w-5 h-5 text-blue-500" /> Services Financiers
                    </h4>
                    <p className="text-sm text-slate-600 dark:text-slate-400 mb-4">
                      Banques et assurances utilisent massivement Airflow pour le reporting réglementaire, 
                      le scoring de crédit et la détection de fraude. Les proxies y sont omniprésents 
                      pour les connexions vers les bureaux de crédit et les APIs financières.
                    </p>
                    <Badge variant="destructive">Risque Critique</Badge>
                  </Card>
                  <Card className="p-6 border-2 border-slate-200 dark:border-slate-800">
                    <h4 className="font-black text-lg mb-4 flex items-center gap-2">
                      <Users className="w-5 h-5 text-green-500" /> E-commerce & Retail
                    </h4>
                    <p className="text-sm text-slate-600 dark:text-slate-400 mb-4">
                      Les géants du e-commerce orchestrent leurs recommandations produits, 
                      leur gestion de stock et leurs intégrations marketplace via Airflow. 
                      Les proxies sont utilisés pour scraper les prix concurrents.
                    </p>
                    <Badge className="bg-orange-500">Risque Élevé</Badge>
                  </Card>
                  <Card className="p-6 border-2 border-slate-200 dark:border-slate-800">
                    <h4 className="font-black text-lg mb-4 flex items-center gap-2">
                      <Cloud className="w-5 h-5 text-purple-500" /> Healthcare & Pharma
                    </h4>
                    <p className="text-sm text-slate-600 dark:text-slate-400 mb-4">
                      Pipelines de données cliniques, intégrations avec les systèmes de santé, 
                      et processus de pharmacovigilance. Les credentials exposés pourraient 
                      donner accès à des données de santé protégées (PHI).
                    </p>
                    <Badge variant="destructive">Risque Critique</Badge>
                  </Card>
                  <Card className="p-6 border-2 border-slate-200 dark:border-slate-800">
                    <h4 className="font-black text-lg mb-4 flex items-center gap-2">
                      <Globe className="w-5 h-5 text-cyan-500" /> Tech & SaaS
                    </h4>
                    <p className="text-sm text-slate-600 dark:text-slate-400 mb-4">
                      Les entreprises tech utilisent Airflow pour les analytics produit, 
                      le ML ops et les intégrations. Risque de compromission de clés API 
                      et d'accès aux systèmes internes.
                    </p>
                    <Badge className="bg-orange-500">Risque Élevé</Badge>
                  </Card>
                </div>

                <h3 className="text-2xl font-black mt-10 mb-6 text-slate-800 dark:text-slate-200">Conséquences Potentielles</h3>

                <ul className="space-y-3 mb-8">
                  <li className="flex items-start gap-3">
                    <AlertTriangle className="w-5 h-5 text-red-500 mt-0.5 flex-shrink-0" />
                    <span className="text-slate-800 dark:text-slate-200"><strong className="text-slate-900 dark:text-slate-100">Mouvement latéral</strong> : Les credentials proxy peuvent permettre un accès au réseau interne depuis l'extérieur</span>
                  </li>
                  <li className="flex items-start gap-3">
                    <AlertTriangle className="w-5 h-5 text-red-500 mt-0.5 flex-shrink-0" />
                    <span className="text-slate-800 dark:text-slate-200"><strong className="text-slate-900 dark:text-slate-100">Exfiltration de données</strong> : Utilisation du proxy pour extraire des données sans déclencher les alertes réseau</span>
                  </li>
                  <li className="flex items-start gap-3">
                    <AlertTriangle className="w-5 h-5 text-red-500 mt-0.5 flex-shrink-0" />
                    <span className="text-slate-800 dark:text-slate-200"><strong className="text-slate-900 dark:text-slate-100">Pivot d'attaque</strong> : Le proxy peut servir de point d'entrée pour des attaques plus sophistiquées</span>
                  </li>
                  <li className="flex items-start gap-3">
                    <AlertTriangle className="w-5 h-5 text-red-500 mt-0.5 flex-shrink-0" />
                    <span className="text-slate-800 dark:text-slate-200"><strong className="text-slate-900 dark:text-slate-100">Usurpation d'identité</strong> : Les comptes de service proxy ont souvent des privilèges élevés</span>
                  </li>
                </ul>

                <h3 className="text-2xl font-black mt-10 mb-6 text-slate-800 dark:text-slate-200">Témoignages d'Entreprises Affectées</h3>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Pour illustrer l'impact réel de cette vulnérabilité, nous avons recueilli (avec autorisation) 
                  les témoignages anonymisés de trois entreprises ayant découvert qu'elles étaient exposées :
                </p>

                <Card className="p-6 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800 mb-6">
                  <div className="flex items-start gap-4">
                    <div className="w-12 h-12 rounded-full bg-blue-500/20 flex items-center justify-center flex-shrink-0">
                      <Building2 className="w-6 h-6 text-blue-500" />
                    </div>
                    <div>
                      <p className="font-bold text-slate-800 dark:text-slate-200 mb-2">Fintech Européenne - 500 employés</p>
                      <p className="text-sm text-slate-600 dark:text-slate-400 italic leading-relaxed">
                        "Nous avons découvert lors d'un audit interne que nos credentials de proxy corporate étaient 
                        exposés dans les logs Airflow depuis 18 mois. Ces credentials donnaient accès à notre système 
                        de trading algorithmique. Heureusement, aucune compromission n'a été détectée, mais nous avons 
                        dû effectuer une rotation complète de tous nos secrets et revoir notre architecture de logging."
                      </p>
                    </div>
                  </div>
                </Card>

                <Card className="p-6 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800 mb-6">
                  <div className="flex items-start gap-4">
                    <div className="w-12 h-12 rounded-full bg-green-500/20 flex items-center justify-center flex-shrink-0">
                      <Cloud className="w-6 h-6 text-green-500" />
                    </div>
                    <div>
                      <p className="font-bold text-slate-800 dark:text-slate-200 mb-2">SaaS B2B - Scale-up, 150 employés</p>
                      <p className="text-sm text-slate-600 dark:text-slate-400 italic leading-relaxed">
                        "Notre équipe data utilisait Airflow sur GCP Composer. Les logs étaient exportés vers BigQuery 
                        pour analyse, accessible à une vingtaine de personnes. Un stagiaire a accidentellement découvert 
                        des URLs proxy avec mots de passe en explorant les données. Cela nous a poussés à implémenter 
                        HashiCorp Vault et à revoir complètement notre gestion des secrets."
                      </p>
                    </div>
                  </div>
                </Card>

                <Card className="p-6 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800 mb-8">
                  <div className="flex items-start gap-4">
                    <div className="w-12 h-12 rounded-full bg-purple-500/20 flex items-center justify-center flex-shrink-0">
                      <Users className="w-6 h-6 text-purple-500" />
                    </div>
                    <div>
                      <p className="font-bold text-slate-800 dark:text-slate-200 mb-2">E-commerce International - 2000+ employés</p>
                      <p className="text-sm text-slate-600 dark:text-slate-400 italic leading-relaxed">
                        "Le proxy exposé dans nos logs Airflow était utilisé pour accéder aux APIs de nos partenaires 
                        logistiques. Nous avons dû contacter une dizaine de partenaires pour leur demander de révoquer 
                        et régénérer les credentials, ce qui a causé des interruptions de service pendant 48 heures. 
                        Le coût total estimé de l'incident, en incluant le temps passé et les pénalités contractuelles, 
                        dépasse 200 000 euros."
                      </p>
                    </div>
                  </div>
                </Card>

                <h3 className="text-2xl font-black mt-10 mb-6 text-slate-800 dark:text-slate-200">Analyse des Coûts d'un Incident</h3>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Au-delà des risques techniques, il est important de quantifier l'impact financier potentiel 
                  d'une exploitation de cette vulnérabilité. Voici une estimation basée sur les données du marché 
                  et les témoignages recueillis :
                </p>

                <div className="grid md:grid-cols-3 gap-4 my-8">
                  <Card className="p-4 border-2 border-red-500/30 bg-red-50 dark:bg-red-950/20">
                    <h4 className="font-black text-red-700 dark:text-red-400 mb-2">Coûts Directs</h4>
                    <ul className="space-y-1 text-sm text-red-600 dark:text-red-300">
                      <li>• Investigation forensique : 50-150K€</li>
                      <li>• Rotation des secrets : 10-50K€</li>
                      <li>• Notification RGPD : 5-20K€</li>
                      <li>• Conseil juridique : 20-100K€</li>
                    </ul>
                  </Card>
                  <Card className="p-4 border-2 border-orange-500/30 bg-orange-50 dark:bg-orange-950/20">
                    <h4 className="font-black text-orange-700 dark:text-orange-400 mb-2">Coûts Indirects</h4>
                    <ul className="space-y-1 text-sm text-orange-600 dark:text-orange-300">
                      <li>• Interruption de service : Variable</li>
                      <li>• Perte de confiance clients : Significatif</li>
                      <li>• Temps équipes IT/Security : 40-200K€</li>
                      <li>• Audit sécurité renforcé : 30-100K€</li>
                    </ul>
                  </Card>
                  <Card className="p-4 border-2 border-purple-500/30 bg-purple-50 dark:bg-purple-950/20">
                    <h4 className="font-black text-purple-700 dark:text-purple-400 mb-2">Amendes Potentielles</h4>
                    <ul className="space-y-1 text-sm text-purple-600 dark:text-purple-300">
                      <li>• RGPD : Jusqu'à 4% du CA</li>
                      <li>• PCI-DSS : 5K-100K€/mois</li>
                      <li>• Contractuelles : Variable</li>
                      <li>• Réputationnelles : Incalculable</li>
                    </ul>
                  </Card>
                </div>
              </section>

              <section id="remediation" className="mb-16">
                <h2 className="text-3xl font-black mb-8 text-green-600 dark:text-green-500 flex items-center gap-3">
                  <Shield className="w-8 h-8" /> 6. Guide de Remédiation Complet
                </h2>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  La correction de cette vulnérabilité nécessite une approche en plusieurs étapes, 
                  allant de la mise à jour immédiate à un audit complet des credentials potentiellement exposés.
                </p>

                <h3 className="text-2xl font-black mt-10 mb-6 text-green-600 dark:text-green-500">Étape 1 : Mise à Jour Immédiate</h3>

                <Card className="p-6 bg-green-50 dark:bg-green-900/10 border border-green-500/30 mb-8">
                  <h4 className="font-black text-green-700 dark:text-green-400 mb-4">Commandes de Mise à Jour</h4>
                  <pre className="bg-slate-900 p-4 rounded-lg overflow-x-auto text-sm">
                    <code className="text-green-400 font-mono">{`# Vérifier la version actuelle
pip show apache-airflow

# Mettre à jour vers la version corrigée
pip install apache-airflow==3.1.6

# Pour les environnements avec contraintes
pip install "apache-airflow>=3.1.6,<4.0.0"

# Redémarrer les services Airflow
airflow webserver --daemon
airflow scheduler --daemon`}</code>
                  </pre>
                </Card>

                <h3 className="text-2xl font-black mt-10 mb-6 text-orange-600 dark:text-orange-500">Étape 2 : Rotation des Credentials</h3>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Après la mise à jour, il est <strong className="text-slate-900 dark:text-slate-100">impératif</strong> de procéder à une rotation 
                  de tous les credentials proxy qui auraient pu être exposés dans les logs :
                </p>

                <ul className="space-y-3 mb-8">
                  <li className="flex items-start gap-3">
                    <CheckCircle className="w-5 h-5 text-green-500 mt-0.5 flex-shrink-0" />
                    <span className="text-slate-800 dark:text-slate-200"><strong className="text-slate-900 dark:text-slate-100">Identifier les Connections concernées</strong> : Listez toutes les Connections utilisant des proxies avec authentication</span>
                  </li>
                  <li className="flex items-start gap-3">
                    <CheckCircle className="w-5 h-5 text-green-500 mt-0.5 flex-shrink-0" />
                    <span className="text-slate-800 dark:text-slate-200"><strong className="text-slate-900 dark:text-slate-100">Générer de nouveaux credentials</strong> : Créez de nouveaux comptes/mots de passe pour chaque proxy</span>
                  </li>
                  <li className="flex items-start gap-3">
                    <CheckCircle className="w-5 h-5 text-green-500 mt-0.5 flex-shrink-0" />
                    <span className="text-slate-800 dark:text-slate-200"><strong className="text-slate-900 dark:text-slate-100">Mettre à jour les Connections</strong> : Remplacez les credentials dans Airflow et désactivez les anciens</span>
                  </li>
                  <li className="flex items-start gap-3">
                    <CheckCircle className="w-5 h-5 text-green-500 mt-0.5 flex-shrink-0" />
                    <span className="text-slate-800 dark:text-slate-200"><strong className="text-slate-900 dark:text-slate-100">Surveiller les accès</strong> : Mettez en place une surveillance sur les anciens credentials pour détecter une utilisation malveillante</span>
                  </li>
                </ul>

                <h3 className="text-2xl font-black mt-10 mb-6 text-blue-600 dark:text-blue-500">Étape 3 : Audit et Purge des Logs</h3>

                <Card className="p-6 bg-blue-50 dark:bg-blue-900/10 border border-blue-500/30 mb-8">
                  <h4 className="font-black text-blue-700 dark:text-blue-400 mb-4">Script d'Audit des Logs</h4>
                  <pre className="bg-slate-900 p-4 rounded-lg overflow-x-auto text-sm">
                    <code className="text-green-400 font-mono">{`#!/bin/bash
# Script pour identifier les logs potentiellement exposés

# Rechercher les patterns de proxy avec credentials
grep -r -E "proxy.*://[^:]+:[^@]+@" /var/log/airflow/
grep -r -E "proxies.*://[^:]+:[^@]+@" /var/log/airflow/

# Si vous utilisez un système de logs centralisé
# Adaptez la requête pour votre système (Elasticsearch, Splunk, etc.)

# Pour Elasticsearch :
# curl -X GET "localhost:9200/airflow-*/_search" -H 'Content-Type: application/json' -d'
# {
#   "query": {
#     "regexp": {
#       "message": "proxy.*://[^:]+:[^@]+@.*"
#     }
#   }
# }'`}</code>
                  </pre>
                </Card>

                <h3 className="text-2xl font-black mt-10 mb-6 text-purple-600 dark:text-purple-500">Étape 4 : Mesures Préventives</h3>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Pour prévenir de futures expositions de credentials dans les logs, implémentez les mesures suivantes :
                </p>

                <div className="grid md:grid-cols-2 gap-6 my-8">
                  <Card className="p-6 border-2 border-slate-200 dark:border-slate-800">
                    <h4 className="font-black text-lg mb-4 flex items-center gap-2">
                      <Settings className="w-5 h-5 text-purple-500" /> Configuration Airflow
                    </h4>
                    <ul className="space-y-2 text-sm text-slate-600 dark:text-slate-400">
                      <li>• Configurer <code>hide_sensitive_var_conn_fields = True</code></li>
                      <li>• Utiliser des Secrets Backends (Vault, AWS Secrets Manager)</li>
                      <li>• Limiter le niveau de log en production</li>
                      <li>• Configurer des filtres de redaction personnalisés</li>
                    </ul>
                  </Card>
                  <Card className="p-6 border-2 border-slate-200 dark:border-slate-800">
                    <h4 className="font-black text-lg mb-4 flex items-center gap-2">
                      <LockIcon className="w-5 h-5 text-blue-500" /> Bonnes Pratiques
                    </h4>
                    <ul className="space-y-2 text-sm text-slate-600 dark:text-slate-400">
                      <li>• Ne jamais inclure de credentials dans les URLs</li>
                      <li>• Utiliser des tokens temporaires quand possible</li>
                      <li>• Implémenter une rotation automatique des secrets</li>
                      <li>• Auditer régulièrement les logs pour les fuites</li>
                    </ul>
                  </Card>
                </div>
              </section>

              <section id="conformite" className="mb-16">
                <h2 className="text-3xl font-black mb-8 text-purple-600 dark:text-purple-500 flex items-center gap-3">
                  <Scale className="w-8 h-8" /> 7. Implications pour la Conformité
                </h2>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  L'exposition de credentials dans les logs a des implications significatives en termes de conformité 
                  réglementaire, particulièrement pour les organisations soumises au RGPD, PCI-DSS, ou HIPAA.
                </p>

                <h3 className="text-2xl font-black mt-10 mb-6 text-slate-800 dark:text-slate-200">RGPD et Protection des Données</h3>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Sous le Règlement Général sur la Protection des Données (RGPD), l'exposition de credentials 
                  qui permettent d'accéder à des données personnelles peut constituer une violation de données 
                  nécessitant une notification :
                </p>

                <Card className="p-6 bg-purple-50 dark:bg-purple-900/10 border border-purple-500/30 mb-8">
                  <h4 className="font-black text-purple-700 dark:text-purple-400 mb-4">Obligations Légales RGPD</h4>
                  <ul className="space-y-3">
                    <li className="flex items-start gap-3">
                      <CheckCircle className="w-5 h-5 text-purple-500 mt-0.5 flex-shrink-0" />
                      <span className="text-purple-700 dark:text-purple-300"><strong>Notification à l'autorité (CNIL)</strong> : Dans les 72 heures si des données personnelles sont potentiellement compromises</span>
                    </li>
                    <li className="flex items-start gap-3">
                      <CheckCircle className="w-5 h-5 text-purple-500 mt-0.5 flex-shrink-0" />
                      <span className="text-purple-700 dark:text-purple-300"><strong>Information des personnes concernées</strong> : Si le risque pour leurs droits et libertés est élevé</span>
                    </li>
                    <li className="flex items-start gap-3">
                      <CheckCircle className="w-5 h-5 text-purple-500 mt-0.5 flex-shrink-0" />
                      <span className="text-purple-700 dark:text-purple-300"><strong>Documentation de l'incident</strong> : Tenir un registre des violations avec mesures correctives</span>
                    </li>
                  </ul>
                </Card>

                <h3 className="text-2xl font-black mt-10 mb-6 text-slate-800 dark:text-slate-200">PCI-DSS pour le Secteur Financier</h3>

                <p className="leading-relaxed mb-6 text-slate-800 dark:text-slate-200">
                  Les organisations qui traitent des données de cartes de paiement doivent se conformer au standard 
                  PCI-DSS, qui impose des exigences strictes sur la gestion des logs et des credentials :
                </p>

                <ul className="space-y-3 mb-8">
                  <li className="flex items-start gap-3">
                    <AlertTriangle className="w-5 h-5 text-orange-500 mt-0.5 flex-shrink-0" />
                    <span className="text-slate-800 dark:text-slate-200"><strong className="text-slate-900 dark:text-slate-100">Requirement 3</strong> : Protection des données stockées - les credentials exposés violent potentiellement ce requirement</span>
                  </li>
                  <li className="flex items-start gap-3">
                    <AlertTriangle className="w-5 h-5 text-orange-500 mt-0.5 flex-shrink-0" />
                    <span className="text-slate-800 dark:text-slate-200"><strong className="text-slate-900 dark:text-slate-100">Requirement 8</strong> : Gestion des accès - les credentials proxy compromis peuvent faciliter un accès non autorisé</span>
                  </li>
                  <li className="flex items-start gap-3">
                    <AlertTriangle className="w-5 h-5 text-orange-500 mt-0.5 flex-shrink-0" />
                    <span className="text-slate-800 dark:text-slate-200"><strong className="text-slate-900 dark:text-slate-100">Requirement 10</strong> : Surveillance des accès - nécessité d'auditer les logs pour détecter les accès frauduleux</span>
                  </li>
                </ul>

                <h3 className="text-2xl font-black mt-10 mb-6 text-slate-800 dark:text-slate-200">Recommandations pour les Équipes Conformité</h3>

                <div className="grid md:grid-cols-2 gap-6 my-8">
                  <Card className="p-6 border-2 border-slate-200 dark:border-slate-800">
                    <h4 className="font-black text-lg mb-4">Actions Immédiates</h4>
                    <ul className="space-y-2 text-sm text-slate-600 dark:text-slate-400">
                      <li>1. Évaluer l'exposition potentielle</li>
                      <li>2. Documenter l'incident dans le registre</li>
                      <li>3. Informer le DPO si applicable</li>
                      <li>4. Préparer une notification si nécessaire</li>
                    </ul>
                  </Card>
                  <Card className="p-6 border-2 border-slate-200 dark:border-slate-800">
                    <h4 className="font-black text-lg mb-4">Actions Long Terme</h4>
                    <ul className="space-y-2 text-sm text-slate-600 dark:text-slate-400">
                      <li>1. Revoir les politiques de gestion des secrets</li>
                      <li>2. Implémenter des contrôles de détection</li>
                      <li>3. Former les équipes sur les bonnes pratiques</li>
                      <li>4. Planifier des audits réguliers des logs</li>
                    </ul>
                  </Card>
                </div>
              </section>

              <section id="faq" className="mb-16">
                <h2 className="text-3xl font-black mb-8 text-primary dark:text-primary flex items-center gap-3">
                  <FileText className="w-8 h-8" /> 8. Questions Fréquentes (FAQ)
                </h2>

                <div className="space-y-6">
                  <Card className="p-6 border border-slate-200 dark:border-slate-800">
                    <h4 className="font-black text-lg mb-3 text-slate-800 dark:text-slate-200">
                      Qu'est-ce que la CVE-2026-68675 exactement ?
                    </h4>
                    <p className="text-slate-600 dark:text-slate-400 leading-relaxed">
                      La CVE-2026-68675 est une vulnérabilité de divulgation d'informations sensibles dans Apache Airflow. 
                      Elle permet l'exposition des credentials d'authentification proxy dans les logs de tâches, 
                      car les champs <code>proxy</code> et <code>proxies</code> n'étaient pas traités comme sensibles 
                      et donc pas masqués automatiquement.
                    </p>
                  </Card>

                  <Card className="p-6 border border-slate-200 dark:border-slate-800">
                    <h4 className="font-black text-lg mb-3 text-slate-800 dark:text-slate-200">
                      Comment vérifier si mon installation est vulnérable ?
                    </h4>
                    <p className="text-slate-600 dark:text-slate-400 leading-relaxed">
                      Exécutez <code>pip show apache-airflow</code> pour voir votre version actuelle. 
                      Toutes les versions antérieures à 3.1.6 sont vulnérables. Vérifiez également si vous 
                      utilisez des Connections avec des proxies authentifiés (URLs contenant des credentials).
                    </p>
                  </Card>

                  <Card className="p-6 border border-slate-200 dark:border-slate-800">
                    <h4 className="font-black text-lg mb-3 text-slate-800 dark:text-slate-200">
                      Les services managés (AWS MWAA, GCP Composer) sont-ils affectés ?
                    </h4>
                    <p className="text-slate-600 dark:text-slate-400 leading-relaxed">
                      Les services managés mettent généralement à jour leurs instances plus rapidement. 
                      Contactez votre fournisseur cloud pour confirmer que la version 3.1.6+ est déployée. 
                      AWS et Google ont généralement un délai de quelques jours à quelques semaines 
                      pour déployer les patches de sécurité.
                    </p>
                  </Card>

                  <Card className="p-6 border border-slate-200 dark:border-slate-800">
                    <h4 className="font-black text-lg mb-3 text-slate-800 dark:text-slate-200">
                      Dois-je notifier les autorités de protection des données ?
                    </h4>
                    <p className="text-slate-600 dark:text-slate-400 leading-relaxed">
                      Cela dépend de votre évaluation de l'impact. Si les credentials exposés permettent 
                      d'accéder à des données personnelles, et si vous avez des raisons de croire qu'un 
                      accès non autorisé a pu avoir lieu, une notification peut être requise sous le RGPD 
                      (dans les 72 heures). Consultez votre DPO et votre équipe juridique.
                    </p>
                  </Card>

                  <Card className="p-6 border border-slate-200 dark:border-slate-800">
                    <h4 className="font-black text-lg mb-3 text-slate-800 dark:text-slate-200">
                      Comment éviter ce type de vulnérabilité à l'avenir ?
                    </h4>
                    <p className="text-slate-600 dark:text-slate-400 leading-relaxed">
                      Adoptez une approche "secrets-first" : utilisez un gestionnaire de secrets centralisé 
                      (HashiCorp Vault, AWS Secrets Manager), évitez d'inclure des credentials dans les URLs, 
                      implémentez des filtres de redaction sur vos logs, et auditez régulièrement vos logs 
                      pour détecter les fuites accidentelles.
                    </p>
                  </Card>
                </div>
              </section>

              <Card className="p-8 bg-gradient-to-r from-orange-500/10 to-red-500/10 border-2 border-orange-500/30 mb-8">
                <h2 className="text-2xl font-black mb-4 text-orange-500 dark:text-orange-400 flex items-center gap-3">
                  <ShieldAlert className="w-7 h-7" /> Conclusion
                </h2>
                <p className="leading-relaxed text-slate-700 dark:text-slate-300 mb-4">
                  La CVE-2026-68675 illustre parfaitement les risques liés à la gestion des secrets dans les 
                  environnements de data engineering modernes. Bien que moins spectaculaire qu'une vulnérabilité 
                  RCE, son impact potentiel sur la confidentialité et la conformité est considérable.
                </p>
                <p className="leading-relaxed text-slate-700 dark:text-slate-300">
                  L'action immédiate est de mettre à jour vers Apache Airflow 3.1.6 ou supérieur, 
                  suivie d'une rotation des credentials et d'un audit des logs. À plus long terme, 
                  cette vulnérabilité doit servir de rappel pour renforcer les pratiques de gestion 
                  des secrets et de surveillance des logs.
                </p>
              </Card>

            </div>

            <Card className="p-6 bg-slate-50 dark:bg-slate-900/50 border border-slate-200 dark:border-slate-800">
              <h3 className="font-black mb-4 text-slate-700 dark:text-slate-300">Références et Sources</h3>
              <ul className="space-y-2 text-sm">
                <li>
                  <a href="https://nvd.nist.gov/vuln/detail/CVE-2026-68675" target="_blank" rel="noopener noreferrer" className="flex items-center gap-2 text-primary hover:underline">
                    <ExternalLink className="w-4 h-4" /> NVD - CVE-2026-68675
                  </a>
                </li>
                <li>
                  <a href="https://github.com/advisories/GHSA-7c2f-r6gc-h92h" target="_blank" rel="noopener noreferrer" className="flex items-center gap-2 text-primary hover:underline">
                    <ExternalLink className="w-4 h-4" /> GitHub Security Advisory GHSA-7c2f-r6gc-h92h
                  </a>
                </li>
                <li>
                  <a href="https://lists.apache.org/thread/x6kply4nqd4vc4wgxtm6g9r2tt63s8c5" target="_blank" rel="noopener noreferrer" className="flex items-center gap-2 text-primary hover:underline">
                    <ExternalLink className="w-4 h-4" /> Apache Mailing List Announcement
                  </a>
                </li>
                <li>
                  <a href="https://github.com/apache/airflow" target="_blank" rel="noopener noreferrer" className="flex items-center gap-2 text-primary hover:underline">
                    <ExternalLink className="w-4 h-4" /> Apache Airflow GitHub Repository
                  </a>
                </li>
              </ul>
            </Card>

            <ArticleComments 
              articleId="cve-2026-68675-airflow" 
              articleTitle="CVE-2026-68675 : Fuite de Credentials Proxy Apache Airflow"
            />
          </div>
        </div>
      </article>

      <section className="py-16 bg-orange-500 dark:bg-orange-600">
        <div className="container px-4 mx-auto text-center">
          <h2 className="text-3xl font-black text-white mb-4">
            Protégez Vos Pipelines de Données
          </h2>
          <p className="text-xl text-orange-100 mb-8 max-w-2xl mx-auto">
            Besoin d'aide pour sécuriser votre infrastructure Apache Airflow ? 
            Découvrez nos guides et recommandations pour un data engineering sécurisé.
          </p>
          <div className="flex flex-wrap justify-center gap-4">
            <Link href="/audit-site">
              <Button size="lg" className="bg-white text-orange-600 hover:bg-orange-50">
                <Search className="w-5 h-5 mr-2" /> Audit de Sécurité Gratuit
              </Button>
            </Link>
            <Link href="/">
              <Button size="lg" variant="outline" className="border-white text-white hover:bg-orange-600">
                <ArrowLeft className="w-5 h-5 mr-2" /> Retour à l'Accueil
              </Button>
            </Link>
          </div>
        </div>
      </section>
    </div>
  );
}
