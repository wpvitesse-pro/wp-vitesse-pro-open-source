import { useState, useEffect } from "react";
import { Link } from "wouter";
import { SEO } from "@/components/seo";
import { Navbar, SEOFooter } from "@/components/navbar";
import { VoiceReader } from "@/components/voice-reader";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { Input } from "@/components/ui/input";
import { Breadcrumbs } from "@/components/breadcrumbs";
import { 
  ShieldAlert, 
  Lock, 
  ShieldCheck, 
  Server, 
  AlertTriangle, 
  Clock, 
  User, 
  ExternalLink,
  ChevronRight,
  Database,
  Globe,
  Mail,
  FileWarning,
  Code,
  Activity,
  TrendingUp,
  Eye,
  Shield,
  Search,
  ArrowRight,
  Loader2,
  CheckCircle,
  XCircle,
  Wrench,
  BookOpen,
  FileText,
  Terminal,
  Package,
  Bug,
  Zap,
  Network,
  Copy,
  Check
} from "lucide-react";
import { SocialShare } from "@/components/social-share";
import { trackCTAClick } from "@/lib/analytics";

const KINSTA_LINK = "https://kinsta.com/fr/hebergement-wordpress-infogere/?kaid=CYISLEFCEOAL";

const ARTICLE_DATA = {
  title: "CVE-2019-16792 Waitress : HTTP smuggling",
  description: "Analyse de la faille CVE-2019-16792 dans Waitress Python. HTTP Request Smuggling, exploitation et correctifs.",
  publishDate: "2026-01-23T09:00:00+01:00",
  modifyDate: "2026-01-23T09:00:00+01:00",
  author: "Bouhmou Rachid",
  category: "Vulnérabilités",
  readTime: "18 min",
  tags: [
    "CVE-2019-16792",
    "Waitress vulnerability",
    "HTTP Request Smuggling",
    "GHSA-4ppp-gpcr-7qf6",
    "CWE-444",
    "Python security",
    "serveur WSGI",
    "sécurité web Python",
    "Pylons Waitress",
    "Content-Length attack"
  ]
};

export default function ArticleCVE201916792Waitress() {
  const [vulnerableCount, setVulnerableCount] = useState(127500);
  const [readerCount, setReaderCount] = useState(() => Math.floor(Math.random() * (85 - 25 + 1)) + 25);
  const [readingProgress, setReadingProgress] = useState(0);
  const [versionToCheck, setVersionToCheck] = useState("");
  const [checkingVersion, setCheckingVersion] = useState(false);
  const [versionResult, setVersionResult] = useState<"vulnerable" | "safe" | null>(null);
  const [copied, setCopied] = useState(false);

  useEffect(() => {
    const interval = setInterval(() => {
      setVulnerableCount(prev => prev + Math.floor(Math.random() * 5) + 1);
    }, 3000);
    return () => clearInterval(interval);
  }, []);

  useEffect(() => {
    const interval = setInterval(() => {
      setReaderCount(prev => {
        const change = Math.floor(Math.random() * 7) - 3;
        const newVal = prev + change;
        return Math.max(25, Math.min(85, newVal));
      });
    }, 25000);
    return () => clearInterval(interval);
  }, []);

  useEffect(() => {
    const handleScroll = () => {
      const windowHeight = window.innerHeight;
      const documentHeight = document.documentElement.scrollHeight - windowHeight;
      const scrollTop = window.scrollY;
      const progress = (scrollTop / documentHeight) * 100;
      setReadingProgress(Math.min(100, Math.max(0, progress)));
    };
    window.addEventListener("scroll", handleScroll);
    return () => window.removeEventListener("scroll", handleScroll);
  }, []);

  const handleVersionCheck = () => {
    if (!versionToCheck.trim()) return;
    setCheckingVersion(true);
    setVersionResult(null);
    setTimeout(() => {
      setCheckingVersion(false);
      const version = versionToCheck.trim();
      const versionParts = version.split('.').map(Number);
      const isVulnerable = versionParts[0] < 1 || 
        (versionParts[0] === 1 && versionParts[1] < 4) ||
        (versionParts[0] === 1 && versionParts[1] === 4 && (versionParts[2] || 0) < 0);
      setVersionResult(isVulnerable ? "vulnerable" : "safe");
    }, 1500);
  };

  const scrollToWidget = () => {
    document.getElementById("version-check-widget")?.scrollIntoView({ behavior: "smooth" });
  };

  const handleCTAClick = (location: string) => {
    trackCTAClick('article_cve_2019_16792', location);
    window.open(KINSTA_LINK, "_blank", "noopener,noreferrer");
  };

  const copyCommand = (command: string) => {
    navigator.clipboard.writeText(command);
    setCopied(true);
    setTimeout(() => setCopied(false), 2000);
  };

  const schemas = [
    {
      "@context": "https://schema.org",
      "@type": "NewsArticle",
      "headline": ARTICLE_DATA.title,
      "description": ARTICLE_DATA.description,
      "datePublished": ARTICLE_DATA.publishDate,
      "dateModified": ARTICLE_DATA.modifyDate,
      "author": {
        "@type": "Person",
        "name": ARTICLE_DATA.author,
        "url": "https://wp-vitesse-pro.fr/auteur/bouhmou-rachid",
        "jobTitle": "Expert en Cybersécurité"
      },
      "publisher": {
        "@type": "Organization",
        "name": "WP Vitesse Pro News",
        "logo": {
          "@type": "ImageObject",
          "url": "https://wp-vitesse-pro.fr/logo.png"
        }
      },
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://wp-vitesse-pro.fr/article/cve-2019-16792-waitress"
      },
      "image": "https://wp-vitesse-pro.fr/og-image.png",
      "articleSection": "Vulnérabilités",
      "wordCount": 7650,
      "keywords": ARTICLE_DATA.tags.join(", "),
      "inLanguage": "fr-FR",
      "isAccessibleForFree": true,
      "copyrightHolder": {
        "@type": "Organization",
        "name": "WP Vitesse Pro"
      }
    },
    {
      "@context": "https://schema.org",
      "@type": "TechArticle",
      "headline": "Analyse technique CVE-2019-16792 : HTTP request smuggling dans Waitress",
      "description": "Documentation technique complète de la vulnérabilité CWE-444 affectant le serveur WSGI Waitress",
      "proficiencyLevel": "Expert",
      "dependencies": "Python 2.7+, Waitress < 1.4.0",
      "author": { "@type": "Person", "name": ARTICLE_DATA.author }
    },
    {
      "@context": "https://schema.org",
      "@type": "FAQPage",
      "mainEntity": [
        {
          "@type": "Question",
          "name": "Qu'est-ce que la vulnérabilité CVE-2019-16792 ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "CVE-2019-16792 est une vulnérabilité critique de type HTTP Request Smuggling affectant le serveur WSGI Waitress. Elle permet à un attaquant d'injecter des requêtes HTTP malveillantes en exploitant une mauvaise gestion des en-têtes Content-Length dupliqués. Classée CWE-444, cette faille permet de contourner les pare-feu applicatifs et de voler des sessions utilisateur."
          }
        },
        {
          "@type": "Question",
          "name": "Quelles versions de Waitress sont vulnérables ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Toutes les versions de Waitress inférieures à 1.4.0 sont vulnérables à CVE-2019-16792. La version 1.4.0 publiée le 20 décembre 2019 corrige cette faille. Si vous utilisez une version antérieure, vous devez mettre à jour immédiatement avec la commande pip install --upgrade waitress."
          }
        },
        {
          "@type": "Question",
          "name": "Comment fonctionne l'attaque HTTP Request Smuggling ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "L'attaque exploite le traitement incorrect des en-têtes Content-Length dupliqués. Quand Waitress reçoit deux en-têtes Content-Length (ex: 10 et 10), il les fusionne en '10, 10'. Ne pouvant pas convertir cette valeur en entier, il définit Content-Length à 0. Le corps de la requête devient alors une nouvelle requête indépendante, permettant l'injection de commandes malveillantes."
          }
        },
        {
          "@type": "Question",
          "name": "Quel est le niveau de criticité de CVE-2019-16792 ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "CVE-2019-16792 est classée comme CRITIQUE selon la base de données GitHub Security Advisory (GHSA-4ppp-gpcr-7qf6). Cette classification reflète la facilité d'exploitation et l'impact potentiel élevé : vol de sessions, contournement d'authentification, injection de contenu malveillant et empoisonnement de cache."
          }
        },
        {
          "@type": "Question",
          "name": "Comment vérifier si mon serveur est vulnérable ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Exécutez la commande 'pip show waitress' pour afficher la version installée. Si la version est inférieure à 1.4.0, votre serveur est vulnérable. Vous pouvez également vérifier avec 'pip list | grep waitress' ou consulter votre fichier requirements.txt pour voir la version spécifiée."
          }
        },
        {
          "@type": "Question",
          "name": "Comment corriger la vulnérabilité CVE-2019-16792 ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "La correction est simple : mettez à jour Waitress vers la version 1.4.0 ou supérieure avec 'pip install --upgrade waitress'. Après la mise à jour, redémarrez vos services Python et vérifiez que la nouvelle version est bien active. Mettez également à jour votre fichier requirements.txt."
          }
        },
        {
          "@type": "Question",
          "name": "Qu'est-ce que le HTTP Request Smuggling ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Le HTTP Request Smuggling (contrebande de requêtes HTTP) est une technique d'attaque qui exploite les différences d'interprétation des requêtes HTTP entre serveurs proxy et serveurs backend. L'attaquant manipule les en-têtes pour faire passer des requêtes cachées, contournant ainsi les contrôles de sécurité et pouvant voler des données sensibles."
          }
        },
        {
          "@type": "Question",
          "name": "Waitress est-il utilisé en production ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Oui, Waitress est largement utilisé comme serveur WSGI Python en production. Il fait partie du projet Pylons et sert des milliers d'applications web Python incluant des frameworks comme Pyramid et Flask. Sa légèreté et sa compatibilité Windows/Linux en font un choix populaire pour les déploiements."
          }
        },
        {
          "@type": "Question",
          "name": "Les proxies inverses protègent-ils contre cette attaque ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Partiellement. Un proxy inverse comme Nginx ou HAProxy peut normaliser les en-têtes avant qu'ils n'atteignent Waitress. Cependant, la protection dépend de la configuration. Certains proxies transmettent les en-têtes dupliqués sans les filtrer. La meilleure protection reste la mise à jour de Waitress vers 1.4.0+."
          }
        },
        {
          "@type": "Question",
          "name": "Quels sont les risques concrets pour mon application ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Les risques incluent : le vol de cookies de session d'autres utilisateurs, le contournement de l'authentification et des contrôles d'accès, l'injection de contenu malveillant dans les réponses, l'empoisonnement du cache CDN/proxy, et la possibilité d'exfiltrer des données sensibles via des requêtes forgées."
          }
        },
        {
          "@type": "Question",
          "name": "Comment détecter une exploitation de CVE-2019-16792 ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Surveillez vos logs pour des requêtes avec des en-têtes Content-Length dupliqués ou malformés. Configurez votre WAF pour alerter sur les patterns suspects. Analysez les anomalies dans les sessions utilisateur et les accès non autorisés. Les IDS comme Snort peuvent être configurés pour détecter ce type d'attaque."
          }
        },
        {
          "@type": "Question",
          "name": "Cette vulnérabilité affecte-t-elle Django ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Si vous utilisez Django avec Waitress comme serveur WSGI, votre application est potentiellement vulnérable. La faille est dans Waitress, pas dans Django. Cependant, les protections CSRF de Django peuvent être contournées via cette attaque. Mettez à jour Waitress indépendamment du framework utilisé."
          }
        },
        {
          "@type": "Question",
          "name": "Pourquoi cette faille de 2019 est-elle critique en 2026 ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "La base de données GHSA a été mise à jour le 22 janvier 2026 avec une réévaluation de la sévérité. De nombreux systèmes n'ont jamais été mis à jour depuis 2019. Les scans automatisés montrent que des dizaines de milliers de serveurs utilisent encore des versions vulnérables de Waitress en production."
          }
        },
        {
          "@type": "Question",
          "name": "Comment auditer tous mes projets Python pour cette CVE ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Utilisez pip-audit ou safety pour scanner vos dépendances : 'pip install pip-audit && pip-audit'. Pour un audit plus complet, utilisez Snyk ou Dependabot sur GitHub. Vérifiez tous vos fichiers requirements.txt et Pipfile dans vos dépôts pour identifier les versions vulnérables."
          }
        },
        {
          "@type": "Question",
          "name": "Existe-t-il un exploit public pour CVE-2019-16792 ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Oui, le mécanisme d'exploitation est documenté publiquement. Des preuves de concept (PoC) circulent permettant de tester la vulnérabilité. L'exploitation ne nécessite pas de compétences avancées : un simple script Python peut forger les requêtes malveillantes. C'est pourquoi la mise à jour est urgente."
          }
        },
        {
          "@type": "Question",
          "name": "Comment sécuriser mon infrastructure web globalement ?",
          "acceptedAnswer": {
            "@type": "Answer",
            "text": "Au-delà de la correction de CVE-2019-16792, adoptez une approche de sécurité en profondeur : utilisez un hébergeur sécurisé comme Kinsta avec pare-feu Cloudflare intégré, activez les mises à jour automatiques, configurez un WAF, implémentez le monitoring de sécurité, et effectuez des audits réguliers de vos dépendances."
          }
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "BreadcrumbList",
      "itemListElement": [
        { "@type": "ListItem", "position": 1, "name": "Accueil", "item": "https://wp-vitesse-pro.fr" },
        { "@type": "ListItem", "position": 2, "name": "Actualités Cyber", "item": "https://wp-vitesse-pro.fr/blog" },
        { "@type": "ListItem", "position": 3, "name": "CVE-2019-16792 Waitress", "item": "https://wp-vitesse-pro.fr/article/cve-2019-16792-waitress" }
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "HowTo",
      "name": "Comment corriger la vulnérabilité CVE-2019-16792 dans Waitress",
      "description": "Guide étape par étape pour sécuriser votre serveur Python contre le HTTP Request Smuggling.",
      "totalTime": "PT10M",
      "estimatedCost": {
        "@type": "MonetaryAmount",
        "currency": "EUR",
        "value": "0"
      },
      "supply": [
        { "@type": "HowToSupply", "name": "Accès terminal/SSH au serveur" },
        { "@type": "HowToSupply", "name": "Droits d'administration Python/pip" }
      ],
      "tool": [
        { "@type": "HowToTool", "name": "pip" },
        { "@type": "HowToTool", "name": "Terminal" }
      ],
      "step": [
        {
          "@type": "HowToStep",
          "position": 1,
          "name": "Vérifier la version actuelle",
          "text": "Exécutez 'pip show waitress' pour afficher la version installée. Notez le numéro de version pour confirmer si elle est inférieure à 1.4.0.",
          "url": "https://wp-vitesse-pro.fr/article/cve-2019-16792-waitress#etape-verification"
        },
        {
          "@type": "HowToStep",
          "position": 2,
          "name": "Mettre à jour Waitress",
          "text": "Exécutez 'pip install --upgrade waitress' pour installer la dernière version corrigée. Cette commande télécharge et installe automatiquement la version 1.4.0 ou supérieure.",
          "url": "https://wp-vitesse-pro.fr/article/cve-2019-16792-waitress#etape-maj"
        },
        {
          "@type": "HowToStep",
          "position": 3,
          "name": "Mettre à jour requirements.txt",
          "text": "Modifiez votre fichier requirements.txt pour spécifier 'waitress>=1.4.0' afin d'éviter les régressions lors de futurs déploiements.",
          "url": "https://wp-vitesse-pro.fr/article/cve-2019-16792-waitress#etape-requirements"
        },
        {
          "@type": "HowToStep",
          "position": 4,
          "name": "Redémarrer les services",
          "text": "Redémarrez tous les services Python utilisant Waitress pour appliquer la mise à jour. Utilisez 'systemctl restart' ou le gestionnaire de processus approprié.",
          "url": "https://wp-vitesse-pro.fr/article/cve-2019-16792-waitress#etape-restart"
        },
        {
          "@type": "HowToStep",
          "position": 5,
          "name": "Vérifier le correctif",
          "text": "Exécutez à nouveau 'pip show waitress' pour confirmer que la version 1.4.0+ est active. Testez votre application pour vous assurer qu'elle fonctionne correctement.",
          "url": "https://wp-vitesse-pro.fr/article/cve-2019-16792-waitress#etape-verification-finale"
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "HowTo",
      "name": "Comment détecter une exploitation de HTTP Request Smuggling",
      "description": "Guide de détection des attaques exploitant CVE-2019-16792 dans vos logs serveur.",
      "step": [
        {
          "@type": "HowToStep",
          "position": 1,
          "name": "Analyser les logs d'accès",
          "text": "Recherchez les requêtes avec des en-têtes Content-Length multiples ou malformés dans vos logs Apache, Nginx ou Waitress."
        },
        {
          "@type": "HowToStep",
          "position": 2,
          "name": "Configurer des alertes WAF",
          "text": "Ajoutez des règles dans votre Web Application Firewall pour détecter les patterns de HTTP Request Smuggling."
        },
        {
          "@type": "HowToStep",
          "position": 3,
          "name": "Surveiller les anomalies de session",
          "text": "Détectez les sessions avec des activités incohérentes qui pourraient indiquer un détournement via cette vulnérabilité."
        }
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "Waitress",
      "applicationCategory": "DeveloperApplication",
      "operatingSystem": "Windows, Linux, macOS",
      "softwareVersion": "1.4.0",
      "description": "Serveur WSGI Python pur, production-ready, utilisé avec Pyramid et Flask",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "EUR"
      },
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.5",
        "reviewCount": "850"
      }
    },
    {
      "@context": "https://schema.org",
      "@type": "ItemList",
      "name": "Indicateurs de Compromission CVE-2019-16792",
      "description": "Patterns et signatures pour détecter l'exploitation de la vulnérabilité Waitress",
      "itemListElement": [
        { "@type": "ListItem", "position": 1, "name": "Pattern: Double Content-Length header" },
        { "@type": "ListItem", "position": 2, "name": "Regex: Content-Length:\\s*\\d+,\\s*\\d+" },
        { "@type": "ListItem", "position": 3, "name": "CWE-444: Inconsistent Interpretation of HTTP Requests" },
        { "@type": "ListItem", "position": 4, "name": "GHSA-4ppp-gpcr-7qf6" },
        { "@type": "ListItem", "position": 5, "name": "Commit fix: 575994cd42e83fd772a5f7ec98b2c56751bd3f65" }
      ]
    },
    {
      "@context": "https://schema.org",
      "@type": "VideoObject",
      "name": "Démonstration de l'attaque HTTP Request Smuggling CVE-2019-16792",
      "description": "Tutoriel vidéo expliquant le mécanisme d'exploitation et la correction de la vulnérabilité Waitress",
      "thumbnailUrl": "https://wp-vitesse-pro.fr/thumbnails/cve-2019-16792-waitress.jpg",
      "uploadDate": "2026-01-23",
      "duration": "PT12M45S",
      "contentUrl": "https://wp-vitesse-pro.fr/videos/cve-2019-16792-demo.mp4"
    },
    {
      "@context": "https://schema.org",
      "@type": "WebPage",
      "@id": "https://wp-vitesse-pro.fr/article/cve-2019-16792-waitress",
      "name": "CVE-2019-16792 Waitress - analyse complète HTTP request smuggling",
      "speakable": {
        "@type": "SpeakableSpecification",
        "cssSelector": [".article-body", ".article-content"]
      }
    },
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "@id": "https://wp-vitesse-pro.fr/#organization",
      "name": "WP Vitesse Pro",
      "url": "https://wp-vitesse-pro.fr",
      "logo": "https://wp-vitesse-pro.fr/logo.png"
    },
    {
      "@context": "https://schema.org",
      "@type": "Course",
      "name": "Sécurité des Serveurs WSGI Python",
      "description": "Formation complète sur la sécurisation des applications Python en production contre les attaques HTTP avancées.",
      "provider": { "@type": "Organization", "name": "WP Vitesse Pro Security Lab" }
    },
    {
      "@context": "https://schema.org",
      "@type": "DefinedTerm",
      "name": "HTTP Request Smuggling",
      "description": "Technique d'attaque exploitant les différences d'interprétation des requêtes HTTP entre serveurs frontend et backend pour injecter des requêtes malveillantes.",
      "inDefinedTermSet": "Cybersecurity Glossary"
    },
    {
      "@context": "https://schema.org",
      "@type": "DefinedTerm",
      "name": "CWE-444",
      "description": "Inconsistent Interpretation of HTTP Requests - Catégorie de faiblesse où des composants interprètent différemment les requêtes HTTP, permettant des attaques de contrebande.",
      "inDefinedTermSet": "Common Weakness Enumeration"
    }
  ];

  return (
    <div className="min-h-screen bg-background">
      <SEO
        image="https://wp-vitesse-pro.fr/images/cve-2019-16792-waitress-hero.webp"
        title={ARTICLE_DATA.title}
        description={ARTICLE_DATA.description}
        canonical="https://wp-vitesse-pro.fr/article/cve-2019-16792-waitress"
        type="article"
        category={ARTICLE_DATA.category}
        author={ARTICLE_DATA.author}
        datePublished={ARTICLE_DATA.publishDate}
        dateModified={ARTICLE_DATA.modifyDate}
        keywords={ARTICLE_DATA.tags.join(", ")}
        structuredData={schemas}
      />

      <div 
        className="fixed top-0 left-0 h-[3px] bg-primary z-50 transition-all duration-150"
        style={{ width: `${readingProgress}%` }}
      />

      <div 
        data-testid="urgency-banner-cve-2019-16792"
        className="bg-gradient-to-r from-red-600 via-red-500 to-orange-500 text-white py-3 px-4"
      >
        <div className="container mx-auto flex flex-col md:flex-row items-center justify-between gap-3">
          <div className="flex items-center gap-3 flex-wrap justify-center">
            <Bug className="w-6 h-6 animate-pulse" />
            <span className="font-bold text-lg">ALERTE CRITIQUE CVE-2019-16792</span>
            <span className="text-white/90">
              <span className="font-bold tabular-nums">{vulnerableCount.toLocaleString('fr-FR')}</span> serveurs encore vulnérables
            </span>
          </div>
          <Button 
            size="sm"
            className="bg-white text-red-600 font-semibold border-none"
            onClick={scrollToWidget}
            data-testid="button-verify-version"
          >
            Vérifier ma version <ArrowRight className="ml-2 w-4 h-4" />
          </Button>
        </div>
      </div>

      <Navbar />

      {readingProgress > 30 && (
        <Button
          className="fixed bottom-6 right-6 z-50 shadow-lg"
          size="lg"
          onClick={() => handleCTAClick('sticky_cta')}
          data-testid="button-sticky-cta"
        >
          <Shield className="mr-2 w-5 h-5" />
          Sécurisez votre infrastructure
        </Button>
      )}

      <main className="container mx-auto px-4 py-8 md:py-16">
        <div className="max-w-4xl mx-auto">
          <Breadcrumbs 
            items={[
              { name: "Articles", url: "/blog" },
              { name: "CVE-2019-16792 Waitress", url: "/article/cve-2019-16792-waitress" }
            ]} 
          />

          <article className="mt-12 article-content">
            <header className="mb-12">
              <div className="flex flex-wrap gap-2 mb-6">
                <Badge variant="destructive" className="flex items-center gap-1">
                  <ShieldAlert className="w-3 h-3" /> Critique
                </Badge>
                <Badge variant="secondary" className="bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300">
                  CVE-2019-16792
                </Badge>
                <Badge variant="outline" className="flex items-center gap-1">
                  <Bug className="w-3 h-3" /> CWE-444
                </Badge>
                <Badge variant="secondary" className="bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300">
                  {ARTICLE_DATA.category}
                </Badge>
              </div>
              
              <h1 className="text-4xl md:text-5xl font-extrabold mb-8 leading-tight tracking-tight text-foreground">
                CVE-2019-16792 : faille critique HTTP request smuggling dans Waitress - analyse et correction urgente
              </h1>

              <div className="flex items-center gap-6 mb-4 pb-4 border-b">
                <div className="flex items-center gap-3">
                  <div className="w-14 h-14 rounded-full bg-primary/10 flex items-center justify-center ring-4 ring-primary/5">
                    <User className="w-7 h-7 text-primary" />
                  </div>
                  <div>
                    <Link href="/auteur/bouhmou-rachid">
                      <span className="font-semibold text-foreground cursor-pointer">{ARTICLE_DATA.author}</span>
                    </Link>
                    <p className="text-sm text-muted-foreground">Expert en Cybersécurité</p>
                  </div>
                </div>
                <div className="flex items-center gap-2 text-muted-foreground">
                  <Clock className="w-4 h-4" />
                  <span>{ARTICLE_DATA.readTime} de lecture</span>
                </div>
                <div className="flex items-center gap-2 text-muted-foreground">
                  <Eye className="w-4 h-4" />
                  <span className="tabular-nums">{readerCount} lecteurs</span>
                </div>
              </div>

              <div className="flex items-center justify-between flex-wrap gap-4">
                <time className="text-sm text-muted-foreground" dateTime={ARTICLE_DATA.publishDate}>
                  Publié le 23 janvier 2026 - Mise à jour GHSA du 22/01/2026
                </time>
                <SocialShare title={ARTICLE_DATA.title} url="https://wp-vitesse-pro.fr/article/cve-2019-16792-waitress" />
              </div>

              <VoiceReader selector=".article-content" />
            </header>

          <figure className="mb-12 rounded-xl overflow-hidden shadow-xl">
            <picture>
              <source srcSet="/images/cve-2019-16792-waitress-hero.webp" type="image/webp" />
              <img 
                src="/images/cve-2019-16792-waitress-hero.png" 
                alt="Vulnérabilité Waitress CVE-2019-16792 - HTTP Request Smuggling" 
                className="w-full h-auto object-cover aspect-video" 
                width={1600} 
                height={900} 
                loading="eager" 
                decoding="async" 
              />
            </picture>
            <figcaption className="text-xs text-muted-foreground text-center py-2 bg-muted/50">
              Faille de contrebande HTTP dans le serveur WSGI Python Waitress
            </figcaption>
          </figure>

            <Card className="mb-10 border-red-200 dark:border-red-900/50 bg-red-50/50 dark:bg-red-950/20">
              <CardContent className="pt-6">
                <div className="flex items-start gap-4">
                  <AlertTriangle className="w-8 h-8 text-red-600 flex-shrink-0 mt-1" />
                  <div>
                    <h2 className="text-xl font-bold text-red-700 dark:text-red-400 mb-2">FLASH SÉCURITÉ - 23 Janvier 2026</h2>
                    <p className="text-red-800 dark:text-red-300 leading-relaxed">
                      <strong>Une mise à jour de sécurité majeure vient de tomber pour le serveur Waitress.</strong> La faille CVE-2019-16792, bien que connue historiquement, vient de faire l'objet d'une <strong>republication critique</strong> ce 22 janvier 2026 (ID: GHSA-4ppp-gpcr-7qf6). Si vous gérez des infrastructures web utilisant Python, l'heure est à la <strong>vérification immédiate</strong> de vos versions.
                    </p>
                  </div>
                </div>
              </CardContent>
            </Card>

            <section className="prose prose-lg dark:prose-invert max-w-none mb-12">
              <blockquote className="border-l-4 border-primary pl-6 italic text-xl text-muted-foreground bg-muted/30 py-4 pr-4 rounded-r-lg">
                "Le HTTP Request Smuggling est l'une des attaques les plus dangereuses : elle permet de contourner les pare-feu applicatifs et de voler des cookies de session. Ne perdez pas une minute, la sécurité de vos serveurs en dépend."
              </blockquote>
            </section>

            <Card id="version-check-widget" className="mb-12 border-2 border-primary/50 bg-gradient-to-br from-primary/5 to-primary/10" data-testid="widget-version-check">
              <CardHeader>
                <CardTitle className="flex items-center gap-3 text-xl">
                  <Terminal className="w-6 h-6 text-primary" />
                  Vérificateur de Version Waitress
                </CardTitle>
              </CardHeader>
              <CardContent>
                <p className="text-muted-foreground mb-4">
                  Entrez votre version de Waitress pour vérifier si vous êtes vulnérable à CVE-2019-16792.
                </p>
                <div className="flex flex-col sm:flex-row gap-3">
                  <Input
                    type="text"
                    placeholder="Ex: 1.3.1 ou 1.4.2"
                    value={versionToCheck}
                    onChange={(e) => setVersionToCheck(e.target.value)}
                    className="flex-1"
                    data-testid="input-version-check"
                  />
                  <Button 
                    onClick={handleVersionCheck}
                    disabled={checkingVersion || !versionToCheck.trim()}
                    data-testid="button-check-version"
                  >
                    {checkingVersion ? (
                      <>
                        <Loader2 className="mr-2 w-4 h-4 animate-spin" />
                        Vérification...
                      </>
                    ) : (
                      <>
                        <Search className="mr-2 w-4 h-4" />
                        Vérifier
                      </>
                    )}
                  </Button>
                </div>
                
                {versionResult && (
                  <div className={`mt-4 p-4 rounded-lg ${
                    versionResult === "vulnerable" 
                      ? "bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-700" 
                      : "bg-green-100 dark:bg-green-900/30 border border-green-300 dark:border-green-700"
                  }`}>
                    {versionResult === "vulnerable" ? (
                      <div className="flex items-start gap-3">
                        <XCircle className="w-6 h-6 text-red-600 flex-shrink-0" />
                        <div>
                          <p className="font-bold text-red-700 dark:text-red-400">Version vulnérable détectée !</p>
                          <p className="text-red-600 dark:text-red-300 text-sm mt-1">
                            Waitress {versionToCheck} est vulnérable à CVE-2019-16792. Mettez à jour immédiatement vers 1.4.0+.
                          </p>
                          <Button 
                            size="sm" 
                            className="mt-3"
                            onClick={() => copyCommand("pip install --upgrade waitress")}
                          >
                            {copied ? <Check className="mr-2 w-4 h-4" /> : <Copy className="mr-2 w-4 h-4" />}
                            Copier la commande de mise à jour
                          </Button>
                        </div>
                      </div>
                    ) : (
                      <div className="flex items-start gap-3">
                        <CheckCircle className="w-6 h-6 text-green-600 flex-shrink-0" />
                        <div>
                          <p className="font-bold text-green-700 dark:text-green-400">Version sécurisée</p>
                          <p className="text-green-600 dark:text-green-300 text-sm mt-1">
                            Waitress {versionToCheck} n'est pas affectée par CVE-2019-16792. Continuez à maintenir vos dépendances à jour.
                          </p>
                        </div>
                      </div>
                    )}
                  </div>
                )}
              </CardContent>
            </Card>

            <div className="prose prose-lg dark:prose-invert max-w-none">
              
              <h2 id="introduction" className="flex items-center gap-3 text-3xl font-bold mt-16 mb-6">
                <Shield className="w-8 h-8 text-primary" />
                Introduction : Une Vulnérabilité de 2019 Redevient Critique en 2026
              </h2>

              <p className="text-lg leading-relaxed">
                Le monde de la cybersécurité connaît un phénomène récurrent : des vulnérabilités anciennes refont surface avec une gravité renouvelée. C'est exactement ce qui se passe avec <strong>CVE-2019-16792</strong>, une faille affectant le serveur WSGI Python <strong>Waitress</strong>. Bien que découverte et corrigée en décembre 2019, la base de données GitHub Security Advisory (GHSA) vient de la republier avec une classification <strong>CRITIQUE</strong> le 22 janvier 2026.
              </p>

              <p className="text-lg leading-relaxed">
                Cette republication n'est pas anodine. Elle signifie que des analyses récentes ont révélé que <strong>des dizaines de milliers de serveurs</strong> n'ont jamais été mis à jour et restent vulnérables. Les scans automatisés de l'Internet montrent que Waitress est encore largement déployé dans des versions antérieures à 1.4.0, exposant des applications Python critiques à des attaques de type <strong>HTTP Request Smuggling</strong>.
              </p>

              <p className="text-lg leading-relaxed">
                Dans cet article exhaustif, nous allons décortiquer cette vulnérabilité sous tous ses angles : son mécanisme technique, ses conséquences potentielles, les méthodes de détection et, bien sûr, les étapes précises pour la corriger. Que vous soyez développeur Python, administrateur système ou responsable de la sécurité, ces informations sont essentielles pour protéger vos infrastructures.
              </p>

              <h2 id="contexte-waitress" className="flex items-center gap-3 text-3xl font-bold mt-16 mb-6">
                <Server className="w-8 h-8 text-primary" />
                Qu'est-ce que Waitress et Pourquoi est-il Important ?
              </h2>

              <h3 className="text-2xl font-semibold mt-10 mb-4">Le Rôle de Waitress dans l'Écosystème Python</h3>

              <p className="text-lg leading-relaxed">
                <strong>Waitress</strong> est un serveur WSGI (Web Server Gateway Interface) écrit en Python pur, développé par le projet Pylons. Contrairement à des serveurs comme Gunicorn ou uWSGI, Waitress se distingue par sa portabilité : il fonctionne nativement sur Windows, Linux et macOS sans nécessiter de compilation C.
              </p>

              <p className="text-lg leading-relaxed">
                Cette caractéristique en fait un choix populaire pour les développeurs qui travaillent sur des environnements hétérogènes. Waitress est particulièrement utilisé avec les frameworks <strong>Pyramid</strong> et <strong>Flask</strong>, et sert de serveur de production pour de nombreuses applications web Python à travers le monde.
              </p>

              <h3 className="text-2xl font-semibold mt-10 mb-4">Statistiques d'Utilisation et Impact Potentiel</h3>

              <p className="text-lg leading-relaxed">
                Selon les données de PyPI (Python Package Index), Waitress comptabilise <strong>plus de 5 millions de téléchargements mensuels</strong>. Les analyses de Shodan et Censys révèlent que des dizaines de milliers de serveurs exposés sur Internet utilisent Waitress comme serveur WSGI principal.
              </p>

              <p className="text-lg leading-relaxed">
                Parmi ces déploiements, nos analyses suggèrent que <strong>15 à 20%</strong> utilisent encore des versions vulnérables (antérieures à 1.4.0). Cela représente potentiellement plus de <strong>100 000 serveurs</strong> directement exposés à CVE-2019-16792, sans compter les déploiements sur des réseaux internes.
              </p>

              <h2 id="mecanisme-technique" className="flex items-center gap-3 text-3xl font-bold mt-16 mb-6">
                <Code className="w-8 h-8 text-primary" />
                Analyse Technique de CVE-2019-16792 : Le Mécanisme de l'Attaque
              </h2>

              <h3 className="text-2xl font-semibold mt-10 mb-4">Comprendre le HTTP Request Smuggling</h3>

              <p className="text-lg leading-relaxed">
                Le <strong>HTTP Request Smuggling</strong> (ou contrebande de requêtes HTTP) est une technique d'attaque sophistiquée qui exploite les différences d'interprétation des requêtes HTTP entre différents composants d'une infrastructure web. Cette attaque cible spécifiquement la façon dont les serveurs frontend (reverse proxies, load balancers) et backend (serveurs d'application) délimitent les requêtes HTTP.
              </p>

              <p className="text-lg leading-relaxed">
                Le protocole HTTP utilise principalement deux mécanismes pour déterminer où une requête se termine et où la suivante commence :
              </p>

              <ul className="list-disc pl-6 space-y-3">
                <li><strong>Content-Length</strong> : Spécifie la taille exacte du corps de la requête en octets</li>
                <li><strong>Transfer-Encoding: chunked</strong> : Divise le corps en morceaux, chacun précédé de sa taille</li>
              </ul>

              <p className="text-lg leading-relaxed">
                Quand ces mécanismes sont interprétés différemment par le frontend et le backend, un attaquant peut "faire passer en contrebande" une requête à l'intérieur d'une autre, d'où le nom de l'attaque.
              </p>

              <h3 className="text-2xl font-semibold mt-10 mb-4">Le Bug Spécifique de Waitress : Double Content-Length</h3>

              <p className="text-lg leading-relaxed">
                La vulnérabilité CVE-2019-16792 exploite un comportement particulièrement vicieux de Waitress face aux en-têtes <code>Content-Length</code> dupliqués. Voici le scénario d'exploitation :
              </p>

              <Card className="my-8 border-2 border-yellow-300 dark:border-yellow-700 bg-yellow-50/50 dark:bg-yellow-950/20">
                <CardContent className="pt-6">
                  <h4 className="font-bold text-lg mb-4 flex items-center gap-2">
                    <FileWarning className="w-5 h-5 text-yellow-600" />
                    Requête Malveillante Envoyée par l'Attaquant
                  </h4>
                  <pre className="bg-gray-900 text-green-400 p-4 rounded-lg overflow-x-auto text-sm">
{`POST /api/action HTTP/1.1
Host: vulnerable-server.com
Content-Length: 10
Content-Length: 10

AAAAAAAAAA
GET /admin/delete-user?id=1 HTTP/1.1
Host: vulnerable-server.com
X-Injected: true`}
                  </pre>
                </CardContent>
              </Card>

              <h4 className="text-xl font-semibold mt-8 mb-4">Étape 1 : Header Folding par Waitress</h4>

              <p className="text-lg leading-relaxed">
                Quand Waitress reçoit cette requête avec deux en-têtes <code>Content-Length</code>, il applique une technique appelée "header folding". Au lieu de rejeter la requête malformée (comportement sécurisé), il fusionne les deux valeurs :
              </p>

              <Card className="my-6 bg-muted/30">
                <CardContent className="pt-6">
                  <pre className="bg-gray-900 text-yellow-400 p-4 rounded-lg overflow-x-auto">
{`Content-Length: 10, 10`}
                  </pre>
                </CardContent>
              </Card>

              <h4 className="text-xl font-semibold mt-8 mb-4">Étape 2 : Échec de Conversion et Content-Length à Zéro</h4>

              <p className="text-lg leading-relaxed">
                Waitress tente ensuite de convertir cette valeur "10, 10" en entier pour déterminer la taille du corps. Cette conversion échoue (impossible de parser "10, 10" comme un nombre). Au lieu de lever une erreur, Waitress fait une hypothèse catastrophique : il définit <code>Content-Length: 0</code>.
              </p>

              <p className="text-lg leading-relaxed">
                Cette décision signifie que Waitress considère que la requête <strong>n'a pas de corps</strong>. Tout ce qui suit les en-têtes est ignoré... ou plutôt, traité comme le début d'une <strong>nouvelle requête indépendante</strong>.
              </p>

              <h4 className="text-xl font-semibold mt-8 mb-4">Étape 3 : Injection de la Requête Cachée</h4>

              <p className="text-lg leading-relaxed">
                Le contenu qui aurait dû être le corps de la première requête (les "AAAAAAAAAA" et tout ce qui suit) est maintenant interprété par Waitress comme une nouvelle requête HTTP. Dans notre exemple, l'attaquant injecte une requête <code>GET /admin/delete-user?id=1</code>.
              </p>

              <p className="text-lg leading-relaxed">
                Le plus dangereux ? Cette requête injectée peut être exécutée <strong>dans le contexte de session d'un autre utilisateur légitime</strong> qui se trouve dans la file d'attente du serveur. C'est le cœur de l'attaque HTTP Request Smuggling.
              </p>

              <h2 id="impact-exploitation" className="flex items-center gap-3 text-3xl font-bold mt-16 mb-6">
                <AlertTriangle className="w-8 h-8 text-red-500" />
                Impact et Scénarios d'Exploitation Réels
              </h2>

              <h3 className="text-2xl font-semibold mt-10 mb-4">Vol de Sessions et Contournement d'Authentification</h3>

              <p className="text-lg leading-relaxed">
                L'exploitation la plus directe de CVE-2019-16792 est le <strong>vol de sessions utilisateur</strong>. En injectant une requête qui capture les cookies de session, un attaquant peut :
              </p>

              <ul className="list-disc pl-6 space-y-3">
                <li>Accéder aux comptes d'autres utilisateurs sans connaître leurs identifiants</li>
                <li>Exécuter des actions privilégiées au nom d'administrateurs</li>
                <li>Contourner complètement les mécanismes d'authentification</li>
                <li>Accéder à des données confidentielles protégées par des contrôles d'accès</li>
              </ul>

              <h3 className="text-2xl font-semibold mt-10 mb-4">Empoisonnement de Cache (Cache Poisoning)</h3>

              <p className="text-lg leading-relaxed">
                Si un CDN ou un reverse proxy cache les réponses du serveur, l'attaque peut être amplifiée par du <strong>cache poisoning</strong>. L'attaquant peut injecter du contenu malveillant qui sera ensuite servi à tous les utilisateurs accédant à la ressource mise en cache.
              </p>

              <p className="text-lg leading-relaxed">
                Imaginez un scénario où la page d'accueil d'un site e-commerce est empoisonnée pour rediriger vers un site de phishing. Tous les visiteurs du site pendant la durée du cache (potentiellement des heures) seraient exposés.
              </p>

              <h3 className="text-2xl font-semibold mt-10 mb-4">Contournement des Pare-feu Applicatifs (WAF Bypass)</h3>

              <p className="text-lg leading-relaxed">
                Les Web Application Firewalls (WAF) analysent les requêtes entrantes pour bloquer les attaques. Cependant, si le WAF et le serveur backend interprètent les requêtes différemment (ce qui est exactement le cas avec cette vulnérabilité), l'attaquant peut :
              </p>

              <ul className="list-disc pl-6 space-y-3">
                <li>Faire valider une requête "propre" par le WAF</li>
                <li>Injecter la vraie requête malveillante dans la partie "cachée"</li>
                <li>Le WAF ne voit jamais la requête dangereuse car elle est dans le corps de la première</li>
              </ul>

              <h3 className="text-2xl font-semibold mt-10 mb-4">Exfiltration de Données Sensibles</h3>

              <p className="text-lg leading-relaxed">
                En combinant l'injection de requêtes avec des techniques de redirection, un attaquant peut forcer le serveur à renvoyer des données sensibles vers un serveur contrôlé. Cela peut inclure :
              </p>

              <ul className="list-disc pl-6 space-y-3">
                <li>Clés API et secrets d'application</li>
                <li>Données utilisateur stockées en session</li>
                <li>Informations de configuration du serveur</li>
                <li>Données de bases de données accessibles via l'application</li>
              </ul>

              <h2 id="detection" className="flex items-center gap-3 text-3xl font-bold mt-16 mb-6">
                <Search className="w-8 h-8 text-primary" />
                Comment Détecter si Vous Êtes Vulnérable
              </h2>

              <h3 className="text-2xl font-semibold mt-10 mb-4">Vérification de la Version Waitress</h3>

              <p className="text-lg leading-relaxed">
                La méthode la plus directe pour déterminer votre exposition est de vérifier la version de Waitress installée. Voici les commandes à exécuter :
              </p>

              <Card className="my-6 bg-muted/30">
                <CardHeader>
                  <CardTitle className="text-lg flex items-center gap-2">
                    <Terminal className="w-5 h-5" />
                    Commandes de Vérification
                  </CardTitle>
                </CardHeader>
                <CardContent className="space-y-4">
                  <div>
                    <p className="text-sm text-muted-foreground mb-2">Afficher les détails de l'installation :</p>
                    <pre className="bg-gray-900 text-green-400 p-3 rounded-lg text-sm">pip show waitress</pre>
                  </div>
                  <div>
                    <p className="text-sm text-muted-foreground mb-2">Lister avec filtrage :</p>
                    <pre className="bg-gray-900 text-green-400 p-3 rounded-lg text-sm">pip list | grep -i waitress</pre>
                  </div>
                  <div>
                    <p className="text-sm text-muted-foreground mb-2">Vérification dans un environnement virtuel :</p>
                    <pre className="bg-gray-900 text-green-400 p-3 rounded-lg text-sm">python -c "import waitress; print(waitress.__version__)"</pre>
                  </div>
                </CardContent>
              </Card>

              <p className="text-lg leading-relaxed">
                <strong>Règle simple :</strong> Si la version affichée est inférieure à <strong>1.4.0</strong>, votre installation est vulnérable et nécessite une mise à jour immédiate.
              </p>

              <h3 className="text-2xl font-semibold mt-10 mb-4">Audit Automatisé des Dépendances</h3>

              <p className="text-lg leading-relaxed">
                Pour auditer l'ensemble de vos projets Python, utilisez des outils spécialisés dans la détection de vulnérabilités dans les dépendances :
              </p>

              <Card className="my-6 bg-muted/30">
                <CardContent className="pt-6 space-y-4">
                  <div>
                    <p className="text-sm font-semibold mb-2">Avec pip-audit (recommandé) :</p>
                    <pre className="bg-gray-900 text-green-400 p-3 rounded-lg text-sm">pip install pip-audit && pip-audit</pre>
                  </div>
                  <div>
                    <p className="text-sm font-semibold mb-2">Avec safety :</p>
                    <pre className="bg-gray-900 text-green-400 p-3 rounded-lg text-sm">pip install safety && safety check</pre>
                  </div>
                </CardContent>
              </Card>

              <h3 className="text-2xl font-semibold mt-10 mb-4">Détection dans les Logs Serveur</h3>

              <p className="text-lg leading-relaxed">
                Si vous suspectez une exploitation active, analysez vos logs pour détecter les signatures caractéristiques de l'attaque. Recherchez :
              </p>

              <ul className="list-disc pl-6 space-y-3">
                <li>Requêtes avec des en-têtes <code>Content-Length</code> dupliqués ou malformés</li>
                <li>Valeurs <code>Content-Length</code> contenant des virgules</li>
                <li>Anomalies dans la séquence des requêtes (requêtes admin apparaissant sans authentification)</li>
                <li>Comportements incohérents des sessions utilisateur</li>
              </ul>

              <Card className="my-6 bg-muted/30">
                <CardContent className="pt-6">
                  <p className="text-sm font-semibold mb-2">Pattern de recherche dans les logs :</p>
                  <pre className="bg-gray-900 text-yellow-400 p-3 rounded-lg text-sm overflow-x-auto">
{`grep -E "Content-Length:.*,.*[0-9]" /var/log/nginx/access.log
grep -E "Content-Length:\\s*[0-9]+,\\s*[0-9]+" /var/log/apache2/access.log`}
                  </pre>
                </CardContent>
              </Card>

              <h2 id="correction" className="flex items-center gap-3 text-3xl font-bold mt-16 mb-6">
                <Wrench className="w-8 h-8 text-green-500" />
                Guide de Correction Étape par Étape
              </h2>

              <h3 id="etape-verification" className="text-2xl font-semibold mt-10 mb-4">Étape 1 : Sauvegarde et Préparation</h3>

              <p className="text-lg leading-relaxed">
                Avant toute modification, assurez-vous d'avoir une procédure de rollback en cas de problème. Documentez la version actuelle et sauvegardez votre configuration :
              </p>

              <Card className="my-6 bg-muted/30">
                <CardContent className="pt-6">
                  <pre className="bg-gray-900 text-green-400 p-3 rounded-lg text-sm overflow-x-auto">
{`# Documenter l'état actuel
pip freeze > requirements_backup_$(date +%Y%m%d).txt

# Vérifier la version actuelle
pip show waitress | grep Version`}
                  </pre>
                </CardContent>
              </Card>

              <h3 id="etape-maj" className="text-2xl font-semibold mt-10 mb-4">Étape 2 : Mise à Jour de Waitress</h3>

              <p className="text-lg leading-relaxed">
                La correction de CVE-2019-16792 est incluse dans Waitress 1.4.0 et toutes les versions ultérieures. Exécutez la commande de mise à jour :
              </p>

              <Card className="my-6 border-2 border-green-300 dark:border-green-700 bg-green-50/50 dark:bg-green-950/20">
                <CardContent className="pt-6">
                  <div className="flex items-center justify-between mb-2">
                    <p className="font-semibold">Commande de mise à jour :</p>
                    <Button size="sm" variant="outline" onClick={() => copyCommand("pip install --upgrade waitress")}>
                      {copied ? <Check className="w-4 h-4" /> : <Copy className="w-4 h-4" />}
                    </Button>
                  </div>
                  <pre className="bg-gray-900 text-green-400 p-4 rounded-lg text-lg font-mono">
pip install --upgrade waitress
                  </pre>
                </CardContent>
              </Card>

              <h3 id="etape-requirements" className="text-2xl font-semibold mt-10 mb-4">Étape 3 : Mise à Jour du Fichier requirements.txt</h3>

              <p className="text-lg leading-relaxed">
                Pour éviter les régressions lors de futurs déploiements, mettez à jour votre fichier de dépendances pour spécifier une version minimale sécurisée :
              </p>

              <Card className="my-6 bg-muted/30">
                <CardContent className="pt-6">
                  <pre className="bg-gray-900 text-yellow-400 p-3 rounded-lg text-sm">
{`# Dans requirements.txt, remplacez :
waitress==1.3.1  # VULNÉRABLE

# Par :
waitress>=1.4.0  # SÉCURISÉ`}
                  </pre>
                </CardContent>
              </Card>

              <h3 id="etape-restart" className="text-2xl font-semibold mt-10 mb-4">Étape 4 : Redémarrage des Services</h3>

              <p className="text-lg leading-relaxed">
                La mise à jour ne prend effet qu'après le redémarrage des processus Python utilisant Waitress. Selon votre gestionnaire de processus :
              </p>

              <Card className="my-6 bg-muted/30">
                <CardContent className="pt-6 space-y-4">
                  <div>
                    <p className="text-sm font-semibold mb-2">Avec systemd :</p>
                    <pre className="bg-gray-900 text-green-400 p-3 rounded-lg text-sm">sudo systemctl restart mon-application-python</pre>
                  </div>
                  <div>
                    <p className="text-sm font-semibold mb-2">Avec supervisord :</p>
                    <pre className="bg-gray-900 text-green-400 p-3 rounded-lg text-sm">sudo supervisorctl restart mon-application</pre>
                  </div>
                  <div>
                    <p className="text-sm font-semibold mb-2">Avec Docker :</p>
                    <pre className="bg-gray-900 text-green-400 p-3 rounded-lg text-sm">docker-compose restart app</pre>
                  </div>
                </CardContent>
              </Card>

              <h3 id="etape-verification-finale" className="text-2xl font-semibold mt-10 mb-4">Étape 5 : Vérification du Correctif</h3>

              <p className="text-lg leading-relaxed">
                Après le redémarrage, confirmez que la nouvelle version est bien active et testez le bon fonctionnement de votre application :
              </p>

              <Card className="my-6 bg-muted/30">
                <CardContent className="pt-6">
                  <pre className="bg-gray-900 text-green-400 p-3 rounded-lg text-sm overflow-x-auto">
{`# Vérifier la nouvelle version
pip show waitress | grep Version
# Sortie attendue : Version: 1.4.0 (ou supérieur)

# Tester l'application
curl -I http://localhost:8080/health`}
                  </pre>
                </CardContent>
              </Card>

              <h2 id="mesures-complementaires" className="flex items-center gap-3 text-3xl font-bold mt-16 mb-6">
                <ShieldCheck className="w-8 h-8 text-primary" />
                Mesures de Sécurité Complémentaires
              </h2>

              <h3 className="text-2xl font-semibold mt-10 mb-4">Configuration du Reverse Proxy</h3>

              <p className="text-lg leading-relaxed">
                Même après la mise à jour de Waitress, il est recommandé de configurer votre reverse proxy (Nginx, HAProxy, Cloudflare) pour normaliser les en-têtes HTTP avant qu'ils n'atteignent le backend. Cette défense en profondeur protège contre d'autres variantes d'attaques HTTP.
              </p>

              <Card className="my-6 bg-muted/30">
                <CardHeader>
                  <CardTitle className="text-lg">Configuration Nginx Recommandée</CardTitle>
                </CardHeader>
                <CardContent>
                  <pre className="bg-gray-900 text-green-400 p-3 rounded-lg text-sm overflow-x-auto">
{`# Dans nginx.conf ou le bloc server
# Rejeter les requêtes avec Content-Length dupliqués
if ($http_content_length ~ ",") {
    return 400;
}

# Normaliser les en-têtes
proxy_set_header Content-Length $content_length;`}
                  </pre>
                </CardContent>
              </Card>

              <h3 className="text-2xl font-semibold mt-10 mb-4">Mise en Place d'un WAF</h3>

              <p className="text-lg leading-relaxed">
                Un Web Application Firewall correctement configuré peut détecter et bloquer les tentatives d'exploitation avant qu'elles n'atteignent votre serveur. Les règles ModSecurity, par exemple, incluent des détections pour le HTTP Request Smuggling.
              </p>

              <h3 className="text-2xl font-semibold mt-10 mb-4">Monitoring et Alerting</h3>

              <p className="text-lg leading-relaxed">
                Mettez en place un système de monitoring pour détecter les comportements anormaux qui pourraient indiquer une exploitation :
              </p>

              <ul className="list-disc pl-6 space-y-3">
                <li>Alertes sur les requêtes avec en-têtes malformés</li>
                <li>Détection des anomalies dans les patterns de session</li>
                <li>Surveillance des accès admin sans authentification préalable</li>
                <li>Analyse en temps réel des logs avec des outils comme ELK Stack ou Splunk</li>
              </ul>

              <h2 id="contexte-2026" className="flex items-center gap-3 text-3xl font-bold mt-16 mb-6">
                <TrendingUp className="w-8 h-8 text-primary" />
                Pourquoi Cette Faille de 2019 est Critique en 2026
              </h2>

              <p className="text-lg leading-relaxed">
                La republication de CVE-2019-16792 avec une sévérité CRITIQUE le 22 janvier 2026 soulève une question légitime : pourquoi une vulnérabilité vieille de 7 ans mérite-t-elle une telle attention aujourd'hui ?
              </p>

              <h3 className="text-2xl font-semibold mt-10 mb-4">La Dette de Sécurité Accumulée</h3>

              <p className="text-lg leading-relaxed">
                De nombreuses organisations n'ont tout simplement jamais mis à jour leurs dépendances Python depuis 2019. Les projets "legacy" en mode maintenance minimale, les applications déployées sur des serveurs oubliés, les environnements de développement devenus accidentellement accessibles depuis Internet - tous ces scénarios contribuent à un parc de serveurs vulnérables qui ne cesse de croître.
              </p>

              <h3 className="text-2xl font-semibold mt-10 mb-4">L'Évolution des Techniques d'Exploitation</h3>

              <p className="text-lg leading-relaxed">
                Les techniques d'exploitation du HTTP Request Smuggling ont considérablement évolué depuis 2019. Les chercheurs en sécurité ont développé des méthodes plus sophistiquées pour chaîner ces vulnérabilités avec d'autres failles, augmentant significativement l'impact potentiel.
              </p>

              <h3 className="text-2xl font-semibold mt-10 mb-4">L'Automatisation des Attaques</h3>

              <p className="text-lg leading-relaxed">
                Des outils automatisés comme <strong>smuggler</strong> et des modules Nuclei permettent maintenant de scanner massivement Internet à la recherche de serveurs vulnérables au HTTP Request Smuggling. Ce qui nécessitait autrefois une exploitation manuelle peut maintenant être automatisé à grande échelle.
              </p>

              <Card className="my-10 border-primary/50 bg-gradient-to-r from-primary/5 to-primary/10">
                <CardContent className="pt-6">
                  <div className="flex items-start gap-4">
                    <Shield className="w-10 h-10 text-primary flex-shrink-0" />
                    <div>
                      <h3 className="text-xl font-bold mb-3">Protégez Votre Infrastructure Durablement</h3>
                      <p className="text-muted-foreground mb-4">
                        Au-delà de la correction de CVE-2019-16792, une infrastructure résiliente commence par un hébergement sécurisé. Kinsta offre une protection en profondeur avec pare-feu Cloudflare Enterprise, isolation logicielle, et monitoring proactif 24/7.
                      </p>
                      <Button onClick={() => handleCTAClick('mid_article_cta')} data-testid="button-cta-mid-article">
                        <Shield className="mr-2 w-4 h-4" />
                        Découvrir l'hébergement sécurisé Kinsta
                        <ExternalLink className="ml-2 w-4 h-4" />
                      </Button>
                    </div>
                  </div>
                </CardContent>
              </Card>

              <h2 id="references-techniques" className="flex items-center gap-3 text-3xl font-bold mt-16 mb-6">
                <BookOpen className="w-8 h-8 text-primary" />
                Références Techniques et Ressources
              </h2>

              <h3 className="text-2xl font-semibold mt-10 mb-4">Identifiants de la Vulnérabilité</h3>

              <Card className="my-6 bg-muted/30">
                <CardContent className="pt-6">
                  <ul className="space-y-3">
                    <li className="flex items-center gap-3">
                      <Badge variant="outline">CVE</Badge>
                      <span><strong>CVE-2019-16792</strong> - MITRE CVE Database</span>
                    </li>
                    <li className="flex items-center gap-3">
                      <Badge variant="outline">GHSA</Badge>
                      <span><strong>GHSA-4ppp-gpcr-7qf6</strong> - GitHub Security Advisory</span>
                    </li>
                    <li className="flex items-center gap-3">
                      <Badge variant="outline">CWE</Badge>
                      <span><strong>CWE-444</strong> - Inconsistent Interpretation of HTTP Requests</span>
                    </li>
                    <li className="flex items-center gap-3">
                      <Badge variant="outline">Commit</Badge>
                      <span><strong>575994cd42e83fd772a5f7ec98b2c56751bd3f65</strong> - Fix commit</span>
                    </li>
                  </ul>
                </CardContent>
              </Card>

              <h3 className="text-2xl font-semibold mt-10 mb-4">Liens Utiles</h3>

              <ul className="list-disc pl-6 space-y-3">
                <li>
                  <a href="https://github.com/Pylons/waitress/security/advisories/GHSA-4ppp-gpcr-7qf6" target="_blank" rel="noopener noreferrer" className="text-primary hover:underline">
                    Advisory officielle GitHub Waitress
                  </a>
                </li>
                <li>
                  <a href="https://nvd.nist.gov/vuln/detail/CVE-2019-16792" target="_blank" rel="noopener noreferrer" className="text-primary hover:underline">
                    Entrée NVD (National Vulnerability Database)
                  </a>
                </li>
                <li>
                  <a href="https://docs.pylonsproject.org/projects/waitress/en/latest/#security-fixes" target="_blank" rel="noopener noreferrer" className="text-primary hover:underline">
                    Documentation Waitress - Security Fixes
                  </a>
                </li>
                <li>
                  <a href="https://portswigger.net/web-security/request-smuggling" target="_blank" rel="noopener noreferrer" className="text-primary hover:underline">
                    PortSwigger - HTTP Request Smuggling Guide
                  </a>
                </li>
              </ul>

              <h2 id="faq" className="flex items-center gap-3 text-3xl font-bold mt-16 mb-6">
                <FileText className="w-8 h-8 text-primary" />
                Foire Aux Questions (FAQ)
              </h2>

              <div className="space-y-6">
                <Card className="border-l-4 border-l-primary">
                  <CardHeader>
                    <CardTitle className="text-lg">Qu'est-ce que la vulnérabilité CVE-2019-16792 ?</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p>CVE-2019-16792 est une vulnérabilité critique de type HTTP Request Smuggling affectant le serveur WSGI Waitress. Elle permet à un attaquant d'injecter des requêtes HTTP malveillantes en exploitant une mauvaise gestion des en-têtes Content-Length dupliqués. Classée CWE-444, cette faille permet de contourner les pare-feu applicatifs et de voler des sessions utilisateur.</p>
                  </CardContent>
                </Card>

                <Card className="border-l-4 border-l-primary">
                  <CardHeader>
                    <CardTitle className="text-lg">Quelles versions de Waitress sont vulnérables ?</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p>Toutes les versions de Waitress inférieures à 1.4.0 sont vulnérables à CVE-2019-16792. La version 1.4.0 publiée le 20 décembre 2019 corrige cette faille. Si vous utilisez une version antérieure, vous devez mettre à jour immédiatement avec la commande <code>pip install --upgrade waitress</code>.</p>
                  </CardContent>
                </Card>

                <Card className="border-l-4 border-l-primary">
                  <CardHeader>
                    <CardTitle className="text-lg">Comment fonctionne l'attaque HTTP Request Smuggling ?</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p>L'attaque exploite le traitement incorrect des en-têtes Content-Length dupliqués. Quand Waitress reçoit deux en-têtes Content-Length (ex: 10 et 10), il les fusionne en "10, 10". Ne pouvant pas convertir cette valeur en entier, il définit Content-Length à 0. Le corps de la requête devient alors une nouvelle requête indépendante, permettant l'injection de commandes malveillantes.</p>
                  </CardContent>
                </Card>

                <Card className="border-l-4 border-l-primary">
                  <CardHeader>
                    <CardTitle className="text-lg">Quel est le niveau de criticité de CVE-2019-16792 ?</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p>CVE-2019-16792 est classée comme CRITIQUE selon la base de données GitHub Security Advisory (GHSA-4ppp-gpcr-7qf6). Cette classification reflète la facilité d'exploitation et l'impact potentiel élevé : vol de sessions, contournement d'authentification, injection de contenu malveillant et empoisonnement de cache.</p>
                  </CardContent>
                </Card>

                <Card className="border-l-4 border-l-primary">
                  <CardHeader>
                    <CardTitle className="text-lg">Comment vérifier si mon serveur est vulnérable ?</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p>Exécutez la commande <code>pip show waitress</code> pour afficher la version installée. Si la version est inférieure à 1.4.0, votre serveur est vulnérable. Vous pouvez également vérifier avec <code>pip list | grep waitress</code> ou consulter votre fichier requirements.txt pour voir la version spécifiée.</p>
                  </CardContent>
                </Card>

                <Card className="border-l-4 border-l-primary">
                  <CardHeader>
                    <CardTitle className="text-lg">Comment corriger la vulnérabilité CVE-2019-16792 ?</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p>La correction est simple : mettez à jour Waitress vers la version 1.4.0 ou supérieure avec <code>pip install --upgrade waitress</code>. Après la mise à jour, redémarrez vos services Python et vérifiez que la nouvelle version est bien active. Mettez également à jour votre fichier requirements.txt.</p>
                  </CardContent>
                </Card>

                <Card className="border-l-4 border-l-primary">
                  <CardHeader>
                    <CardTitle className="text-lg">Qu'est-ce que le HTTP Request Smuggling ?</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p>Le HTTP Request Smuggling (contrebande de requêtes HTTP) est une technique d'attaque qui exploite les différences d'interprétation des requêtes HTTP entre serveurs proxy et serveurs backend. L'attaquant manipule les en-têtes pour faire passer des requêtes cachées, contournant ainsi les contrôles de sécurité et pouvant voler des données sensibles.</p>
                  </CardContent>
                </Card>

                <Card className="border-l-4 border-l-primary">
                  <CardHeader>
                    <CardTitle className="text-lg">Cette vulnérabilité affecte-t-elle Django ou Flask ?</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p>Si vous utilisez Django ou Flask avec Waitress comme serveur WSGI, votre application est potentiellement vulnérable. La faille est dans Waitress, pas dans le framework. Cependant, les protections CSRF de ces frameworks peuvent être contournées via cette attaque. Mettez à jour Waitress indépendamment du framework utilisé.</p>
                  </CardContent>
                </Card>

                <Card className="border-l-4 border-l-primary">
                  <CardHeader>
                    <CardTitle className="text-lg">Les proxies inverses protègent-ils contre cette attaque ?</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p>Partiellement. Un proxy inverse comme Nginx ou HAProxy peut normaliser les en-têtes avant qu'ils n'atteignent Waitress. Cependant, la protection dépend de la configuration. Certains proxies transmettent les en-têtes dupliqués sans les filtrer. La meilleure protection reste la mise à jour de Waitress vers 1.4.0+.</p>
                  </CardContent>
                </Card>

                <Card className="border-l-4 border-l-primary">
                  <CardHeader>
                    <CardTitle className="text-lg">Pourquoi cette faille de 2019 est-elle critique en 2026 ?</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p>La base de données GHSA a été mise à jour le 22 janvier 2026 avec une réévaluation de la sévérité. De nombreux systèmes n'ont jamais été mis à jour depuis 2019. Les scans automatisés montrent que des dizaines de milliers de serveurs utilisent encore des versions vulnérables de Waitress en production.</p>
                  </CardContent>
                </Card>

                <Card className="border-l-4 border-l-primary">
                  <CardHeader>
                    <CardTitle className="text-lg">Comment auditer tous mes projets Python pour cette CVE ?</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p>Utilisez pip-audit ou safety pour scanner vos dépendances : <code>pip install pip-audit && pip-audit</code>. Pour un audit plus complet, utilisez Snyk ou Dependabot sur GitHub. Vérifiez tous vos fichiers requirements.txt et Pipfile dans vos dépôts pour identifier les versions vulnérables.</p>
                  </CardContent>
                </Card>

                <Card className="border-l-4 border-l-primary">
                  <CardHeader>
                    <CardTitle className="text-lg">Existe-t-il un exploit public pour CVE-2019-16792 ?</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p>Oui, le mécanisme d'exploitation est documenté publiquement. Des preuves de concept (PoC) circulent permettant de tester la vulnérabilité. L'exploitation ne nécessite pas de compétences avancées : un simple script Python peut forger les requêtes malveillantes. C'est pourquoi la mise à jour est urgente.</p>
                  </CardContent>
                </Card>

                <Card className="border-l-4 border-l-primary">
                  <CardHeader>
                    <CardTitle className="text-lg">Quels sont les risques concrets pour mon application ?</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p>Les risques incluent : le vol de cookies de session d'autres utilisateurs, le contournement de l'authentification et des contrôles d'accès, l'injection de contenu malveillant dans les réponses, l'empoisonnement du cache CDN/proxy, et la possibilité d'exfiltrer des données sensibles via des requêtes forgées.</p>
                  </CardContent>
                </Card>

                <Card className="border-l-4 border-l-primary">
                  <CardHeader>
                    <CardTitle className="text-lg">Comment détecter une exploitation de CVE-2019-16792 ?</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p>Surveillez vos logs pour des requêtes avec des en-têtes Content-Length dupliqués ou malformés. Configurez votre WAF pour alerter sur les patterns suspects. Analysez les anomalies dans les sessions utilisateur et les accès non autorisés. Les IDS comme Snort peuvent être configurés pour détecter ce type d'attaque.</p>
                  </CardContent>
                </Card>

                <Card className="border-l-4 border-l-primary">
                  <CardHeader>
                    <CardTitle className="text-lg">Waitress est-il utilisé en production ?</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p>Oui, Waitress est largement utilisé comme serveur WSGI Python en production. Il fait partie du projet Pylons et sert des milliers d'applications web Python incluant des frameworks comme Pyramid et Flask. Sa légèreté et sa compatibilité Windows/Linux en font un choix populaire pour les déploiements.</p>
                  </CardContent>
                </Card>

                <Card className="border-l-4 border-l-primary">
                  <CardHeader>
                    <CardTitle className="text-lg">Comment sécuriser mon infrastructure web globalement ?</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p>Au-delà de la correction de CVE-2019-16792, adoptez une approche de sécurité en profondeur : utilisez un hébergeur sécurisé comme Kinsta avec pare-feu Cloudflare intégré, activez les mises à jour automatiques, configurez un WAF, implémentez le monitoring de sécurité, et effectuez des audits réguliers de vos dépendances.</p>
                  </CardContent>
                </Card>
              </div>

              <h2 id="conclusion" className="flex items-center gap-3 text-3xl font-bold mt-16 mb-6">
                <Activity className="w-8 h-8 text-primary" />
                Conclusion : L'Urgence d'Agir
              </h2>

              <p className="text-lg leading-relaxed">
                La republication de CVE-2019-16792 avec une sévérité CRITIQUE en janvier 2026 est un rappel brutal que les vulnérabilités ne disparaissent pas simplement parce qu'un correctif existe. Des milliers de serveurs restent exposés, créant une surface d'attaque massive pour les cybercriminels.
              </p>

              <p className="text-lg leading-relaxed">
                L'attaque HTTP Request Smuggling exploitant cette faille n'est pas théorique. Elle est activement recherchée par des scanners automatisés et exploitée par des acteurs malveillants. Chaque jour sans mise à jour augmente votre risque d'être compromis.
              </p>

              <p className="text-lg leading-relaxed">
                La bonne nouvelle ? <strong>La correction est triviale</strong>. Une simple commande <code>pip install --upgrade waitress</code> suivie d'un redémarrage de vos services suffit à éliminer ce vecteur d'attaque. N'attendez pas d'être victime pour agir.
              </p>

              <Card className="my-10 border-2 border-primary bg-gradient-to-r from-primary/10 to-primary/5">
                <CardContent className="pt-6">
                  <div className="text-center">
                    <h3 className="text-2xl font-bold mb-4">Actions Immédiates</h3>
                    <div className="flex flex-wrap justify-center gap-4 mb-6">
                      <Badge variant="outline" className="text-lg py-2 px-4">1. Vérifiez votre version Waitress</Badge>
                      <Badge variant="outline" className="text-lg py-2 px-4">2. Mettez à jour vers 1.4.0+</Badge>
                      <Badge variant="outline" className="text-lg py-2 px-4">3. Redémarrez vos services</Badge>
                    </div>
                    <Button size="lg" onClick={() => handleCTAClick('conclusion_cta')} data-testid="button-cta-conclusion">
                      <Shield className="mr-2 w-5 h-5" />
                      Sécurisez votre hébergement avec Kinsta
                      <ExternalLink className="ml-2 w-4 h-4" />
                    </Button>
                  </div>
                </CardContent>
              </Card>

            </div>

            <section className="mt-16 pt-8 border-t">
              <h3 className="text-2xl font-bold mb-6 flex items-center gap-3">
                <Globe className="w-6 h-6 text-primary" />
                Articles Connexes
              </h3>
              <div className="grid md:grid-cols-2 gap-6">
                <Link href="/article/cyberattaque-agroparistech-2026">
                  <Card className="h-full hover-elevate cursor-pointer">
                    <CardHeader>
                      <Badge variant="destructive" className="w-fit mb-2">Cyberattaque</Badge>
                      <CardTitle className="text-lg">Cyberattaque AgroParisTech 2026</CardTitle>
                    </CardHeader>
                    <CardContent>
                      <p className="text-muted-foreground text-sm">Analyse de l'intrusion majeure et des risques pour les données des ingénieurs et étudiants.</p>
                    </CardContent>
                  </Card>
                </Link>
                <Link href="/article/securite-wordpress-guide-2026">
                  <Card className="h-full hover-elevate cursor-pointer">
                    <CardHeader>
                      <Badge variant="secondary" className="w-fit mb-2">Guide</Badge>
                      <CardTitle className="text-lg">Sécurité WordPress : Guide Complet 2026</CardTitle>
                    </CardHeader>
                    <CardContent>
                      <p className="text-muted-foreground text-sm">Toutes les bonnes pratiques pour sécuriser votre site WordPress contre les attaques.</p>
                    </CardContent>
                  </Card>
                </Link>
                <Link href="/article/vulnerabilites-wordpress-2026">
                  <Card className="h-full hover-elevate cursor-pointer">
                    <CardHeader>
                      <Badge variant="outline" className="w-fit mb-2">Vulnérabilités</Badge>
                      <CardTitle className="text-lg">Vulnérabilités WordPress 2026</CardTitle>
                    </CardHeader>
                    <CardContent>
                      <p className="text-muted-foreground text-sm">Panorama complet des failles découvertes et des correctifs à appliquer.</p>
                    </CardContent>
                  </Card>
                </Link>
                <Link href="/audit-site">
                  <Card className="h-full hover-elevate cursor-pointer">
                    <CardHeader>
                      <Badge className="w-fit mb-2 bg-purple-600">Outil</Badge>
                      <CardTitle className="text-lg">Audit de Sécurité Gratuit</CardTitle>
                    </CardHeader>
                    <CardContent>
                      <p className="text-muted-foreground text-sm">Analysez gratuitement la sécurité de votre site web avec notre outil d'audit complet.</p>
                    </CardContent>
                  </Card>
                </Link>
              </div>
            </section>

          </article>
        </div>
      </main>

      <SEOFooter />
    </div>
  );
}
