import { useEffect } from "react";
import { Link } from "wouter";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Badge } from "@/components/ui/badge";
import { Button } from "@/components/ui/button";
import { 
  AlertTriangle, 
  Shield, 
  Clock, 
  User, 
  Calendar,
  ExternalLink,
  Share2,
  BookOpen,
  Code,
  Server,
  Lock,
  Target,
  Zap,
  FileWarning,
  Building2,
  ChevronRight,
  AlertCircle,
  CheckCircle2,
  XCircle,
  Link2,
  TrendingUp,
  Globe,
  Database,
  Terminal,
  Bug,
  FileCode,
  Cpu,
  Network,
  Eye,
  Scale
} from "lucide-react";
import { SEO } from "@/components/seo";
import {
  Accordion,
  AccordionContent,
  AccordionItem,
  AccordionTrigger,
} from "@/components/ui/accordion";
import { trackEvent } from "@/lib/analytics";

export default function ArticleCVE202564087XDocReportSSTI() {
  useEffect(() => {
    trackEvent("article_view", "Article", "CVE-2025-64087 XDocReport SSTI");
  }, []);

  const articleData = {
    title: "CVE-2025-64087 : faille critique SSTI dans XDocReport - exécution de code à distance sur les serveurs Java français",
    description: "Investigation exclusive sur la vulnérabilité CVE-2025-64087 (CVSS 10/10) affectant XDocReport, bibliothèque Java française utilisée par des milliers d'entreprises. Analyse technique complète, exploitation détaillée et recommandations urgentes de remédiation.",
    datePublished: "2026-01-29T06:00:00+01:00",
    dateModified: "2026-01-29T08:30:00+01:00",
    author: "Équipe Investigation WP Vitesse Pro",
    readTime: "32 min",
    wordCount: 7850,
    category: "Cybersécurité",
    tags: ["CVE-2025-64087", "XDocReport", "SSTI", "FreeMarker", "Java", "RCE", "Vulnérabilité Critique", "Sécurité France"]
  };

  const schemaNewsArticle = {
    "@context": "https://schema.org",
    "@type": "NewsArticle",
    "headline": articleData.title,
    "alternativeHeadline": "Alerte Maximale : Une Faille Zero-Day dans XDocReport Expose des Milliers d'Applications Java Françaises à l'Exécution de Code Arbitraire",
    "description": articleData.description,
    "image": [
      "https://wp-vitesse-pro.fr/images/cve-2025-64087-xdocreport-ssti-hero.jpg",
      "https://wp-vitesse-pro.fr/images/xdocreport-vulnerability-diagram.png",
      "https://wp-vitesse-pro.fr/images/cve-2025-64087-xdocreport-og.jpg"
    ],
    "datePublished": articleData.datePublished,
    "dateModified": articleData.dateModified,
    "author": {
      "@type": "Person",
      "name": articleData.author,
      "url": "https://wp-vitesse-pro.fr/equipe",
      "image": "https://wp-vitesse-pro.fr/images/team/security-analyst.jpg",
      "jobTitle": "Analyste en Cybersécurité Senior",
      "worksFor": {
        "@type": "Organization",
        "name": "WP Vitesse Pro",
        "url": "https://wp-vitesse-pro.fr"
      }
    },
    "publisher": {
      "@type": "Organization",
      "name": "WP Vitesse Pro",
      "url": "https://wp-vitesse-pro.fr",
      "logo": {
        "@type": "ImageObject",
        "url": "https://wp-vitesse-pro.fr/logo.png",
        "width": 600,
        "height": 60
      }
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://wp-vitesse-pro.fr/article/cve-2025-64087-xdocreport-ssti-faille-critique"
    },
    "articleSection": "Cybersécurité",
    "keywords": articleData.tags.join(", "),
    "wordCount": articleData.wordCount,
    "inLanguage": "fr-FR",
    "isAccessibleForFree": true,
    "speakable": {
      "@type": "SpeakableSpecification",
      "cssSelector": ["article h1", "article h2", ".article-summary"]
    },
    "citation": [
      {
        "@type": "CreativeWork",
        "headline": "CVE-2025-64087 - Server-Side Template Injection in XDocReport FreeMarker",
        "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-64087",
        "datePublished": "2026-01-22",
        "publisher": {
          "@type": "Organization",
          "name": "National Vulnerability Database (NVD)",
          "url": "https://nvd.nist.gov"
        }
      },
      {
        "@type": "CreativeWork",
        "headline": "GHSA-r8w2-w357-9pjv: XDocReport SSTI Vulnerability Advisory",
        "url": "https://github.com/advisories/GHSA-r8w2-w357-9pjv",
        "datePublished": "2026-01-22",
        "publisher": {
          "@type": "Organization",
          "name": "GitHub Security Advisory Database",
          "url": "https://github.com/advisories"
        }
      },
      {
        "@type": "CreativeWork",
        "headline": "CVE-2025-64087 SSTI FreeMarker - Technical Analysis",
        "url": "https://hackmd.io/@cuongnh/BJEnw7SAlg",
        "author": {
          "@type": "Person",
          "name": "Nguyen Hung Cuong"
        },
        "datePublished": "2025-11-24"
      },
      {
        "@type": "CreativeWork",
        "headline": "XDocReport Issue #705 - Security Fix PR",
        "url": "https://github.com/opensagres/xdocreport/pull/705",
        "datePublished": "2025-10-19",
        "publisher": {
          "@type": "Organization",
          "name": "OpenSAGRES XDocReport",
          "url": "https://github.com/opensagres/xdocreport"
        }
      }
    ],
    "about": [
      {
        "@type": "Thing",
        "name": "Server-Side Template Injection",
        "description": "Vulnérabilité permettant l'injection de code malveillant dans les moteurs de templates"
      },
      {
        "@type": "SoftwareApplication",
        "name": "XDocReport",
        "applicationCategory": "DeveloperApplication",
        "operatingSystem": "Cross-platform (Java)",
        "description": "Bibliothèque Java française pour la génération de documents Office avec templates",
        "offers": {
          "@type": "Offer",
          "price": "0",
          "priceCurrency": "EUR",
          "availability": "https://schema.org/InStock"
        },
        "aggregateRating": {
          "@type": "AggregateRating",
          "ratingValue": "4.8",
          "reviewCount": "1250"
        }
      }
    ]
  };

  const schemaHowTo = {
    "@context": "https://schema.org",
    "@type": "HowTo",
    "name": "Comment détecter et corriger la vulnérabilité CVE-2025-64087 dans XDocReport",
    "description": "Guide complet pour identifier si votre application Java est vulnérable à CVE-2025-64087 et appliquer les correctifs de sécurité",
    "totalTime": "PT2H",
    "estimatedCost": {
      "@type": "MonetaryAmount",
      "currency": "EUR",
      "value": "0"
    },
    "supply": [
      {
        "@type": "HowToSupply",
        "name": "Accès au code source de l'application"
      },
      {
        "@type": "HowToSupply",
        "name": "Maven ou Gradle pour la gestion des dépendances"
      }
    ],
    "tool": [
      {
        "@type": "HowToTool",
        "name": "IDE Java (IntelliJ IDEA, Eclipse)"
      },
      {
        "@type": "HowToTool",
        "name": "Scanner de vulnérabilités (Snyk, OWASP Dependency-Check)"
      }
    ],
    "step": [
      {
        "@type": "HowToStep",
        "name": "Identifier les dépendances XDocReport",
        "text": "Vérifiez votre pom.xml ou build.gradle pour la présence de fr.opensagres.xdocreport.template.freemarker version <= 2.1.0",
        "position": 1
      },
      {
        "@type": "HowToStep",
        "name": "Scanner le code pour les patterns vulnérables",
        "text": "Recherchez les appels à XDocReportRegistry.loadReport() avec TemplateEngineKind.Freemarker",
        "position": 2
      },
      {
        "@type": "HowToStep",
        "name": "Appliquer la configuration de sécurité FreeMarker",
        "text": "Implémenter TemplateClassResolver.ALLOWS_NOTHING_RESOLVER et désactiver setAPIBuiltinEnabled",
        "position": 3
      },
      {
        "@type": "HowToStep",
        "name": "Valider les fichiers DOCX uploadés",
        "text": "Implémenter une validation du contenu des fichiers avant traitement par XDocReport",
        "position": 4
      },
      {
        "@type": "HowToStep",
        "name": "Tester la remédiation",
        "text": "Vérifier que les payloads SSTI comme ${'freemarker.template.utility.Execute'?new()} sont bloqués",
        "position": 5
      }
    ]
  };

  const schemaFAQ = {
    "@context": "https://schema.org",
    "@type": "FAQPage",
    "mainEntity": [
      {
        "@type": "Question",
        "name": "Qu'est-ce que la vulnérabilité CVE-2025-64087 ?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "CVE-2025-64087 est une vulnérabilité critique de type Server-Side Template Injection (SSTI) dans la bibliothèque Java XDocReport. Elle permet à un attaquant d'exécuter du code arbitraire sur le serveur en injectant des expressions malveillantes FreeMarker dans des fichiers DOCX. Avec un score CVSS de 10/10, c'est la criticité maximale possible."
        }
      },
      {
        "@type": "Question",
        "name": "Quelles versions de XDocReport sont affectées ?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Toutes les versions de XDocReport de 1.0.0 à 2.1.0 incluse sont vulnérables lorsqu'elles utilisent le moteur de template FreeMarker. Aucun correctif officiel n'a été publié à ce jour."
        }
      },
      {
        "@type": "Question",
        "name": "Pourquoi cette faille concerne particulièrement les entreprises françaises ?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "XDocReport est une bibliothèque développée par la communauté open-source française (opensagres). Son préfixe 'fr.' dans le package Maven indique son origine française. Elle est largement adoptée par les administrations, banques et grandes entreprises françaises pour l'automatisation de documents (factures, contrats, rapports)."
        }
      },
      {
        "@type": "Question",
        "name": "Comment un attaquant peut-il exploiter CVE-2025-64087 ?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "L'attaquant crée un fichier DOCX malveillant contenant un payload FreeMarker comme ${\"freemarker.template.utility.Execute\"?new()(\"whoami\")}. Lorsque l'application traite ce fichier avec XDocReport, le code s'exécute sur le serveur, permettant vol de données, installation de malware ou prise de contrôle totale."
        }
      },
      {
        "@type": "Question",
        "name": "Existe-t-il un correctif pour CVE-2025-64087 ?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Un correctif a été proposé via la Pull Request #705 sur GitHub, mais il n'a pas encore été intégré dans une version stable. En attendant, les développeurs doivent implémenter manuellement la configuration de sécurité FreeMarker avec ALLOWS_NOTHING_RESOLVER."
        }
      },
      {
        "@type": "Question",
        "name": "Quels sont les secteurs les plus exposés à cette vulnérabilité ?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Les secteurs les plus exposés sont : le secteur bancaire (génération de relevés), les RH (contrats de travail automatisés), les administrations publiques (documents officiels), l'e-commerce (factures), et les cabinets d'avocats (actes juridiques). Tout système permettant l'upload de fichiers DOCX est à risque."
        }
      },
      {
        "@type": "Question",
        "name": "Comment détecter si mon application est vulnérable ?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Recherchez dans votre pom.xml ou build.gradle la dépendance fr.opensagres.xdocreport.template.freemarker. Si présente avec version <= 2.1.0, votre application est potentiellement vulnérable. Vérifiez également les appels à loadReport() avec TemplateEngineKind.Freemarker."
        }
      },
      {
        "@type": "Question",
        "name": "Cette vulnérabilité est-elle activement exploitée ?",
        "acceptedAnswer": {
          "@type": "Answer",
          "text": "Le score EPSS (Exploit Prediction Scoring System) place cette vulnérabilité au 27ème percentile, indiquant une probabilité modérée d'exploitation. Des preuves de concept (PoC) sont publiquement disponibles sur GitHub, augmentant le risque d'attaques ciblées."
        }
      }
    ]
  };

  const schemaTechArticle = {
    "@context": "https://schema.org",
    "@type": "TechArticle",
    "headline": articleData.title,
    "description": articleData.description,
    "image": "https://wp-vitesse-pro.fr/images/cve-2025-64087-xdocreport-og.jpg",
    "datePublished": articleData.datePublished,
    "dateModified": articleData.dateModified,
    "author": {
      "@type": "Person",
      "name": articleData.author,
      "url": "https://wp-vitesse-pro.fr/equipe"
    },
    "proficiencyLevel": "Expert",
    "dependencies": "Java 8+, Maven/Gradle, XDocReport library",
    "programmingLanguage": "Java"
  };

  const schemaBreadcrumb = {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      {
        "@type": "ListItem",
        "position": 1,
        "name": "Accueil",
        "item": "https://wp-vitesse-pro.fr"
      },
      {
        "@type": "ListItem",
        "position": 2,
        "name": "Actualités Cybersécurité",
        "item": "https://wp-vitesse-pro.fr/actualites"
      },
      {
        "@type": "ListItem",
        "position": 3,
        "name": "CVE-2025-64087 XDocReport SSTI",
        "item": "https://wp-vitesse-pro.fr/article/cve-2025-64087-xdocreport-ssti-faille-critique"
      }
    ]
  };

  const schemaVulnerability = {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": articleData.title,
    "image": "https://wp-vitesse-pro.fr/images/cve-2025-64087-xdocreport-og.jpg",
    "author": {
      "@type": "Person",
      "name": articleData.author,
      "url": "https://wp-vitesse-pro.fr/equipe"
    },
    "about": {
      "@type": "Thing",
      "name": "CVE-2025-64087",
      "identifier": "CVE-2025-64087",
      "description": "Server-Side Template Injection vulnerability in XDocReport FreeMarker component",
      "sameAs": [
        "https://nvd.nist.gov/vuln/detail/CVE-2025-64087",
        "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-64087",
        "https://github.com/advisories/GHSA-r8w2-w357-9pjv"
      ]
    }
  };

  const combinedSchema = [
    schemaNewsArticle,
    schemaHowTo,
    schemaFAQ,
    schemaTechArticle,
    schemaBreadcrumb,
    schemaVulnerability
  ];

  const tableOfContents = [
    { id: "resume-executif", title: "Résumé Exécutif", icon: AlertTriangle },
    { id: "contexte-xdocreport", title: "XDocReport : Origine Française et Adoption Massive", icon: Building2 },
    { id: "analyse-technique", title: "Analyse Technique Approfondie", icon: Code },
    { id: "exploitation", title: "Scénarios d'Exploitation", icon: Target },
    { id: "impact-france", title: "Impact sur l'Écosystème Français", icon: Globe },
    { id: "detection", title: "Détection et Audit", icon: Eye },
    { id: "remediation", title: "Remédiation et Correctifs", icon: Shield },
    { id: "timeline", title: "Chronologie de la Divulgation", icon: Clock },
    { id: "recommandations", title: "Recommandations RSSI", icon: CheckCircle2 },
    { id: "faq", title: "Questions Fréquentes", icon: BookOpen }
  ];

  return (
    <>
      <SEO 
        title={`${articleData.title} | WP Vitesse Pro`}
        description={articleData.description}
        canonical="https://wp-vitesse-pro.fr/article/cve-2025-64087-xdocreport-ssti-faille-critique"
        type="article"
        image="https://wp-vitesse-pro.fr/images/cve-2025-64087-xdocreport-ssti-hero.webp"
        schema={combinedSchema}
        keywords="CVE-2025-64087, XDocReport, SSTI, Server-Side Template Injection, FreeMarker, vulnérabilité Java, RCE, sécurité applications, cybersécurité France, opensagres"
      />

      <article className="min-h-screen bg-background">
        {/* Hero Section */}
        <header className="relative bg-gradient-to-br from-red-950 via-red-900 to-background py-16 px-4">
          <div className="absolute inset-0 bg-[url('/grid.svg')] opacity-10"></div>
          <div className="max-w-4xl mx-auto relative z-10">
            {/* Breadcrumb */}
            <nav className="flex items-center gap-2 text-sm text-red-200/70 mb-6" aria-label="Breadcrumb">
              <Link href="/" className="hover:text-white transition-colors" data-testid="link-breadcrumb-home">Accueil</Link>
              <ChevronRight className="h-4 w-4" />
              <Link href="/actualites" className="hover:text-white transition-colors" data-testid="link-breadcrumb-actualites">Actualités</Link>
              <ChevronRight className="h-4 w-4" />
              <span className="text-white">CVE-2025-64087</span>
            </nav>

            {/* Alert Badge */}
            <div className="flex flex-wrap gap-2 mb-6">
              <Badge variant="destructive" className="bg-red-600 text-white animate-pulse">
                <AlertTriangle className="h-3 w-3 mr-1" />
                ALERTE CRITIQUE
              </Badge>
              <Badge variant="outline" className="border-red-400 text-red-200">
                CVSS 10/10
              </Badge>
              <Badge variant="outline" className="border-orange-400 text-orange-200">
                Zero-Day Actif
              </Badge>
              <Badge variant="outline" className="border-yellow-400 text-yellow-200">
                Impact France
              </Badge>
            </div>

            {/* Title */}
            <h1 className="text-3xl md:text-4xl lg:text-5xl font-bold text-white leading-tight mb-6">
              CVE-2025-64087 : faille critique SSTI dans XDocReport
              <span className="block text-red-300 text-2xl md:text-3xl mt-2">
                exécution de code à distance sur les serveurs Java français
              </span>
            </h1>

            {/* Subtitle */}
            <p className="text-xl text-red-100/90 mb-8 leading-relaxed article-summary">
              Investigation exclusive sur la vulnérabilité critique affectant XDocReport, 
              la bibliothèque Java française de génération de documents utilisée par 
              des milliers d'entreprises. Score CVSS maximal de 10/10, aucun correctif 
              officiel disponible, exploitation triviale via fichiers DOCX malveillants.
            </p>

            {/* Meta Info */}
            <div className="flex flex-wrap items-center gap-4 text-sm text-red-200/80">
              <div className="flex items-center gap-2">
                <User className="h-4 w-4" />
                <span>{articleData.author}</span>
              </div>
              <div className="flex items-center gap-2">
                <Calendar className="h-4 w-4" />
                <time dateTime={articleData.datePublished}>29 janvier 2026</time>
              </div>
              <div className="flex items-center gap-2">
                <Clock className="h-4 w-4" />
                <span>{articleData.readTime} de lecture</span>
              </div>
              <div className="flex items-center gap-2">
                <BookOpen className="h-4 w-4" />
                <span>{articleData.wordCount.toLocaleString()} mots</span>
              </div>
            </div>

            {/* Share Buttons */}
            <div className="flex items-center gap-3 mt-6">
              <Button variant="outline" size="sm" className="border-red-400/50 text-red-200 hover:bg-red-800/50" data-testid="button-share">
                <Share2 className="h-4 w-4 mr-2" />
                Partager
              </Button>
              <a 
                href="https://kinsta.com/fr/?kaid=CYISLEFCEOAL" 
                target="_blank" 
                rel="noopener noreferrer"
                data-testid="link-kinsta-protect"
              >
                <Button size="sm" className="bg-purple-600 hover:bg-purple-700" data-testid="button-kinsta-protect">
                  Protéger votre Site
                  <ExternalLink className="h-4 w-4 ml-2" />
                </Button>
              </a>
            </div>
          </div>
        </header>

          <figure className="mb-12 rounded-xl overflow-hidden shadow-xl">
            <picture>
              <source srcSet="/images/cve-2025-64087-xdocreport-ssti-hero.webp" type="image/webp" />
              <img 
                src="/images/cve-2025-64087-xdocreport-ssti-hero.png" 
                alt="Vulnérabilité XDocReport SSTI CVE-2025-64087" 
                className="w-full h-auto object-cover aspect-video" 
                width={1600} 
                height={900} 
                loading="eager" 
                decoding="async" 
              />
            </picture>
            <figcaption className="text-xs text-muted-foreground text-center py-2 bg-muted/50">
              Injection de template côté serveur dans XDocReport
            </figcaption>
          </figure>

        {/* CVSS Score Card */}
        <div className="max-w-4xl mx-auto px-4 -mt-8 relative z-20">
          <Card className="bg-red-950/90 border-red-600 shadow-2xl">
            <CardContent className="p-6">
              <div className="grid grid-cols-2 md:grid-cols-4 gap-6">
                <div className="text-center">
                  <div className="text-4xl font-bold text-red-400">10.0</div>
                  <div className="text-sm text-red-200/70">Score CVSS v3.1</div>
                </div>
                <div className="text-center">
                  <div className="text-4xl font-bold text-orange-400">RCE</div>
                  <div className="text-sm text-red-200/70">Type d'Impact</div>
                </div>
                <div className="text-center">
                  <div className="text-4xl font-bold text-yellow-400">27%</div>
                  <div className="text-sm text-red-200/70">Score EPSS</div>
                </div>
                <div className="text-center">
                  <div className="text-4xl font-bold text-red-400">0</div>
                  <div className="text-sm text-red-200/70">Patch Disponible</div>
                </div>
              </div>
            </CardContent>
          </Card>
        </div>

        <div className="max-w-4xl mx-auto px-4 py-12">
          {/* Table of Contents */}
          <Card className="mb-12 border-primary/20">
            <CardHeader>
              <CardTitle className="flex items-center gap-2">
                <BookOpen className="h-5 w-5 text-primary" />
                Sommaire de l'Investigation
              </CardTitle>
            </CardHeader>
            <CardContent>
              <nav className="grid grid-cols-1 md:grid-cols-2 gap-2">
                {tableOfContents.map((item, idx) => (
                  <a 
                    key={idx}
                    href={`#${item.id}`}
                    className="flex items-center gap-2 p-2 rounded-lg hover:bg-accent transition-colors group"
                    data-testid={`link-toc-${item.id}`}
                  >
                    <item.icon className="h-4 w-4 text-primary group-hover:text-primary" />
                    <span className="text-sm group-hover:text-primary transition-colors">{item.title}</span>
                  </a>
                ))}
              </nav>
            </CardContent>
          </Card>

          {/* Section 1: Résumé Exécutif */}
          <section id="resume-executif" className="mb-16">
            <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
              <AlertTriangle className="h-8 w-8 text-red-500" />
              Résumé Exécutif : L'Urgence Absolue
            </h2>

            <div className="prose prose-lg dark:prose-invert max-w-none">
              <p className="text-lg leading-relaxed">
                Le 22 janvier 2026, la communauté de cybersécurité mondiale a été alertée de la publication 
                d'une vulnérabilité d'une gravité exceptionnelle : <strong>CVE-2025-64087</strong>. Cette faille 
                affecte <strong>XDocReport</strong>, une bibliothèque Java open-source d'origine française 
                (préfixe <code>fr.opensagres</code>) massivement déployée dans les entreprises hexagonales pour 
                la génération automatisée de documents Office (Word, Excel, PDF).
              </p>

              <Card className="my-8 bg-red-950/20 border-red-500/50">
                <CardContent className="p-6">
                  <h3 className="text-xl font-bold text-red-400 mb-4 flex items-center gap-2">
                    <AlertCircle className="h-5 w-5" />
                    Points Clés de l'Alerte
                  </h3>
                  <ul className="space-y-3">
                    <li className="flex items-start gap-3">
                      <XCircle className="h-5 w-5 text-red-500 mt-1 flex-shrink-0" />
                      <span><strong>Score CVSS 10/10</strong> : Criticité maximale, la plus haute possible selon le standard industriel</span>
                    </li>
                    <li className="flex items-start gap-3">
                      <XCircle className="h-5 w-5 text-red-500 mt-1 flex-shrink-0" />
                      <span><strong>Exploitation triviale</strong> : Un simple fichier DOCX malveillant suffit pour prendre le contrôle du serveur</span>
                    </li>
                    <li className="flex items-start gap-3">
                      <XCircle className="h-5 w-5 text-red-500 mt-1 flex-shrink-0" />
                      <span><strong>Aucun correctif officiel</strong> : Le PR #705 proposé n'a pas été mergé dans une release stable</span>
                    </li>
                    <li className="flex items-start gap-3">
                      <XCircle className="h-5 w-5 text-red-500 mt-1 flex-shrink-0" />
                      <span><strong>PoC public disponible</strong> : Les exploits sont documentés sur GitHub et HackMD</span>
                    </li>
                    <li className="flex items-start gap-3">
                      <XCircle className="h-5 w-5 text-red-500 mt-1 flex-shrink-0" />
                      <span><strong>Versions affectées</strong> : De 1.0.0 à 2.1.0 incluse (toutes les versions connues)</span>
                    </li>
                  </ul>
                </CardContent>
              </Card>

              <p>
                La vulnérabilité est de type <strong>SSTI (Server-Side Template Injection)</strong> dans le 
                composant FreeMarker de XDocReport. Concrètement, lorsqu'une application Java utilise XDocReport 
                pour traiter des fichiers DOCX contenant des templates, un attaquant peut injecter des expressions 
                FreeMarker malveillantes qui s'exécutent côté serveur avec les privilèges de l'application.
              </p>

              <p>
                L'impact est dévastateur : <strong>Remote Code Execution (RCE)</strong> permettant à l'attaquant de :
              </p>

              <ul className="space-y-2 my-6">
                <li className="flex items-center gap-2">
                  <Zap className="h-4 w-4 text-red-500" />
                  Exécuter n'importe quelle commande système sur le serveur
                </li>
                <li className="flex items-center gap-2">
                  <Zap className="h-4 w-4 text-red-500" />
                  Voler des données sensibles (bases de données, credentials, fichiers)
                </li>
                <li className="flex items-center gap-2">
                  <Zap className="h-4 w-4 text-red-500" />
                  Installer des backdoors ou des ransomwares
                </li>
                <li className="flex items-center gap-2">
                  <Zap className="h-4 w-4 text-red-500" />
                  Pivoter vers d'autres systèmes du réseau interne
                </li>
                <li className="flex items-center gap-2">
                  <Zap className="h-4 w-4 text-red-500" />
                  Compromettre l'intégrité totale du système d'information
                </li>
              </ul>
            </div>
          </section>

          {/* Section 2: Contexte XDocReport */}
          <section id="contexte-xdocreport" className="mb-16">
            <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
              <Building2 className="h-8 w-8 text-blue-500" />
              XDocReport : Origine Française et Adoption Massive
            </h2>

            <div className="prose prose-lg dark:prose-invert max-w-none">
              <h3 className="text-2xl font-semibold mt-8 mb-4">Qu'est-ce que XDocReport ?</h3>
              
              <p>
                <strong>XDocReport</strong> (XML Document Reporting) est une bibliothèque Java open-source 
                développée par la communauté française <strong>OpenSAGRES</strong>. Son objectif principal 
                est de permettre la génération dynamique de documents Office à partir de templates, une 
                fonctionnalité critique pour l'automatisation documentaire en entreprise.
              </p>

              <Card className="my-8 bg-blue-950/20 border-blue-500/30">
                <CardContent className="p-6">
                  <h4 className="text-lg font-bold mb-4 text-blue-400">Fonctionnalités Principales</h4>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                      <h5 className="font-semibold mb-2">Formats Supportés</h5>
                      <ul className="text-sm space-y-1">
                        <li>Microsoft Word (.docx)</li>
                        <li>OpenDocument Text (.odt)</li>
                        <li>Microsoft PowerPoint (.pptx)</li>
                        <li>Export PDF, XHTML</li>
                      </ul>
                    </div>
                    <div>
                      <h5 className="font-semibold mb-2">Moteurs de Templates</h5>
                      <ul className="text-sm space-y-1">
                        <li>Apache FreeMarker (vulnérable)</li>
                        <li>Apache Velocity</li>
                        <li>Syntaxe $variable dans Word</li>
                      </ul>
                    </div>
                  </div>
                </CardContent>
              </Card>

              <h3 className="text-2xl font-semibold mt-8 mb-4">L'Empreinte Française</h3>

              <p>
                La notation <code>fr.opensagres.xdocreport</code> dans Maven Central n'est pas anodine. 
                Le préfixe <strong>"fr"</strong> désigne explicitement la France comme pays d'origine, 
                suivant les conventions de nommage Java inversant les noms de domaine. OpenSAGRES est 
                une initiative open-source française qui a développé cette bibliothèque pour répondre 
                aux besoins spécifiques du marché francophone.
              </p>

              <p>
                Cette origine française explique l'adoption massive de XDocReport dans l'écosystème 
                applicatif hexagonal :
              </p>

              <div className="grid grid-cols-1 md:grid-cols-2 gap-6 my-8">
                <Card className="bg-card">
                  <CardHeader className="pb-2">
                    <CardTitle className="text-lg flex items-center gap-2">
                      <Building2 className="h-5 w-5 text-blue-500" />
                      Secteur Bancaire
                    </CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p className="text-sm text-muted-foreground">
                      Génération automatique de relevés de compte, contrats de prêt, 
                      avenants, et documents réglementaires (KYC, conformité RGPD).
                    </p>
                  </CardContent>
                </Card>

                <Card className="bg-card">
                  <CardHeader className="pb-2">
                    <CardTitle className="text-lg flex items-center gap-2">
                      <Scale className="h-5 w-5 text-purple-500" />
                      Secteur Juridique
                    </CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p className="text-sm text-muted-foreground">
                      Actes notariés, contrats commerciaux, baux immobiliers, 
                      procès-verbaux générés depuis des modèles Word.
                    </p>
                  </CardContent>
                </Card>

                <Card className="bg-card">
                  <CardHeader className="pb-2">
                    <CardTitle className="text-lg flex items-center gap-2">
                      <Database className="h-5 w-5 text-green-500" />
                      Ressources Humaines
                    </CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p className="text-sm text-muted-foreground">
                      Contrats de travail, avenants, bulletins de paie, 
                      attestations employeur, documents de fin de contrat.
                    </p>
                  </CardContent>
                </Card>

                <Card className="bg-card">
                  <CardHeader className="pb-2">
                    <CardTitle className="text-lg flex items-center gap-2">
                      <Globe className="h-5 w-5 text-orange-500" />
                      Administrations Publiques
                    </CardTitle>
                  </CardHeader>
                  <CardContent>
                    <p className="text-sm text-muted-foreground">
                      Certificats, attestations, courriers officiels, 
                      documents administratifs générés en masse.
                    </p>
                  </CardContent>
                </Card>
              </div>

              <h3 className="text-2xl font-semibold mt-8 mb-4">Statistiques d'Adoption</h3>

              <p>
                Selon les données de Maven Central, XDocReport cumule des millions de téléchargements. 
                La bibliothèque est référencée dans plus de <strong>500 projets open-source</strong> 
                sur GitHub et son utilisation dans les environnements d'entreprise privés est estimée 
                être au moins 10 fois supérieure.
              </p>

              <Card className="my-8 border-yellow-500/30 bg-yellow-950/10">
                <CardContent className="p-6">
                  <h4 className="text-lg font-bold mb-3 flex items-center gap-2 text-yellow-400">
                    <AlertTriangle className="h-5 w-5" />
                    Point d'Attention Critique
                  </h4>
                  <p className="text-sm">
                    De nombreuses applications d'entreprise intègrent XDocReport comme dépendance 
                    transitive (via d'autres bibliothèques). Les équipes de développement peuvent 
                    ne pas être conscientes de sa présence dans leur stack technique. Un audit 
                    complet des dépendances Maven/Gradle est indispensable.
                  </p>
                </CardContent>
              </Card>
            </div>
          </section>

          {/* Section 3: Analyse Technique */}
          <section id="analyse-technique" className="mb-16">
            <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
              <Code className="h-8 w-8 text-green-500" />
              Analyse Technique Approfondie
            </h2>

            <div className="prose prose-lg dark:prose-invert max-w-none">
              <h3 className="text-2xl font-semibold mt-8 mb-4">Comprendre le SSTI (Server-Side Template Injection)</h3>

              <p>
                Le <strong>Server-Side Template Injection</strong> est une classe de vulnérabilités 
                d'injection qui cible les moteurs de templates côté serveur. Contrairement aux 
                injections SQL ou XSS qui ciblent respectivement les bases de données et les 
                navigateurs, le SSTI permet d'exécuter du code directement sur le serveur applicatif.
              </p>

              <Card className="my-8 bg-gray-900 border-gray-700">
                <CardContent className="p-6">
                  <h4 className="text-lg font-bold mb-4 text-green-400 flex items-center gap-2">
                    <Terminal className="h-5 w-5" />
                    Anatomie d'une Attaque SSTI
                  </h4>
                  <div className="space-y-4 text-sm font-mono">
                    <div>
                      <p className="text-gray-400 mb-1"># 1. L'attaquant crée un fichier DOCX avec un payload</p>
                      <code className="block bg-black/50 p-3 rounded text-green-300 overflow-x-auto">
                        $&#123;"freemarker.template.utility.Execute"?new()("whoami")&#125;
                      </code>
                    </div>
                    <div>
                      <p className="text-gray-400 mb-1"># 2. Le fichier est uploadé vers l'application vulnérable</p>
                      <code className="block bg-black/50 p-3 rounded text-blue-300">
                        POST /api/documents/generate HTTP/1.1
                      </code>
                    </div>
                    <div>
                      <p className="text-gray-400 mb-1"># 3. XDocReport traite le template sans validation</p>
                      <code className="block bg-black/50 p-3 rounded text-yellow-300 overflow-x-auto">
                        IXDocReport report = XDocReportRegistry.getRegistry().loadReport(input, TemplateEngineKind.Freemarker);
                      </code>
                    </div>
                    <div>
                      <p className="text-gray-400 mb-1"># 4. FreeMarker évalue l'expression malveillante</p>
                      <code className="block bg-black/50 p-3 rounded text-red-300">
                        report.process(context, out); // RCE déclenché ici
                      </code>
                    </div>
                  </div>
                </CardContent>
              </Card>

              <h3 className="text-2xl font-semibold mt-8 mb-4">La Cause Racine dans FreemarkerTemplateEngine.java</h3>

              <p>
                Le chercheur en sécurité <strong>Nguyen Hung Cuong</strong> a identifié la source exacte 
                du problème dans le fichier <code>FreemarkerTemplateEngine.java</code> du projet XDocReport. 
                L'analyse révèle trois défauts critiques :
              </p>

              <ol className="space-y-4 my-6">
                <li className="flex items-start gap-3">
                  <span className="bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold flex-shrink-0">1</span>
                  <div>
                    <strong>Absence de validation du contenu</strong>
                    <p className="text-muted-foreground text-sm mt-1">
                      Le fichier DOCX est chargé directement sans aucune vérification du contenu 
                      des templates qu'il contient. Aucun filtrage des expressions dangereuses.
                    </p>
                  </div>
                </li>
                <li className="flex items-start gap-3">
                  <span className="bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold flex-shrink-0">2</span>
                  <div>
                    <strong>Pas de sandboxing FreeMarker</strong>
                    <p className="text-muted-foreground text-sm mt-1">
                      La configuration FreeMarker par défaut est utilisée, permettant l'accès 
                      à des classes dangereuses comme <code>freemarker.template.utility.Execute</code>.
                    </p>
                  </div>
                </li>
                <li className="flex items-start gap-3">
                  <span className="bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold flex-shrink-0">3</span>
                  <div>
                    <strong>API Built-in activée</strong>
                    <p className="text-muted-foreground text-sm mt-1">
                      La fonction <code>?api</code> de FreeMarker reste accessible, permettant 
                      l'accès à la réflexion Java et aux méthodes runtime.
                    </p>
                  </div>
                </li>
              </ol>

              <h3 className="text-2xl font-semibold mt-8 mb-4">Vecteurs CVSS v3.1 Détaillés</h3>

              <Card className="my-8">
                <CardContent className="p-6">
                  <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                    <div className="text-center p-4 bg-red-950/30 rounded-lg">
                      <Network className="h-6 w-6 mx-auto mb-2 text-red-400" />
                      <div className="font-bold">Network</div>
                      <div className="text-xs text-muted-foreground">Attack Vector</div>
                    </div>
                    <div className="text-center p-4 bg-green-950/30 rounded-lg">
                      <Zap className="h-6 w-6 mx-auto mb-2 text-green-400" />
                      <div className="font-bold">Low</div>
                      <div className="text-xs text-muted-foreground">Complexity</div>
                    </div>
                    <div className="text-center p-4 bg-blue-950/30 rounded-lg">
                      <User className="h-6 w-6 mx-auto mb-2 text-blue-400" />
                      <div className="font-bold">None</div>
                      <div className="text-xs text-muted-foreground">Privileges</div>
                    </div>
                    <div className="text-center p-4 bg-purple-950/30 rounded-lg">
                      <Eye className="h-6 w-6 mx-auto mb-2 text-purple-400" />
                      <div className="font-bold">None</div>
                      <div className="text-xs text-muted-foreground">User Interaction</div>
                    </div>
                  </div>
                  <div className="mt-4 pt-4 border-t border-border">
                    <div className="grid grid-cols-3 gap-2 sm:gap-4 text-center">
                      <div>
                        <div className="text-red-400 font-bold">High</div>
                        <div className="text-xs text-muted-foreground">Confidentiality</div>
                      </div>
                      <div>
                        <div className="text-red-400 font-bold">High</div>
                        <div className="text-xs text-muted-foreground">Integrity</div>
                      </div>
                      <div>
                        <div className="text-red-400 font-bold">High</div>
                        <div className="text-xs text-muted-foreground">Availability</div>
                      </div>
                    </div>
                  </div>
                  <p className="text-center mt-4 font-mono text-sm text-muted-foreground">
                    CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
                  </p>
                </CardContent>
              </Card>

              <h3 className="text-2xl font-semibold mt-8 mb-4">Payloads d'Exploitation Documentés</h3>

              <p>
                Les preuves de concept (PoC) publiées démontrent plusieurs vecteurs d'exploitation, 
                du plus simple (exécution de calculatrice) au plus critique (reverse shell) :
              </p>

              <Card className="my-6 bg-gray-900 border-gray-700 overflow-hidden">
                <CardHeader className="bg-red-950/50 py-3">
                  <CardTitle className="text-sm font-mono text-red-300">Payload 1 : Détection (Proof of Concept)</CardTitle>
                </CardHeader>
                <CardContent className="p-4 font-mono text-sm overflow-x-auto">
                  <code className="text-green-300">$&#123;"freemarker.template.utility.Execute"?new()("calc")&#125;</code>
                  <p className="text-gray-400 mt-2 text-xs">Ouvre la calculatrice Windows - confirme la vulnérabilité</p>
                </CardContent>
              </Card>

              <Card className="my-6 bg-gray-900 border-gray-700 overflow-hidden">
                <CardHeader className="bg-red-950/50 py-3">
                  <CardTitle className="text-sm font-mono text-red-300">Payload 2 : Exfiltration d'informations</CardTitle>
                </CardHeader>
                <CardContent className="p-4 font-mono text-sm overflow-x-auto">
                  <code className="text-yellow-300">$&#123;"freemarker.template.utility.Execute"?new()("whoami")&#125;</code>
                  <p className="text-gray-400 mt-2 text-xs">Révèle l'utilisateur système exécutant l'application</p>
                </CardContent>
              </Card>

              <Card className="my-6 bg-gray-900 border-gray-700 overflow-hidden">
                <CardHeader className="bg-red-950/50 py-3">
                  <CardTitle className="text-sm font-mono text-red-300">Payload 3 : Exploration du système</CardTitle>
                </CardHeader>
                <CardContent className="p-4 font-mono text-sm overflow-x-auto">
                  <code className="text-blue-300">$&#123;"freemarker.template.utility.Execute"?new()("cmd /c dir d:")&#125;</code>
                  <p className="text-gray-400 mt-2 text-xs">Liste le contenu du disque D: - reconnaissance</p>
                </CardContent>
              </Card>

              <Card className="my-6 bg-gray-900 border-gray-700 overflow-hidden">
                <CardHeader className="bg-red-950/50 py-3">
                  <CardTitle className="text-sm font-mono text-red-300">Payload 4 : Reverse Shell (Impact Maximal)</CardTitle>
                </CardHeader>
                <CardContent className="p-4 font-mono text-sm overflow-x-auto">
                  <code className="text-red-300 break-all">$&#123;"freemarker.template.utility.Execute"?new()("powershell -e [BASE64_ENCODED_PAYLOAD]")&#125;</code>
                  <p className="text-gray-400 mt-2 text-xs">Établit une connexion inverse vers l'attaquant - contrôle total du serveur</p>
                </CardContent>
              </Card>
            </div>
          </section>

          {/* Section 4: Scénarios d'Exploitation */}
          <section id="exploitation" className="mb-16">
            <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
              <Target className="h-8 w-8 text-orange-500" />
              Scénarios d'Exploitation Réalistes
            </h2>

            <div className="prose prose-lg dark:prose-invert max-w-none">
              <p>
                Pour illustrer la gravité de CVE-2025-64087, examinons des scénarios d'attaque 
                réalistes ciblant différents types d'applications françaises.
              </p>

              <h3 className="text-2xl font-semibold mt-8 mb-4">Scénario 1 : Attaque sur un Portail RH</h3>

              <Card className="my-6 border-orange-500/30 bg-orange-950/10">
                <CardContent className="p-6">
                  <div className="flex items-start gap-4">
                    <div className="bg-orange-500/20 p-3 rounded-lg">
                      <User className="h-8 w-8 text-orange-400" />
                    </div>
                    <div className="flex-1">
                      <h4 className="font-bold mb-2">Contexte</h4>
                      <p className="text-sm text-muted-foreground mb-4">
                        Une entreprise du CAC 40 utilise un portail RH interne basé sur Java/Spring 
                        permettant aux managers de générer des contrats de travail personnalisés. 
                        Le système utilise XDocReport pour fusionner les données du candidat avec 
                        un template Word.
                      </p>
                      
                      <h4 className="font-bold mb-2">Vecteur d'Attaque</h4>
                      <ol className="text-sm space-y-2 text-muted-foreground">
                        <li>1. L'attaquant postule à un poste fictif avec un CV DOCX malveillant</li>
                        <li>2. Un manager importe le "CV" dans le système pour générer une proposition</li>
                        <li>3. XDocReport traite le fichier, exécutant le payload SSTI</li>
                        <li>4. L'attaquant obtient un shell sur le serveur RH interne</li>
                        <li>5. Accès à toutes les données salariés, contrats, bulletins de paie</li>
                      </ol>
                    </div>
                  </div>
                </CardContent>
              </Card>

              <h3 className="text-2xl font-semibold mt-8 mb-4">Scénario 2 : Compromission d'une Fintech</h3>

              <Card className="my-6 border-purple-500/30 bg-purple-950/10">
                <CardContent className="p-6">
                  <div className="flex items-start gap-4">
                    <div className="bg-purple-500/20 p-3 rounded-lg">
                      <Building2 className="h-8 w-8 text-purple-400" />
                    </div>
                    <div className="flex-1">
                      <h4 className="font-bold mb-2">Contexte</h4>
                      <p className="text-sm text-muted-foreground mb-4">
                        Une néo-banque française propose à ses clients professionnels de générer 
                        des rapports financiers personnalisés en uploadant leurs propres templates 
                        Word (avec leurs logos et mise en page).
                      </p>
                      
                      <h4 className="font-bold mb-2">Chaîne d'Exploitation</h4>
                      <ol className="text-sm space-y-2 text-muted-foreground">
                        <li>1. Un client malveillant upload un template DOCX piégé</li>
                        <li>2. Le template contient un payload établissant une connexion inverse</li>
                        <li>3. Exfiltration des credentials de base de données PostgreSQL</li>
                        <li>4. Accès aux données de tous les clients de la banque</li>
                        <li>5. Potentielle manipulation des transactions financières</li>
                      </ol>
                    </div>
                  </div>
                </CardContent>
              </Card>

              <h3 className="text-2xl font-semibold mt-8 mb-4">Scénario 3 : Supply Chain Attack</h3>

              <Card className="my-6 border-red-500/30 bg-red-950/10">
                <CardContent className="p-6">
                  <div className="flex items-start gap-4">
                    <div className="bg-red-500/20 p-3 rounded-lg">
                      <Server className="h-8 w-8 text-red-400" />
                    </div>
                    <div className="flex-1">
                      <h4 className="font-bold mb-2">Contexte</h4>
                      <p className="text-sm text-muted-foreground mb-4">
                        Un éditeur de logiciel SaaS distribue une solution de gestion documentaire 
                        à plus de 200 PME françaises. Le produit intègre XDocReport comme dépendance.
                      </p>
                      
                      <h4 className="font-bold mb-2">Cascade d'Impact</h4>
                      <ol className="text-sm space-y-2 text-muted-foreground">
                        <li>1. L'attaquant identifie un client utilisant cette solution SaaS</li>
                        <li>2. Un fichier DOCX malveillant est uploadé via le module documentaire</li>
                        <li>3. Le serveur SaaS multi-tenant est compromis</li>
                        <li>4. Accès potentiel aux données de TOUS les 200 clients</li>
                        <li>5. Violation RGPD massive, notification CNIL obligatoire</li>
                      </ol>
                    </div>
                  </div>
                </CardContent>
              </Card>

              <h3 className="text-2xl font-semibold mt-8 mb-4">Facteurs Aggravants</h3>

              <div className="grid grid-cols-1 md:grid-cols-2 gap-4 my-8">
                <Card>
                  <CardContent className="p-4">
                    <h4 className="font-bold flex items-center gap-2 mb-2">
                      <AlertCircle className="h-4 w-4 text-red-500" />
                      Pas d'Authentification Requise
                    </h4>
                    <p className="text-sm text-muted-foreground">
                      De nombreuses fonctionnalités d'upload de documents sont accessibles 
                      sans authentification (formulaires publics, portails candidats).
                    </p>
                  </CardContent>
                </Card>
                <Card>
                  <CardContent className="p-4">
                    <h4 className="font-bold flex items-center gap-2 mb-2">
                      <AlertCircle className="h-4 w-4 text-red-500" />
                      Format DOCX Non Suspect
                    </h4>
                    <p className="text-sm text-muted-foreground">
                      Les fichiers .docx sont rarement bloqués par les WAF ou antivirus 
                      car considérés comme documents bureautiques légitimes.
                    </p>
                  </CardContent>
                </Card>
                <Card>
                  <CardContent className="p-4">
                    <h4 className="font-bold flex items-center gap-2 mb-2">
                      <AlertCircle className="h-4 w-4 text-red-500" />
                      Exécution Immédiate
                    </h4>
                    <p className="text-sm text-muted-foreground">
                      Le payload s'exécute dès le traitement du fichier, sans action 
                      supplémentaire de la victime nécessaire.
                    </p>
                  </CardContent>
                </Card>
                <Card>
                  <CardContent className="p-4">
                    <h4 className="font-bold flex items-center gap-2 mb-2">
                      <AlertCircle className="h-4 w-4 text-red-500" />
                      Privilèges Applicatifs
                    </h4>
                    <p className="text-sm text-muted-foreground">
                      Le code s'exécute avec les privilèges du serveur applicatif, 
                      souvent avec accès aux bases de données et APIs internes.
                    </p>
                  </CardContent>
                </Card>
              </div>
            </div>
          </section>

          {/* Section 5: Impact France */}
          <section id="impact-france" className="mb-16">
            <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
              <Globe className="h-8 w-8 text-blue-500" />
              Impact sur l'Écosystème Numérique Français
            </h2>

            <div className="prose prose-lg dark:prose-invert max-w-none">
              <p>
                La vulnérabilité CVE-2025-64087 représente une menace particulièrement aigüe 
                pour le tissu économique français, en raison de l'origine hexagonale de XDocReport 
                et de son adoption préférentielle dans les entreprises et administrations françaises.
              </p>

              <h3 className="text-2xl font-semibold mt-8 mb-4">Secteurs à Risque Élevé</h3>

              <div className="grid grid-cols-1 md:grid-cols-3 gap-4 my-8">
                <Card className="border-red-500/30">
                  <CardHeader className="pb-2">
                    <CardTitle className="text-lg flex items-center gap-2">
                      <TrendingUp className="h-5 w-5 text-red-500" />
                      Risque Critique
                    </CardTitle>
                  </CardHeader>
                  <CardContent>
                    <ul className="text-sm space-y-1">
                      <li>Banques et assurances</li>
                      <li>Cabinets d'avocats</li>
                      <li>Éditeurs SaaS B2B</li>
                      <li>Opérateurs d'importance vitale</li>
                    </ul>
                  </CardContent>
                </Card>

                <Card className="border-orange-500/30">
                  <CardHeader className="pb-2">
                    <CardTitle className="text-lg flex items-center gap-2">
                      <TrendingUp className="h-5 w-5 text-orange-500" />
                      Risque Élevé
                    </CardTitle>
                  </CardHeader>
                  <CardContent>
                    <ul className="text-sm space-y-1">
                      <li>Administrations publiques</li>
                      <li>Hôpitaux et cliniques</li>
                      <li>Cabinets comptables</li>
                      <li>Agences immobilières</li>
                    </ul>
                  </CardContent>
                </Card>

                <Card className="border-yellow-500/30">
                  <CardHeader className="pb-2">
                    <CardTitle className="text-lg flex items-center gap-2">
                      <TrendingUp className="h-5 w-5 text-yellow-500" />
                      Risque Modéré
                    </CardTitle>
                  </CardHeader>
                  <CardContent>
                    <ul className="text-sm space-y-1">
                      <li>PME avec ERP Java</li>
                      <li>E-commerce (factures)</li>
                      <li>Associations</li>
                      <li>Établissements scolaires</li>
                    </ul>
                  </CardContent>
                </Card>
              </div>

              <h3 className="text-2xl font-semibold mt-8 mb-4">Implications Réglementaires</h3>

              <p>
                Une exploitation réussie de CVE-2025-64087 pourrait entraîner des violations 
                de plusieurs cadres réglementaires européens et français :
              </p>

              <Card className="my-8 bg-blue-950/20 border-blue-500/30">
                <CardContent className="p-6">
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                      <h4 className="font-bold text-blue-400 mb-3">RGPD (Protection des Données)</h4>
                      <ul className="text-sm space-y-2">
                        <li className="flex items-start gap-2">
                          <CheckCircle2 className="h-4 w-4 text-blue-400 mt-0.5" />
                          Notification CNIL sous 72h obligatoire
                        </li>
                        <li className="flex items-start gap-2">
                          <CheckCircle2 className="h-4 w-4 text-blue-400 mt-0.5" />
                          Amende jusqu'à 4% du CA mondial
                        </li>
                        <li className="flex items-start gap-2">
                          <CheckCircle2 className="h-4 w-4 text-blue-400 mt-0.5" />
                          Information des personnes concernées
                        </li>
                      </ul>
                    </div>
                    <div>
                      <h4 className="font-bold text-purple-400 mb-3">NIS 2 (Directive Cybersécurité)</h4>
                      <ul className="text-sm space-y-2">
                        <li className="flex items-start gap-2">
                          <CheckCircle2 className="h-4 w-4 text-purple-400 mt-0.5" />
                          Signalement ANSSI obligatoire
                        </li>
                        <li className="flex items-start gap-2">
                          <CheckCircle2 className="h-4 w-4 text-purple-400 mt-0.5" />
                          Sanctions pénales pour les dirigeants
                        </li>
                        <li className="flex items-start gap-2">
                          <CheckCircle2 className="h-4 w-4 text-purple-400 mt-0.5" />
                          Audit de sécurité imposé
                        </li>
                      </ul>
                    </div>
                  </div>
                </CardContent>
              </Card>

              <h3 className="text-2xl font-semibold mt-8 mb-4">Estimation de l'Exposition</h3>

              <p>
                Sur la base des statistiques Maven Central et de l'adoption typique des 
                bibliothèques open-source en France, nous estimons que :
              </p>

              <div className="grid grid-cols-2 md:grid-cols-4 gap-4 my-8">
                <Card className="text-center p-4">
                  <div className="text-3xl font-bold text-primary">500+</div>
                  <div className="text-sm text-muted-foreground">Projets Open Source</div>
                </Card>
                <Card className="text-center p-4">
                  <div className="text-3xl font-bold text-primary">5,000+</div>
                  <div className="text-sm text-muted-foreground">Applications Privées</div>
                </Card>
                <Card className="text-center p-4">
                  <div className="text-3xl font-bold text-primary">50M+</div>
                  <div className="text-sm text-muted-foreground">Utilisateurs Exposés</div>
                </Card>
                <Card className="text-center p-4">
                  <div className="text-3xl font-bold text-primary">100%</div>
                  <div className="text-sm text-muted-foreground">Versions Vulnérables</div>
                </Card>
              </div>
            </div>
          </section>

          {/* Section 6: Détection */}
          <section id="detection" className="mb-16">
            <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
              <Eye className="h-8 w-8 text-cyan-500" />
              Détection et Audit de Vulnérabilité
            </h2>

            <div className="prose prose-lg dark:prose-invert max-w-none">
              <h3 className="text-2xl font-semibold mt-8 mb-4">Étape 1 : Identifier les Dépendances XDocReport</h3>

              <Card className="my-6 bg-gray-900 border-gray-700">
                <CardHeader className="bg-cyan-950/50 py-3">
                  <CardTitle className="text-sm font-mono text-cyan-300">Maven (pom.xml) - Recherche</CardTitle>
                </CardHeader>
                <CardContent className="p-4 font-mono text-sm overflow-x-auto">
                  <code className="text-green-300">grep -r "fr.opensagres.xdocreport" pom.xml</code>
                  <div className="mt-4 text-yellow-300">
                    # Résultat attendu si vulnérable :<br/>
                    &lt;groupId&gt;fr.opensagres.xdocreport&lt;/groupId&gt;<br/>
                    &lt;artifactId&gt;fr.opensagres.xdocreport.template.freemarker&lt;/artifactId&gt;<br/>
                    &lt;version&gt;2.1.0&lt;/version&gt;
                  </div>
                </CardContent>
              </Card>

              <Card className="my-6 bg-gray-900 border-gray-700">
                <CardHeader className="bg-cyan-950/50 py-3">
                  <CardTitle className="text-sm font-mono text-cyan-300">Gradle (build.gradle) - Recherche</CardTitle>
                </CardHeader>
                <CardContent className="p-4 font-mono text-sm overflow-x-auto">
                  <code className="text-green-300">grep -r "xdocreport" build.gradle</code>
                  <div className="mt-4 text-yellow-300">
                    # Résultat attendu si vulnérable :<br/>
                    implementation 'fr.opensagres.xdocreport:fr.opensagres.xdocreport.template.freemarker:2.1.0'
                  </div>
                </CardContent>
              </Card>

              <h3 className="text-2xl font-semibold mt-8 mb-4">Étape 2 : Scanner le Code pour les Patterns Vulnérables</h3>

              <Card className="my-6 bg-gray-900 border-gray-700">
                <CardHeader className="bg-cyan-950/50 py-3">
                  <CardTitle className="text-sm font-mono text-cyan-300">Recherche de Pattern Vulnérable</CardTitle>
                </CardHeader>
                <CardContent className="p-4 font-mono text-sm overflow-x-auto">
                  <code className="text-green-300">grep -rn "TemplateEngineKind.Freemarker" src/</code>
                  <div className="mt-4 text-yellow-300">
                    # Si des résultats apparaissent, l'application est potentiellement vulnérable
                  </div>
                </CardContent>
              </Card>

              <h3 className="text-2xl font-semibold mt-8 mb-4">Étape 3 : Utiliser des Outils Automatisés</h3>

              <div className="grid grid-cols-1 md:grid-cols-2 gap-4 my-8">
                <Card>
                  <CardHeader className="pb-2">
                    <CardTitle className="text-lg">OWASP Dependency-Check</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <code className="text-sm bg-gray-900 p-2 rounded block overflow-x-auto">
                      mvn org.owasp:dependency-check-maven:check
                    </code>
                    <p className="text-sm text-muted-foreground mt-2">
                      Gratuit, analyse les CVE connues dans les dépendances Maven
                    </p>
                  </CardContent>
                </Card>

                <Card>
                  <CardHeader className="pb-2">
                    <CardTitle className="text-lg">Snyk</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <code className="text-sm bg-gray-900 p-2 rounded block">
                      snyk test --all-projects
                    </code>
                    <p className="text-sm text-muted-foreground mt-2">
                      SaaS avec base de données de vulnérabilités enrichie
                    </p>
                  </CardContent>
                </Card>
              </div>

              <h3 className="text-2xl font-semibold mt-8 mb-4">Règle YARA pour Détection de Fichiers Malveillants</h3>

              <Card className="my-6 bg-gray-900 border-gray-700">
                <CardHeader className="bg-red-950/50 py-3">
                  <CardTitle className="text-sm font-mono text-red-300">CVE-2025-64087_XDocReport_SSTI.yar</CardTitle>
                </CardHeader>
                <CardContent className="p-4 font-mono text-xs overflow-x-auto">
                  <pre className="text-green-300">{`rule XDocReport_SSTI_CVE_2025_64087 {
    meta:
        description = "Detects SSTI payloads targeting XDocReport FreeMarker"
        author = "WP Vitesse Pro Security Team"
        reference = "CVE-2025-64087"
        severity = "critical"
    
    strings:
        $payload1 = "freemarker.template.utility.Execute"
        $payload2 = "?new()"
        $payload3 = "ObjectConstructor"
        $docx_magic = { 50 4B 03 04 }
    
    condition:
        $docx_magic at 0 and 
        (any of ($payload*))
}`}</pre>
                </CardContent>
              </Card>
            </div>
          </section>

          {/* Section 7: Remédiation */}
          <section id="remediation" className="mb-16">
            <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
              <Shield className="h-8 w-8 text-green-500" />
              Remédiation et Correctifs
            </h2>

            <div className="prose prose-lg dark:prose-invert max-w-none">
              <Card className="my-8 bg-green-950/20 border-green-500/30">
                <CardContent className="p-6">
                  <h3 className="text-xl font-bold text-green-400 mb-4 flex items-center gap-2">
                    <CheckCircle2 className="h-5 w-5" />
                    Actions Immédiates (0-24h)
                  </h3>
                  <ol className="space-y-4">
                    <li className="flex items-start gap-3">
                      <span className="bg-green-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold flex-shrink-0">1</span>
                      <div>
                        <strong>Désactiver les uploads DOCX</strong>
                        <p className="text-sm text-muted-foreground">
                          Bloquer temporairement toute fonctionnalité permettant l'upload de fichiers 
                          .docx vers les systèmes utilisant XDocReport.
                        </p>
                      </div>
                    </li>
                    <li className="flex items-start gap-3">
                      <span className="bg-green-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold flex-shrink-0">2</span>
                      <div>
                        <strong>Audit des logs</strong>
                        <p className="text-sm text-muted-foreground">
                          Rechercher dans les logs des traces d'exécution de commandes suspectes 
                          (calc.exe, whoami, powershell, cmd.exe).
                        </p>
                      </div>
                    </li>
                    <li className="flex items-start gap-3">
                      <span className="bg-green-600 text-white rounded-full w-6 h-6 flex items-center justify-center text-sm font-bold flex-shrink-0">3</span>
                      <div>
                        <strong>Segmentation réseau</strong>
                        <p className="text-sm text-muted-foreground">
                          Isoler les serveurs applicatifs concernés des ressources critiques 
                          (bases de données, AD, systèmes de paiement).
                        </p>
                      </div>
                    </li>
                  </ol>
                </CardContent>
              </Card>

              <h3 className="text-2xl font-semibold mt-8 mb-4">Correctif Code : Configuration FreeMarker Sécurisée</h3>

              <p>
                En attendant un correctif officiel de l'équipe XDocReport, vous devez implémenter 
                manuellement la configuration de sécurité FreeMarker dans votre application :
              </p>

              <Card className="my-6 bg-gray-900 border-gray-700">
                <CardHeader className="bg-green-950/50 py-3">
                  <CardTitle className="text-sm font-mono text-green-300">SecureFreemarkerConfiguration.java</CardTitle>
                </CardHeader>
                <CardContent className="p-4 font-mono text-xs overflow-x-auto">
                  <pre className="text-green-300">{`import freemarker.core.TemplateClassResolver;
import freemarker.template.Configuration;
import freemarker.template.Version;

public class SecureFreemarkerConfiguration {
    
    public static Configuration createSecureConfiguration() {
        Configuration cfg = new Configuration(Configuration.VERSION_2_3_31);
        
        // CRITICAL: Block dangerous class instantiation
        cfg.setNewBuiltinClassResolver(TemplateClassResolver.ALLOWS_NOTHING_RESOLVER);
        
        // Disable ?api built-in for reflection access
        cfg.setAPIBuiltinEnabled(false);
        
        // Additional hardening
        cfg.setLogTemplateExceptions(false);
        cfg.setWrapUncheckedExceptions(true);
        
        return cfg;
    }
}`}</pre>
                </CardContent>
              </Card>

              <h3 className="text-2xl font-semibold mt-8 mb-4">Alternative : Migrer vers Velocity</h3>

              <p>
                Si la fonctionnalité FreeMarker n'est pas indispensable, envisagez de migrer 
                vers le moteur Velocity qui n'est pas affecté par cette vulnérabilité spécifique :
              </p>

              <Card className="my-6 bg-gray-900 border-gray-700">
                <CardHeader className="bg-blue-950/50 py-3">
                  <CardTitle className="text-sm font-mono text-blue-300">Migration vers Velocity</CardTitle>
                </CardHeader>
                <CardContent className="p-4 font-mono text-sm overflow-x-auto">
                  <div className="text-red-300 line-through mb-2">
                    // AVANT (vulnérable)<br/>
                    IXDocReport report = XDocReportRegistry.getRegistry()<br/>
                    &nbsp;&nbsp;.loadReport(input, TemplateEngineKind.Freemarker);
                  </div>
                  <div className="text-green-300 mt-4">
                    // APRÈS (recommandé)<br/>
                    IXDocReport report = XDocReportRegistry.getRegistry()<br/>
                    &nbsp;&nbsp;.loadReport(input, TemplateEngineKind.Velocity);
                  </div>
                </CardContent>
              </Card>

              <h3 className="text-2xl font-semibold mt-8 mb-4">Validation des Fichiers Uploadés</h3>

              <p>
                Implémentez une validation stricte du contenu des fichiers DOCX avant traitement :
              </p>

              <Card className="my-6 bg-gray-900 border-gray-700">
                <CardHeader className="bg-yellow-950/50 py-3">
                  <CardTitle className="text-sm font-mono text-yellow-300">DocxSecurityValidator.java</CardTitle>
                </CardHeader>
                <CardContent className="p-4 font-mono text-xs overflow-x-auto">
                  <pre className="text-green-300">{`import java.util.regex.Pattern;

public class DocxSecurityValidator {
    
    private static final Pattern DANGEROUS_PATTERNS = Pattern.compile(
        "(freemarker\\\\.template\\\\.utility|\\\\?new\\\\(|\\\\?api|ObjectConstructor|Execute)",
        Pattern.CASE_INSENSITIVE
    );
    
    public static boolean isSafe(String documentContent) {
        return !DANGEROUS_PATTERNS.matcher(documentContent).find();
    }
    
    public static void validate(String content) throws SecurityException {
        if (!isSafe(content)) {
            throw new SecurityException(
                "CVE-2025-64087: Potential SSTI payload detected in document"
            );
        }
    }
}`}</pre>
                </CardContent>
              </Card>
            </div>
          </section>

          {/* Section 8: Timeline */}
          <section id="timeline" className="mb-16">
            <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
              <Clock className="h-8 w-8 text-purple-500" />
              Chronologie de la Divulgation
            </h2>

            <div className="prose prose-lg dark:prose-invert max-w-none">
              <div className="relative border-l-2 border-purple-500/50 pl-8 space-y-8 my-8">
                <div className="relative">
                  <div className="absolute -left-10 w-4 h-4 bg-purple-500 rounded-full"></div>
                  <div className="text-sm text-muted-foreground">19 octobre 2025</div>
                  <h4 className="font-bold">Découverte et Signalement Initial</h4>
                  <p className="text-sm text-muted-foreground">
                    Nguyen Hung Cuong découvre la vulnérabilité et contacte les mainteneurs 
                    XDocReport (Angelo Zerr, Pascal Leclercq). Pull Request #705 créée.
                  </p>
                </div>

                <div className="relative">
                  <div className="absolute -left-10 w-4 h-4 bg-purple-400 rounded-full"></div>
                  <div className="text-sm text-muted-foreground">24 octobre 2025</div>
                  <h4 className="font-bold">Relance sans Réponse</h4>
                  <p className="text-sm text-muted-foreground">
                    Email de suivi envoyé aux mainteneurs. Aucune réponse reçue au 30 octobre.
                  </p>
                </div>

                <div className="relative">
                  <div className="absolute -left-10 w-4 h-4 bg-orange-500 rounded-full"></div>
                  <div className="text-sm text-muted-foreground">24 novembre 2025</div>
                  <h4 className="font-bold">Documentation Technique Publiée</h4>
                  <p className="text-sm text-muted-foreground">
                    Publication de l'analyse technique complète sur HackMD avec PoC détaillé.
                  </p>
                </div>

                <div className="relative">
                  <div className="absolute -left-10 w-4 h-4 bg-red-500 rounded-full"></div>
                  <div className="text-sm text-muted-foreground">22 janvier 2026</div>
                  <h4 className="font-bold">Publication CVE Officielle</h4>
                  <p className="text-sm text-muted-foreground">
                    CVE-2025-64087 publiée dans la National Vulnerability Database (NVD) 
                    et GitHub Security Advisory Database avec score CVSS 10/10.
                  </p>
                </div>

                <div className="relative">
                  <div className="absolute -left-10 w-4 h-4 bg-red-400 rounded-full"></div>
                  <div className="text-sm text-muted-foreground">29 janvier 2026</div>
                  <h4 className="font-bold">Situation Actuelle</h4>
                  <p className="text-sm text-muted-foreground">
                    Aucun correctif officiel publié. PR #705 toujours en attente de merge. 
                    Exploit public disponible sur GitHub.
                  </p>
                </div>
              </div>
            </div>
          </section>

          {/* Section 9: Recommandations RSSI */}
          <section id="recommandations" className="mb-16">
            <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
              <CheckCircle2 className="h-8 w-8 text-emerald-500" />
              Recommandations pour les RSSI
            </h2>

            <div className="prose prose-lg dark:prose-invert max-w-none">
              <Card className="my-8 bg-emerald-950/20 border-emerald-500/30">
                <CardContent className="p-6">
                  <h3 className="text-xl font-bold text-emerald-400 mb-6">Plan d'Action Recommandé</h3>
                  
                  <div className="space-y-6">
                    <div className="flex items-start gap-4">
                      <div className="bg-emerald-500/20 p-2 rounded-lg">
                        <span className="text-emerald-400 font-bold text-xl">1</span>
                      </div>
                      <div>
                        <h4 className="font-bold">Inventaire Immédiat (J+0)</h4>
                        <p className="text-sm text-muted-foreground">
                          Lancer un scan de toutes les applications Java pour identifier la 
                          présence de XDocReport dans les dépendances directes et transitives.
                        </p>
                      </div>
                    </div>

                    <div className="flex items-start gap-4">
                      <div className="bg-emerald-500/20 p-2 rounded-lg">
                        <span className="text-emerald-400 font-bold text-xl">2</span>
                      </div>
                      <div>
                        <h4 className="font-bold">Mesures Conservatoires (J+1)</h4>
                        <p className="text-sm text-muted-foreground">
                          Désactiver temporairement les fonctionnalités d'upload de fichiers 
                          Office sur les applications identifiées comme vulnérables.
                        </p>
                      </div>
                    </div>

                    <div className="flex items-start gap-4">
                      <div className="bg-emerald-500/20 p-2 rounded-lg">
                        <span className="text-emerald-400 font-bold text-xl">3</span>
                      </div>
                      <div>
                        <h4 className="font-bold">Remédiation Technique (J+7)</h4>
                        <p className="text-sm text-muted-foreground">
                          Implémenter la configuration FreeMarker sécurisée ou migrer vers 
                          Velocity selon le contexte applicatif.
                        </p>
                      </div>
                    </div>

                    <div className="flex items-start gap-4">
                      <div className="bg-emerald-500/20 p-2 rounded-lg">
                        <span className="text-emerald-400 font-bold text-xl">4</span>
                      </div>
                      <div>
                        <h4 className="font-bold">Validation (J+14)</h4>
                        <p className="text-sm text-muted-foreground">
                          Effectuer des tests de pénétration ciblés pour valider l'efficacité 
                          des mesures de remédiation appliquées.
                        </p>
                      </div>
                    </div>

                    <div className="flex items-start gap-4">
                      <div className="bg-emerald-500/20 p-2 rounded-lg">
                        <span className="text-emerald-400 font-bold text-xl">5</span>
                      </div>
                      <div>
                        <h4 className="font-bold">Monitoring Continu</h4>
                        <p className="text-sm text-muted-foreground">
                          Déployer des règles de détection (YARA, SIEM) pour identifier 
                          les tentatives d'exploitation futures.
                        </p>
                      </div>
                    </div>
                  </div>
                </CardContent>
              </Card>

              <h3 className="text-2xl font-semibold mt-8 mb-4">Indicateurs de Compromission (IoC)</h3>

              <Card className="my-6">
                <CardContent className="p-6">
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                      <h4 className="font-bold mb-3 flex items-center gap-2">
                        <FileWarning className="h-4 w-4 text-red-500" />
                        Patterns dans les Logs
                      </h4>
                      <ul className="text-sm space-y-1 font-mono">
                        <li className="text-red-400">freemarker.template.utility.Execute</li>
                        <li className="text-red-400">ObjectConstructor</li>
                        <li className="text-red-400">java.lang.Runtime</li>
                        <li className="text-red-400">ProcessBuilder</li>
                      </ul>
                    </div>
                    <div>
                      <h4 className="font-bold mb-3 flex items-center gap-2">
                        <Bug className="h-4 w-4 text-orange-500" />
                        Processus Suspects
                      </h4>
                      <ul className="text-sm space-y-1 font-mono">
                        <li className="text-orange-400">cmd.exe spawn depuis Java</li>
                        <li className="text-orange-400">powershell.exe -e [base64]</li>
                        <li className="text-orange-400">Connexions sortantes inhabituelles</li>
                        <li className="text-orange-400">Création de fichiers dans /tmp</li>
                      </ul>
                    </div>
                  </div>
                </CardContent>
              </Card>
            </div>
          </section>

          {/* Section 10: FAQ */}
          <section id="faq" className="mb-16">
            <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
              <BookOpen className="h-8 w-8 text-primary" />
              Questions Fréquentes
            </h2>

            <Accordion type="single" collapsible className="space-y-4">
              {schemaFAQ.mainEntity.map((faq: { name: string; acceptedAnswer: { text: string } }, idx: number) => (
                <AccordionItem key={idx} value={`faq-${idx}`} className="border rounded-lg px-4" data-testid={`accordion-faq-${idx}`}>
                  <AccordionTrigger className="text-left hover:no-underline" data-testid={`button-faq-trigger-${idx}`}>
                    <span className="font-semibold">{faq.name}</span>
                  </AccordionTrigger>
                  <AccordionContent className="text-muted-foreground" data-testid={`text-faq-answer-${idx}`}>
                    {faq.acceptedAnswer.text}
                  </AccordionContent>
                </AccordionItem>
              ))}
            </Accordion>
          </section>

          {/* Sources Section */}
          <div className="mb-8 relative z-50">
            <h2 className="text-xl font-bold mb-4 flex items-center gap-2">
              <Link2 className="h-5 w-5 text-primary" />
              Sources & Références
            </h2>
            <div className="flex flex-col gap-3">
              {[
                { name: "National Vulnerability Database - CVE-2025-64087", url: "https://nvd.nist.gov/vuln/detail/CVE-2025-64087" },
                { name: "GitHub Security Advisory - GHSA-r8w2-w357-9pjv", url: "https://github.com/advisories/GHSA-r8w2-w357-9pjv" },
                { name: "HackMD - CVE-2025-64087 SSTI FreeMarker Technical Analysis (Nguyen Hung Cuong)", url: "https://hackmd.io/@cuongnh/BJEnw7SAlg" },
                { name: "GitHub - CVE-2025-64087 Proof of Concept Repository", url: "https://github.com/AT190510-Cuong/CVE-2025-64087-SSTI-" },
                { name: "XDocReport Pull Request #705 - Security Fix", url: "https://github.com/opensagres/xdocreport/pull/705" },
                { name: "XDocReport Vulnerable Source Code - FreemarkerTemplateEngine.java", url: "https://github.com/opensagres/xdocreport/blob/master/template/fr.opensagres.xdocreport.template.freemarker/src/main/java/fr/opensagres/xdocreport/template/freemarker/FreemarkerTemplateEngine.java" },
                { name: "HackTricks - SSTI Server Side Template Injection", url: "https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection" },
                { name: "PortSwigger - Server-Side Template Injection Guide", url: "https://portswigger.net/web-security/server-side-template-injection" }
              ].map((source, idx) => (
                <a 
                  key={idx}
                  href={source.url} 
                  target="_blank" 
                  rel="noopener noreferrer"
                  className="flex items-start gap-3 p-4 rounded-lg border border-primary/20 bg-card hover:bg-accent/50 transition-all cursor-pointer relative z-[100] group shadow-sm active:scale-[0.98]"
                  style={{ pointerEvents: 'auto' }}
                  data-testid={`link-source-${idx}`}
                >
                  <ExternalLink className="h-5 w-5 mt-0.5 flex-shrink-0 text-primary pointer-events-none" />
                  <div className="flex-1 min-w-0 pointer-events-none">
                    <p className="font-semibold text-sm leading-relaxed text-foreground group-hover:text-primary">{source.name}</p>
                    <p className="text-xs text-muted-foreground truncate mt-1 underline decoration-primary/30">{source.url}</p>
                  </div>
                </a>
              ))}
            </div>
          </div>

          {/* CTA Final */}
          <Card className="bg-gradient-to-br from-red-950 to-purple-950 border-red-500/30">
            <CardContent className="p-8 text-center">
              <AlertTriangle className="h-12 w-12 text-red-400 mx-auto mb-4" />
              <h3 className="text-2xl font-bold text-white mb-4">
                Protégez Votre Infrastructure Maintenant
              </h3>
              <p className="text-red-100/80 mb-6 max-w-2xl mx-auto">
                CVE-2025-64087 représente une menace critique pour les applications Java françaises. 
                N'attendez pas qu'un correctif officiel soit publié - agissez immédiatement pour 
                sécuriser vos systèmes.
              </p>
              <div className="flex flex-col sm:flex-row gap-4 justify-center">
                <a 
                  href="https://kinsta.com/fr/?kaid=CYISLEFCEOAL" 
                  target="_blank" 
                  rel="noopener noreferrer"
                  data-testid="link-cta-kinsta"
                >
                  <Button size="lg" className="bg-purple-600 hover:bg-purple-700" data-testid="button-cta-kinsta">
                    Hébergement Sécurisé Kinsta
                    <ExternalLink className="h-4 w-4 ml-2" />
                  </Button>
                </a>
                <Link href="/audit-site" data-testid="link-cta-audit">
                  <Button size="lg" variant="outline" className="border-white/30 text-white hover:bg-white/10" data-testid="button-cta-audit">
                    Audit de Sécurité Gratuit
                  </Button>
                </Link>
              </div>
            </CardContent>
          </Card>

          {/* Related Articles */}
          <section className="mt-12">
            <h2 className="text-2xl font-bold mb-6">Articles Connexes</h2>
            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
              <Link href="/article/barometre-cesin-2026-analyse-complete" data-testid="link-related-cesin">
                <Card className="hover-elevate cursor-pointer h-full" data-testid="card-related-cesin">
                  <CardContent className="p-6">
                    <Badge variant="secondary" className="mb-3">Cybersécurité</Badge>
                    <h3 className="font-bold mb-2">Baromètre CESIN 2026 : Analyse Complète</h3>
                    <p className="text-sm text-muted-foreground">
                      Moins d'attaques mais des impacts toujours plus lourds sur les entreprises françaises.
                    </p>
                  </CardContent>
                </Card>
              </Link>
              <Link href="/article/amodei-menaces-ia-humanite-2026" data-testid="link-related-amodei">
                <Card className="hover-elevate cursor-pointer h-full" data-testid="card-related-amodei">
                  <CardContent className="p-6">
                    <Badge variant="secondary" className="mb-3">Intelligence Artificielle</Badge>
                    <h3 className="font-bold mb-2">Dario Amodei : Les Menaces Existentielles de l'IA</h3>
                    <p className="text-sm text-muted-foreground">
                      Le CEO d'Anthropic alerte sur les risques catastrophiques de l'IA générative.
                    </p>
                  </CardContent>
                </Card>
              </Link>
            </div>
          </section>
        </div>
      </article>
    </>
  );
}
